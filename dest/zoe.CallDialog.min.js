/*! zoe.CallDialog 2016-02-25 */
!function(a){function b(){var b=B.PJQSendData(3,9600,3,0);return-1===b?void a.zoeMessageBox.warn("请确认评价器是否能够正常工作！"):void a.ajax({type:"GET",data:{orgId:s,staffCode:t,score:b},url:C+"/evaluate",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){b.isSuccess?a.zoeMessageBox.warn("评价完成！"):a.zoeMessageBox.warn("评价失败："+b.errorMessage)}})}function c(){}function d(){if(null===w||void 0===w)a("#showQueueNoListToggle").hide(),a("#btnCallAgain,#btnCallNext,#btnSkipNumber").addClass("forbid"),a("#btnCallAgain,#btnCallNext,#btnSkipNumber").attr("disabled","disabled"),void 0!=x&&""!=q.findTextByValue(x.consultingRoomId)&&q.setValue(x.consultingRoomId);else{"-1"===w.status&&(a("#btnCallAgain,#btnCallNext,#btnSkipNumber").addClass("forbid"),a("#btnCallAgain,#btnCallNext,#btnSkipNumber").attr("disabled","disabled")),u=w.queueRecordId,y&&a("#callingQueueNo").html(y.queueNo),"1"===w.isReservation?a(".next-num").show():a(".next-num").hide(),q.setValue(w.consultingRoomId),a("#radioQueueModel .radio-icon").removeClass("radio-icon-check"),a("#radioQueueModel .radio-icon[data-value="+w.queueModel+"]").addClass("radio-icon-check"),a("#radioQueueModel").attr("disabled","disabled");var b=a("#zoeCallDialog #btnStart");"1"===w.status?(b.attr("data-status","1"),b.val("停 诊"),q.setDisabled(!0)):(b.attr("data-status","-1"),b.val("开 诊"),q.setEnabled(!0)),void 0!=z?a("#queueModel_Ordinary").attr("data-queueRecordId",z):a("#queueModel_Ordinary").attr("data-queueRecordId",""),"1"===w.queueModel?(a("#queueModel_Ordinary").removeClass("select"),a("#queueModel_Specialist").addClass("select"),a("#queueModel_Specialist").attr("data-queueRecordId",A)):a("#queueModel_Specialist").remove()}}function e(){g(),h(),i()}function f(){a(".arrL-btn").click(function(){p.hide(),a("#zoeSimpleDialog").show()}),a(".arrR-btn").click(function(){a("#zoeSimpleDialog").hide(),p.show()}),a(".close-btn").click(function(){a("#zoeSimpleDialog").remove(),a("#zoeCallDialog").remove()}),a("#zoeCallDialog #btnStart").click(function(){var b=a(this).attr("data-status");if("1"===b)k(),a(this).attr("data-status","-1"),a(this).val("开 诊"),q.setEnabled(!0),a("#btnCallAgain,#btnCallNext,#btnSkipNumber").addClass("forbid"),a("#btnCallAgain,#btnCallNext,#btnSkipNumber").attr("disabled","disabled");else{var c=q.getText();if(""===c)return void a.zoeMessageBox.warn("请先选择你所在的诊室！");if(w)j();else{var d=a(".radio-icon-check").html()+"门诊";a.zoeMessageBox.confirm("开诊确认",'<strong style="color:red;">'+c+'</strong>诊室,<strong style="color:red;">'+d+"</strong>?",function(a){a&&j()})}}}),a("#btnCallAgain").click(function(){y&&m(y.id)}),a("#btnCallNext").click(function(){l()}),a("#btnSkipNumber").click(function(){y&&n(y.id)}),a("#evaluate").click(function(){b()})}function g(){a(".t-hd tr td:last").css("background","#f0f4f7"),a(".t-bd tr:odd").addClass("odd-row");var b=a(".t-bd tr");b.hover(function(b){a(this).toggleClass("over-row")}),b.click(function(){b.siblings().removeClass("select-row"),a(this).addClass("select-row")})}function h(){var b=a(".block span .radio-icon");b.click(function(b){a(this).addClass("radio-icon-check").siblings().removeClass("radio-icon-check")})}function i(){a("#showQueueNoListToggle").click(function(b){a(".t-bd").getNiceScroll().resize();var c=a(this).hasClass("col-text-open");1==c?(a(this).removeClass("col-text-open"),a("#list").hide()):(a(this).addClass("col-text-open"),o(),a("#list").slideDown(),a(".t-bd").niceScroll({zindex:99999,cursorcolor:"#bddeff",cursorwidth:"5px"}))});var b=a(".tab-item ul li");b.click(function(b){a(this).addClass("select").siblings().removeClass("select"),u=a(this).attr("data-queueRecordId"),o()})}function j(){a("#zoeCallDialog #btnStart").val("开诊中..."),a("#zoeCallDialog #btnStart").addClass("forbid"),a("#zoeCallDialog #btnStart").attr("disabled","disabled");var b=a("#radioQueueModel .radio-icon-check").attr("data-value");a.ajax({type:"GET",data:{orgId:s,staffCode:t,consultingRoomId:q.getValue(),queueModel:b},url:C+"/diagnosisStart",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(c){c.isSuccess?(w=c.data,u=w.queueRecordId,1==b?(a("#queueModel_Ordinary").removeClass("select"),a("#queueModel_Specialist").addClass("select"),a("#queueModel_Specialist").attr("data-queuerecordid",u)):(a("#queueModel_Ordinary").attr("data-queuerecordid",u),a("#queueModel_Specialist").remove()),a("#radioQueueModel .radio-icon").removeClass("radio-icon-check"),a("#radioQueueModel .radio-icon[data-value="+w.queueModel+"]").addClass("radio-icon-check"),a("#showQueueNoListToggle").show(),a("#zoeCallDialog #btnStart").attr("data-status","1"),a("#zoeCallDialog #btnStart").val("停 诊"),q.setDisabled(!0),a("#btnCallAgain,#btnCallNext,#btnSkipNumber,#btnStart").removeClass("forbid"),a("#btnCallAgain,#btnCallNext,#btnSkipNumber,#btnStart").removeAttr("disabled")):(a("#zoeCallDialog #btnStart").val("开 诊"),a("#zoeCallDialog #btnStart").removeClass("forbid"),a("#zoeCallDialog #btnStart").removeAttr("disabled"),a.zoeMessageBox.warn("错误："+c.errorMessage))}})}function k(){a.ajax({type:"GET",data:{staffDutyRecordId:w.id,staffCode:t},url:C+"/diagnosisStop",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){b.isSuccess?(w=b.data,a("#showQueueNoListToggle").hide(),a("#showQueueNoListToggle").removeClass("col-text-open"),a("#list").hide()):a.zoeMessageBox.warn(b.errorMessage)}})}function l(){a.ajax({type:"GET",data:{queueRecordId:u,staffCode:t},url:C+"/callNext",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){b.isSuccess?(y=b.data,a("#callingQueueNo").html(y.queueNo),o()):a.zoeMessageBox.warn(b.errorMessage)}})}function m(b){a.ajax({type:"GET",data:{queueNoId:b,staffCode:t},url:C+"/callNumber",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){b.isSuccess?(y=b.data,a("#callingQueueNo").html(y.queueNo),o()):a.zoeMessageBox.warn(b.errorMessage)}})}function n(b){a.ajax({type:"GET",data:{queueNoId:b,staffCode:t},url:C+"/skipNumber",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){b.isSuccess?o():a.zoeMessageBox.warn(b.errorMessage)}})}function o(b){b||(b=a("#zoeCallDialog #cbQueueNoStatus").val()),a.ajax({type:"GET",data:{queueRecordId:u,staffCode:t,queueNoStatus:b},url:C+"/queryQueueNoList",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){if(b.isSuccess){a("#tbQueueNoList tr").remove();for(var c,d=b.data,e=a("#tbQueueNoList"),f=0,g=d.length;g>f;f++){var h="";null!=d[f].sickName&&(h=d[f].sickName),c=c+"<tr><td>"+(f+1)+"</td><td>"+d[f].queueNo+"</td><td>"+h+'</td><td><a href="javascript:void(0);" class="notice-icon queueNo" data-queueNoId="'+d[f].id+'"></a></td></tr>'}e.append(c),a(".t-bd").niceScroll({zindex:99999,cursorcolor:"#bddeff",cursorwidth:"5px"}),a(".queueNo").click(function(){var b=a(this).attr("data-queueNoId");m(b),o()})}else a.zoeMessageBox.warn(b.errorMessage)}})}var p,q,r,s,t,u,v,w,x,y,z,A,B,C="http://localhost:8080/webservice/rest/queue/call",D='<div id="zoeSimpleDialog" class="zoe-simple-model"><div class="model"><a href="javascript:void(0);" class="close-btn"></a><a href="javascript:void(0);" class="arrR-btn">叫号窗口</a></div></div><div id="zoeCallDialog" class="zoe-call-dialog"><div class="windows"><div class="top-bar"><span class="title">叫号窗口</span><span class="present-num">当前号：<a id="callingQueueNo"></></span><span class="next-num">下一号：<a id="nextQueueNo"></></span><a href="javascript:void(0);" class="arrL-btn"></a><span class="col-text" id="showQueueNoListToggle">队列</span></div><div class="main-box" id="list"><div class="tab-item"><ul><li class="select" id="queueModel_Ordinary">普通门诊</li><li id="queueModel_Specialist">专家门诊</li></ul><select id="cbQueueNoStatus"><option value="1">等待中</option><option value="3">已呼叫</option><option value="4">已跳过</option></select></div><div class="grid"><div class="t-hd"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>序号</td><td>排队号</td><td>姓名</td><td>操作</td></tr></table></div><div class="t-bd"><table id="tbQueueNoList" width="100%" border="0" cellspacing="0" cellpadding="0"></table></div></div></div><div class="bottom-line"><div class="block"><span><label>诊室：</label><input name="" id="cbRoom" type="text" /></span><span id="radioQueueModel"><a href="javacript:void(0);" class="radio-icon radio-icon-check" data-value="2">普通</a><a href="javacript:void(0);" class="radio-icon" data-value="1">专家</a></span><span><input type="button" class="btn" id="btnStart" data-status="-1" value="开&nbsp;诊"/></span></div><div class="block"><span><input type="button" class="btn large-btn" id="btnCallAgain" value="重新呼叫"/><input type="button" class="btn large-btn" id="btnCallNext" value="下一个"/><input type="button" class="btn" id="btnSkipNumber" value="跳&nbsp;过"/></span><input type="button" id="evaluate" class="evaluate" value="评&nbsp;价" /></div></div></div></div>';c.prototype={init:function(b,c){t=c,s=b,a("body").append(D),objectInfo="<object  type='application/x-itst-activex' clsid='{FD4C53FD-B426-42CA-9E5B-675E6E016C1A}' id='evaluator' style='height:0; width:0'></object>",a("body").append(objectInfo),B=document.getElementById("evaluator"),a.ajax({type:"GET",data:{orgId:s,staffCode:t},url:C+"/init",dataType:"jsonp",jsonp:"_jsonp",jsonpCallback:"callback",success:function(b){v=b.data.consultingRoomList,w=b.data.staffDutyRecord,x=b.data.lastStaffDutyRecord,z=b.data.ordinaryQueueRecordId,A=b.data.specialistQueueRecordId,void 0!=w&&(u=w.queueRecordId),y=b.data.callingQueueNo,p=a.zoeDialog.tip({width:424,height:"auto",target:a("#zoeCallDialog")}),r=a("#zoeCallDialog #cbQueueNoStatus").zoeComboBox({width:77,initValue:"1",onSelected:function(a){w&&o(a)}}),q=a("#zoeCallDialog #cbRoom").zoeComboBox({width:134,tree:{nodeWidth:108,data:v,checkbox:!1,treeLine:!1,parentIcon:!1,childIcon:!1},clickEve:function(){a(".l-box-select-inner").niceScroll({zindex:99999,cursorcolor:"#bddeff",cursorwidth:"5px"})}}),e(),f(),d()}})},close:function(){a("#zoeSimpleDialog").remove(),a("#zoeCallDialog").remove(),p.close(),a(".l-box-select").remove()}},window.ZoeCallDialog=c.prototype}(jQuery),function($){if(Function.prototype.zoeExtend=function(a,b){if("function"!=typeof a)return this;this.base=a.prototype,this.base.constructor=a;var c=function(){};c.prototype=a.prototype,this.prototype=new c,this.prototype.constructor=this,b&&$.extend(this.prototype,b)},Function.prototype.zoeDefer=function(a,b,c){var d=this;return setTimeout(function(){d.apply(a,c||[])},b)},window.zoe=$.zoeui={version:"V1.0.0",managerCount:0,managers:{},managerIdPrev:"zoeui",autoNewId:!0,error:{managerIsExist:"管理器id已经存在"},pluginPrev:"zoe",getId:function(a){a=a||this.managerIdPrev;var b=a+(1e3+this.managerCount);return this.managerCount++,b},add:function(a){if(2==arguments.length){var b=arguments[1];return b.id=b.id||b.options.id||arguments[0].id,void this.addManager(b)}a.id||(a.id=this.getId(a.__idPrev())),this.managers[a.id]=a},remove:function(a){if("string"==typeof a||"number"==typeof a)delete zoe.managers[a];else if("object"==typeof a)if(a instanceof zoe.core.Component)delete zoe.managers[a.id];else{if(!$(a).attr(this.idAttrName))return!1;delete zoe.managers[$(a).attr(this.idAttrName)]}},get:function(a,b){if(b=b||"zoeuiid","string"==typeof a||"number"==typeof a)return zoe.managers[a];if("object"==typeof a){var c=a.length?a[0]:a,d=c[b]||$(c).attr(b);return d?zoe.managers[d]:null}return null},find:function(a){var b=[];for(var c in this.managers){var d=this.managers[c];a instanceof Function?d instanceof a&&b.push(d):a instanceof Array?-1!=$.inArray(d.__getType(),a)&&b.push(d):d.__getType()==a&&b.push(d)}return b},run:function(a,b,c){if(a){if(c=$.extend({defaultsNamespace:"zoeDefaults",methodsNamespace:"zoeMethods",controlNamespace:"controls",idAttrName:"zoeuiid",isStatic:!1,hasElement:!0,propertyToElemnt:null},c||{}),a=a.replace(/^zoeGet/,""),a=a.replace(/^zoe/,""),null==this||this==window||c.isStatic)return zoe.plugins[a]||(zoe.plugins[a]={fn:$[zoe.pluginPrev+a],isStatic:!0}),new $.zoeui[c.controlNamespace][a]($.extend({},$[c.defaultsNamespace][a]||{},$[c.defaultsNamespace][a+"String"]||{},b.length>0?b[0]:{}));if(zoe.plugins[a]||(zoe.plugins[a]={fn:$.fn[zoe.pluginPrev+a],isStatic:!1}),/Manager$/.test(a))return zoe.get(this,c.idAttrName);if(this.each(function(){if(this[c.idAttrName]||$(this).attr(c.idAttrName)){var d=zoe.get(this[c.idAttrName]||$(this).attr(c.idAttrName));return void(d&&b.length>0&&d.set(b[0]))}if(!(b.length>=1&&"string"==typeof b[0])){var e=b.length>0?b[0]:null,f=$.extend({},$[c.defaultsNamespace][a],$[c.defaultsNamespace][a+"String"],e);c.propertyToElemnt&&(f[c.propertyToElemnt]=this),c.hasElement?new $.zoeui[c.controlNamespace][a](this,f):new $.zoeui[c.controlNamespace][a](f)}}),0==this.length)return null;if(0==b.length)return zoe.get(this,c.idAttrName);if("object"==typeof b[0])return zoe.get(this,c.idAttrName);if("string"==typeof b[0]){var d=zoe.get(this,c.idAttrName);if(null==d)return;if("option"!=b[0]){var e=b[0];if(!d[e])return;var f=Array.apply(null,b);return f.shift(),d[e].apply(d,f)}if(2==b.length)return d.get(b[1]);if(b.length>=3)return d.set(b[1],b[2])}return null}},defaults:{},methods:{},core:{},controls:{},plugins:{}},$.zoeDefaults={},$.zoeMethos={},zoe.defaults=$.zoeDefaults,zoe.methods=$.zoeMethos,$.fn.zoe=function(a){return a?zoe.run.call(this,a,arguments):zoe.get(this)},zoe.core.Component=function(a){this.events=this.events||{},this.options=a||{},this.children={}},$.extend(zoe.core.Component.prototype,{__getType:function(){return"zoe.core.Component"},__idPrev:function(){return"zoeui"},set:function(a,b){if(a)if("object"!=typeof a){var c=a;if(0==c.indexOf("on"))return void("function"==typeof b&&this.bind(c.substr(2),b));if(this.options||(this.options={}),0!=this.trigger("propertychange",[a,b])){this.options[c]=b;var d="_set"+c.substr(0,1).toUpperCase()+c.substr(1);this[d]&&this[d].call(this,b),this.trigger("propertychanged",[a,b])}}else{var e;if(this.options!=a?($.extend(this.options,a),e=a):e=$.extend({},a),void 0==b||1==b)for(var f in e)0==f.indexOf("on")&&this.set(f,e[f]);if(void 0==b||0==b)for(var f in e)0!=f.indexOf("on")&&this.set(f,e[f])}},get:function(a){var b="_get"+a.substr(0,1).toUpperCase()+a.substr(1);return this[b]?this[b].call(this,a):this.options[a]},hasBind:function(a){var b=a.toLowerCase(),c=this.events[b];return c&&c.length?!0:!1},trigger:function(a,b){if(a){var c=a.toLowerCase(),d=this.events[c];if(d){b=b||[],b instanceof Array==0&&(b=[b]);for(var e=0;e<d.length;e++){var f=d[e];if(0==f.handler.apply(f.context,b))return!1}}}},bind:function(a,b,c){if("object"!=typeof a){if("function"!=typeof b)return!1;var d=a.toLowerCase(),e=this.events[d]||[];c=c||this,e.push({handler:b,context:c}),this.events[d]=e}else for(var f in a)this.bind(f,a[f])},unbind:function(a,b){if(!a)return void(this.events={});var c=a.toLowerCase(),d=this.events[c];if(d&&d.length)if(b){for(var e=0,f=d.length;f>e;e++)if(d[e].handler==b){d.splice(e,1);break}}else delete this.events[c]},destroy:function(){zoe.remove(this)}}),zoe.core.UIComponent=function(a,b){zoe.core.UIComponent.base.constructor.call(this,b);var c=this._extendMethods();c&&$.extend(this,c),this.element=a,this._init(),this._preRender(),this.trigger("render"),this._render(),this.trigger("rendered"),this._rendered()},zoe.core.UIComponent.zoeExtend(zoe.core.Component,{__getType:function(){return"zoe.core.UIComponent"},_extendMethods:function(){},_init:function(){if(this.type=this.__getType(),this.element?this.id=this.options.id||this.element.id||zoe.getId(this.__idPrev()):this.id=this.options.id||zoe.getId(this.__idPrev()),zoe.add(this),this.element){var attributes=this.attr();if(attributes&&attributes instanceof Array)for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}var p=this.options;if($(this.element).attr("zoeui"))try{var attroptions=$(this.element).attr("zoeui");0!=attroptions.indexOf("{")&&(attroptions="{"+attroptions+"}"),eval("attroptions = "+attroptions+";"),attroptions&&$.extend(p,attroptions)}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){this.element&&$(this.element).attr("zoeuiid",this.id)},_setCls:function(a){this.element&&a&&$(this.element).addClass(a)},attr:function(){return[]},destroy:function(){this.element&&$(this.element).remove(),this.options=null,zoe.remove(this)}}),zoe.controls.Input=function(a,b){zoe.controls.Input.base.constructor.call(this,a,b)},zoe.controls.Input.zoeExtend(zoe.core.UIComponent,{__getType:function(){return"zoe.controls.Input"},attr:function(){return["nullText"]},setValue:function(a){return this.set("value",a)},getValue:function(){return this.get("value")},_setReadonly:function(a){var b=this.wrapper||this.text;if(b&&b.hasClass("l-text")){var c=this.inputText;a?(c&&c.attr("readonly","readonly"),b.addClass("l-text-readonly")):(c&&c.removeAttr("readonly"),b.removeClass("l-text-readonly"))}},setReadonly:function(a){return this.set("readonly",a)},setEnabled:function(){return this.set("disabled",!1)},setDisabled:function(){return this.set("disabled",!0)},updateStyle:function(){},resize:function(a,b){this.set({width:a,height:b+2})}}),zoe.win={top:!1,mask:function(a){function b(){if(zoe.win.windowMask){var a=$(window).height()+$(window).scrollTop();zoe.win.windowMask.height(a)}}this.windowMask||(this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body"),$(window).bind("resize.zoeuiwin",b),$(window).bind("scroll",b)),this.windowMask.show(),b(),this.masking=!0},unmask:function(a){for(var b=$("body > .l-dialog:visible,body > .l-window:visible"),c=0,d=b.length;d>c;c++){var e=b.eq(c).attr("zoeuiid");if(b.eq(c).css("z-index","9200"),!a||a.id!=e){var f=zoe.get(e);if(f){var g=f.get("modal");if(g)return}}}this.windowMask&&this.windowMask.hide(),this.masking=!1},createTaskbar:function(){return this.taskbar||(this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body"),this.top&&this.taskbar.addClass("l-taskbar-top"),this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar),this.tasks={}),this.taskbar.show(),this.taskbar.animate({bottom:0}),this.taskbar},removeTaskbar:function(){var a=this;a.taskbar.animate({bottom:-32},function(){a.taskbar.remove(),a.taskbar=null})},activeTask:function(a){for(var b in this.tasks){var c=this.tasks[b];b==a.id?c.addClass("l-taskbar-task-active"):c.removeClass("l-taskbar-task-active")}},getTask:function(a){var b=this;if(b.taskbar)return b.tasks[a.id]?b.tasks[a.id]:null},addTask:function(a){var b=this;if(b.taskbar||b.createTaskbar(),b.tasks[a.id])return b.tasks[a.id];var c=a.get("title"),d=b.tasks[a.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+c+"</div></div>");return b.taskbar.tasks.append(d),b.activeTask(a),d.bind("click",function(){b.activeTask(a),a.actived?a.min():a.active()}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")}),d},hasTask:function(){for(var a in this.tasks)if(this.tasks[a])return!0;return!1},removeTask:function(a){var b=this;b.taskbar&&(b.tasks[a.id]&&(b.tasks[a.id].unbind(),b.tasks[a.id].remove(),delete b.tasks[a.id]),b.hasTask()||b.removeTaskbar())},setFront:function(a){var b=zoe.find(zoe.core.Win),c=$("body > .l-dialog:visible");for(var d in b){var e=b[d];e!=a&&$(e.element).css("z-index","9100"),e==a&&$(e.element).is(":hidden")&&$(e.element).css("z-index","9100")}for(var f in b){var g=b[f];g==a&&($(g.element).css("z-index","9200"),this.activeTask(g)),g!=a&&1==c.length&&($(g.element).css("z-index","9200"),this.activeTask(g))}}},zoe.core.Win=function(a,b){zoe.core.Win.base.constructor.call(this,a,b)},zoe.core.Win.zoeExtend(zoe.core.UIComponent,{__getType:function(){return"zoe.controls.Win"},mask:function(){this.options.modal&&zoe.win.mask(this)},unmask:function(){this.options.modal&&zoe.win.unmask(this)},min:function(){},max:function(){},active:function(){}}),zoe.draggable={dragging:!1},zoe.resizable={reszing:!1},zoe.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(a){var b=function(a){return 10>a?"0"+a:a},c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=function(a){return c.lastIndex=0,c.test(a)?'"'+a.replace(c,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'};if(null===a)return"null";var e=typeof a;if("undefined"===e)return void 0;if("string"===e)return d(a);if("number"===e||"boolean"===e)return""+a;if("object"===e){if("function"==typeof a.toJSON)return zoe.toJSON(a.toJSON());if(a.constructor===Date)return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null;var f=[];if(a.constructor===Array){for(var g=0,h=a.length;h>g;g++)f.push(zoe.toJSON(a[g])||"null");return"["+f.join(",")+"]"}var i,j;for(var k in a){if(e=typeof k,"number"===e)i='"'+k+'"';else{if("string"!==e)continue;i=d(k)}e=typeof a[k],"function"!==e&&"undefined"!==e&&(j=zoe.toJSON(a[k]),f.push(i+":"+j))}return"{"+f.join(",")+"}"}},zoe.getEditor=function(a){var b=a.type,c=a.control,d=a.master;if(!b)return null;var e=0;c&&(c=c.substr(0,1).toUpperCase()+c.substr(1));var f={create:function(f,g,h){var i=g.field||g.column,j=h||{},k=g.column?!0:!1,l=$.extend({},a.options),m="text";-1!=$.inArray(b,["password","file","checkbox","radio"])&&(m=b),a.password&&(m="password");var n=$("<input type='"+m+"'/>");if(a.body&&(n=a.body.clone()),n.appendTo(f),g.field){var o=i.name,p=$.isFunction(j.prefixID)?j.prefixID(d):j.prefixID||"";if(l.id=i.id||p+i.name,-1!=$.inArray(b,["select","combobox","autocomplete","popup"])&&(o=i.textField||i.comboboxName,i.comboboxName&&!i.id&&(l.id=(j.prefixID||"")+i.comboboxName)),-1!=$.inArray(b,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])&&(l.valueFieldID=p+i.name),!a.body){var q=p+o,r=(new Date).getTime()+"_"+ ++e+"_"+i.name;n.attr($.extend({id:r,name:q},i.attr)),i.cssClass&&n.addClass(i.cssClass),i.validate&&!d.options.unSetValidateAttr&&n.attr("validate",zoe.toJSON(i.validate))}$.extend(l,i.options)}if(i.dictionary&&(i.editor=i.editor||{},!i.editor.data)){var s=[],t=i.dictionary.split("|");$(t).each(function(a,b){var c=b.split(","),d=c[0],e=c.length>=2?c[1]:c[0];s.push({id:d,value:d,text:e})}),i.editor.data=s}if(i.editor){i.editor.options&&$.extend(l,i.editor.options),i.editor.valueColumnName&&(l.valueField=i.editor.valueColumnName),i.editor.displayColumnName&&(l.textField=i.editor.displayColumnName);var u=i.editor.p||i.editor.ext;u&&(u="function"==typeof u?u(g):u,$.extend(l,u)),$.extend(l,i.editor)}k?(l.host_grid=this,l.host_grid_row=g.record,l.host_grid_column=g.column):(l.host_form=this,(i.readonly||l.host_form.get("readonly"))&&(l.readonly=!0));var v=n["zoe"+c](l);return k&&setTimeout(function(){n.focus()},100),v},getValue:function(a,b){var c=b.field||b.column;if(a.getValue){var d=a.getValue(),e=b.column?b.column.editor.type:b.field.type;if(c&&c.editor&&c.editor.isArrayValue&&d&&(d=d.split(";")),c&&c.editor&&c.editor.isRef&&a.getText&&(d=[d,a.getText()]),c&&c.editor&&c.editor.isRefMul&&a.getText){var f=d.split(";"),g=a.getText().split(";");d=[];for(var h=0;h<f.length;h++)d.push([f[h],g[h]])}return"int"==e||"digits"==e?d=d?parseInt(d,10):0:("float"==e||"number"==e)&&(d=d?parseFloat(d):0),d}},setValue:function(a,b,c){var d=c.field||c.column;if(a.setValue){if(d&&d.editor&&d.editor.isArrayValue&&b&&(b=b.join(";")),d&&d.editor&&d.editor.isRef&&$.isArray(b)&&(b=b[0]),d&&d.editor&&d.editor.isRefMul&&$.isArray(b)){for(var e=[],f=0;f<b.length;f++)e.push(b[f].length>1?b[f][1]:b[f][0]);b=e.join(";")}null==b&&(b=""),a.setValue(b)}},getText:function(a,b){b.field||b.column;if(a.getText){var c=a.getText();if(c)return c}},setText:function(a,b,c){if(b&&a.setText)a.setText(b);else{var d=c.field||c.column;if(b=a.setValue()||c.value||"",d&&d.editor&&d.editor.isRef&&$.isArray(b)&&b.length>1&&(b=b[1]),d&&d.editor&&d.editor.isRefMul&&$.isArray(b)&&b.length>1){for(var e=[],f=0;f<b.length;f++)e.push(b[1]);b=e.join(";")}a.setText&&a.setText(b)}},getSelected:function(a,b){return a.getSelected?a.getSelected():void 0},resize:function(a,b,c,d){d.field&&(b-=2),a.resize&&a.resize(b,c)},setEnabled:function(a,b){b?a.setEnabled&&a.setEnabled():a.setDisabled&&a.setDisabled()},destroy:function(a,b){a.destroy&&a.destroy()}};return $.extend({},f,zoe.editorCreatorDefaults||{},a)},zoe.editors={text:{control:"TextBox"},date:{control:"DateEditor",setValue:function(editor,value,editParm){"string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),editor.setValue(value)}},combobox:{control:"ComboBox"},spinner:{control:"Spinner"},checkbox:{control:"CheckBox"},checkboxlist:{control:"CheckBoxList",body:$("<div></div>"),resize:function(a,b,c,d){a.set("width",b-2)}},radiolist:{control:"RadioList",body:$("<div></div>"),resize:function(a,b,c,d){a.set("width",b-2)}},listbox:{control:"ListBox",body:$("<div></div>"),resize:function(a,b,c,d){a.set("width",b-2)}},popup:{control:"PopupEdit"},number:{control:"TextBox",options:{number:!0}},currency:{control:"TextBox",options:{currency:!0}},digits:{control:"TextBox",options:{digits:!0}},password:{control:"TextBox",password:!0}},zoe.editors.string=zoe.editors.text,zoe.editors.select=zoe.editors.combobox,zoe.editors["int"]=zoe.editors.digits,zoe.editors["float"]=zoe.editors.number,zoe.editors.chk=zoe.editors.checkbox,zoe.editors.popupedit=zoe.editors.popup,$.fn.live=$.fn.on?$.fn.on:$.fn.live,!$.browser){var userAgent=navigator.userAgent.toLowerCase();$.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)}}}(jQuery),function(a){zoe.inject={prev:"zoe-",defaults:{Grid_detail:{height:null,onShowDetail:null},Grid_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Grid_editor",Grid_popup:"PopupEdit",Grid_grid:"Grid",Grid_condition:"Form",Grid_toolbar:"Toolbar",Grid_fields:"Form_fields",Form_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Form_editor",Form_grid:"Grid",Form_columns:"Grid_columns",Form_condition:"Form",Form_popup:"PopupEdit",Form_buttons:"Button",Portal_panel:"Panel"},config:{Grid:{dynamics:"data,isChecked,detail,rowDraggingRender,toolbar,columns",arrays:"columns",columns:{dynamics:"render,totalSummary,headerRender,columns,editor,columns",arrays:"columns",textProperty:"display",columns:"zoe.inject.config.Grid.columns",editor:{dynamics:"data,columns,render,renderItem,grid,condition,ext",grid:"zoe.inject.config.Grid",condition:"zoe.inject.config.Form"}},toolbar:{arrays:"items"}},Form:{dynamics:"validate,fields,buttons",arrays:"fields,buttons",fields:{textProperty:"label",dynamics:"validate,editor",editor:{dynamics:"data,columns,render,renderItem,grid,condition,attr",grid:"zoe.inject.config.Grid",condition:"zoe.inject.config.Form"}},buttons:"zoe.inject.config.Button"},PopupEdit:{dynamics:"grid,condition"},Button:{textProperty:"text",dynamics:"click"},ComboBox:{dynamics:"columns,data,tree,grid,condition,render,parms,renderItem"},ListBox:{dynamics:"columns,data,render,parms"},RadioList:{dynamics:"data,parms"},CheckBoxList:{dynamics:"data,parms"},Panel:{},Portal:{dynamics:"rows,columns",arrays:"rows,columns",columns:{dynamics:"panels",arrays:"panels"},rows:{dynamics:"panels",arrays:"panels"},toolbar:{arrays:"items"}}},parse:function(a){try{return null==a?null:new Function("return "+a+";")()}catch(b){return null}},parseDefault:function(b){var c=this;if(!b)return b;var d={};return a(b.split(",")).each(function(b,e){e&&(e=e.substr(0,1).toUpperCase()+e.substr(1),a.extend(d,c.parse("zoe.defaults."+e)))}),d},fotmatValue:function(a,b){return"boolean"==b?"true"==a||"1"==a:"number"==b&&a?parseFloat(a.toString()):a},getOptions:function(b){var c=b.jelement,d=b.defaults,e=b.config;e=a.extend({ignores:"",dynamics:"",arrays:""},e);var f,g=this,h={};e.textProperty&&(h[e.textProperty]=c.text());for(var i in d){var j=i.toLowerCase(),k=a("> ."+j,c);if(-1==a.inArray(i,e.ignores.split(",")))if(k.length){var l=b.controlName+"_"+i,m=g.defaults[l]||zoe.defaults[l],n=e[i];"string"==typeof m?m=g.parseDefault(m):"funcion"==typeof m&&(m=m()),"string"==typeof n?n=g.parse(n):"funcion"==typeof n&&(n=n()),m&&(-1!=a.inArray(i,e.arrays.split(","))?(f=[],a(">div,>li,>input",k).each(function(){f.push(g.getOptions({defaults:m,controlName:b.controlName,config:n,jelement:a(this)}))}),h[i]=f):h[i]=g.getOptions({defaults:m,controlName:b.controlName,config:n,jelement:k})),k.remove()}else-1!=a.inArray(i,e.dynamics.split(","))||0==i.indexOf("on")?(f=g.parse(c.attr("data-"+i)||c.attr(i)),f&&(h[i]=g.fotmatValue(f,typeof d[i]))):(f=c.attr("data-"+i)||c.attr(i),f&&(h[i]=g.fotmatValue(f,typeof d[i])))}var o=c.attr("data-options")||c.attr("data-property");return o&&(o=g.parse("{"+o+"}")),o&&a.extend(h,o),h},init:function(){var b=this,c=this.config;for(var d in b.defaults)"string"==typeof b.defaults[d]&&(b.defaults[d]=b.parseDefault(b.defaults[d]));for(var e in zoe.controls){var f=c[e]||{},g=b.prev+e.toLowerCase();a("."+g).each(function(){var c=a(this),d=a.extend({onrender:null,onrendered:null},zoe.defaults[e]),g=b.getOptions({defaults:d,controlName:e,config:f,jelement:c});c[zoe.pluginPrev+e](g)})}}},a(function(){zoe.inject.init()})}(jQuery),function(a){a.fn.zoeAccordion=function(b){return a.zoeui.run.call(this,"zoeAccordion",arguments)},a.fn.zoeGetAccordionManager=function(){return a.zoeui.get(this)},a.zoeDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:!1,heightDiff:0},a.zoeMethos.Accordion={},a.zoeui.controls.Accordion=function(b,c){a.zoeui.controls.Accordion.base.constructor.call(this,b,c)},a.zoeui.controls.Accordion.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return a.zoeMethos.Accordion},_render:function(){var b=this,c=this.options;b.accordion=a(b.element),b.accordion.hasClass("l-accordion-panel")||b.accordion.addClass("l-accordion-panel");var d=0;a("> div[lselected=true]",b.accordion).length>0&&(d=a("> div",b.accordion).index(a("> div[lselected=true]",b.accordion))),a("> div",b.accordion).each(function(b,c){var e=a('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');b==d&&a(".l-accordion-toggle",e).addClass("l-accordion-toggle-open"),a(c).attr("title")&&(a(".l-accordion-header-inner",e).html(a(c).attr("title")),a(c).attr("title","")),a(c).before(e),a(c).hasClass("l-accordion-content")||a(c).addClass("l-accordion-content")}),a(".l-accordion-header",b.accordion).removeClass("l-accordion-header-downfirst"),a(".l-accordion-content:visible",b.accordion).next(".l-accordion-header:first").addClass("l-accordion-header-downfirst"),a(".l-accordion-toggle",b.accordion).each(function(){a(this).hasClass("l-accordion-toggle-open")||a(this).hasClass("l-accordion-toggle-close")||a(this).addClass("l-accordion-toggle-close"),a(this).hasClass("l-accordion-toggle-close")&&a(this).parent().next(".l-accordion-content:visible").hide()}),a(".l-accordion-header",b.accordion).hover(function(){a(this).addClass("l-accordion-header-over")},function(){a(this).removeClass("l-accordion-header-over")}),a(".l-accordion-toggle",b.accordion).hover(function(){a(this).hasClass("l-accordion-toggle-open")?a(this).addClass("l-accordion-toggle-open-over"):a(this).hasClass("l-accordion-toggle-close")&&a(this).addClass("l-accordion-toggle-close-over")},function(){a(this).hasClass("l-accordion-toggle-open")?a(this).removeClass("l-accordion-toggle-open-over"):a(this).hasClass("l-accordion-toggle-close")&&a(this).removeClass("l-accordion-toggle-close-over");
}),a(">.l-accordion-header",b.accordion).click(function(){var d=a(".l-accordion-toggle:first",this);d.hasClass("l-accordion-toggle-close")?(d.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over"),d.addClass("l-accordion-toggle-open"),a(this).next(".l-accordion-content").show(c.speed).siblings(".l-accordion-content:visible").hide(c.speed),a(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")):(d.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close"),a(this).next(".l-accordion-content").hide(c.speed)),a(".l-accordion-header",b.accordion).removeClass("l-accordion-header-downfirst"),a(".l-accordion-content:visible",b.accordion).next(".l-accordion-header:first").addClass("l-accordion-header-downfirst")}),b.headerHoldHeight=0,a("> .l-accordion-header",b.accordion).each(function(){b.headerHoldHeight+=a(this).height()}),c.height&&"string"==typeof c.height&&c.height.indexOf("%")>0?(b.onResize(),c.changeHeightOnResize&&a(window).resize(function(){b.onResize()})):c.height?(b.height=c.heightDiff+c.height,b.accordion.height(b.height),b.setHeight(c.height)):b.header=b.accordion.height(),b.set(c)},onResize:function(){var b=this,c=this.options;if(!c.height||"string"!=typeof c.height||-1==c.height.indexOf("%"))return!1;if("body"==b.accordion.parent()[0].tagName.toLowerCase()){var d=a(window).height();d-=parseInt(b.layout.parent().css("paddingTop")),d-=parseInt(b.layout.parent().css("paddingBottom")),b.height=c.heightDiff+d*parseFloat(b.height)*.01}else b.height=c.heightDiff+b.accordion.parent().height()*parseFloat(c.height)*.01;b.accordion.height(b.height),b.setContentHeight(b.height-b.headerHoldHeight)},setHeight:function(b){var c=this;this.options;c.accordion.height(b),b-=c.headerHoldHeight,a("> .l-accordion-content",c.accordion).height(b)}})}(jQuery),function(a){a.fn.zoeButton=function(b){return a.zoeui.run.call(this,"zoeButton",arguments)},a.fn.zoeGetButtonManager=function(){return a.zoeui.run.call(this,"zoeGetButtonManager",arguments)},a.zoeDefaults.Button={width:60,text:"Button",disabled:!1,click:null,icon:null},a.zoeMethos.Button={},a.zoeui.controls.Button=function(b,c){a.zoeui.controls.Button.base.constructor.call(this,b,c)},a.zoeui.controls.Button.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return a.zoeMethos.Button},_render:function(){var b=this,c=this.options;b.button=a(b.element),b.button.addClass("l-button"),b.button.append('<div class="l-button-l"></div><div class="l-button-r"></div><span></span>'),b.button.hover(function(){c.disabled||b.button.addClass("l-button-over")},function(){c.disabled||b.button.removeClass("l-button-over")}),c.click&&b.button.click(function(){c.disabled||c.click()}),b.set(c)},_setIcon:function(a){var b=this;a?(b.button.addClass("l-button-hasicon"),b.button.append('<img src="'+a+'" />')):(b.button.removeClass("l-button-hasicon"),b.button.find("img").remove())},_setEnabled:function(a){a&&this.button.removeClass("l-button-disabled")},_setDisabled:function(a){a?(this.button.addClass("l-button-disabled"),this.options.disabled=!0):(this.button.removeClass("l-button-disabled"),this.options.disabled=!1)},_setWidth:function(a){this.button.width(a)},_setText:function(b){a("span",this.button).html(b)},setValue:function(a){this.set("text",a)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",!1)},setDisabled:function(){this.set("disabled",!0)}})}(jQuery),function(a){a.fn.zoeCheckBox=function(b){return a.zoeui.run.call(this,"zoeCheckBox",arguments)},a.fn.zoeGetCheckBoxManager=function(){return a.zoeui.run.call(this,"zoeGetCheckBoxManager",arguments)},a.zoeDefaults.CheckBox={disabled:!1,readonly:!1},a.zoeMethos.CheckBox={},a.zoeui.controls.CheckBox=function(b,c){a.zoeui.controls.CheckBox.base.constructor.call(this,b,c)},a.zoeui.controls.CheckBox.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return a.zoeMethos.CheckBox},_render:function(){var b=this,c=this.options;b.input=a(b.element),b.link=a('<a class="l-checkbox"></a>'),b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent(),b.wrapper.prepend(b.link),b.link.click(function(){return b.input.attr("disabled")||b.input.attr("readonly")?!1:c.disabled||c.readonly?!1:0==b.trigger("beforeClick",[b.element])?!1:(a(this).hasClass("l-checkbox-checked")?b._setValue(!1):b._setValue(!0),void b.input.trigger("change"))}),b.wrapper.hover(function(){c.disabled||a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),this.set(c),this.updateStyle()},_setCss:function(a){this.wrapper.css(a)},_setValue:function(a){var b=this;this.options;a?(b.input[0].checked=!0,b.link.addClass("l-checkbox-checked")):(b.input[0].checked=!1,b.link.removeClass("l-checkbox-checked"))},_setDisabled:function(a){a?(this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled")):(this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"))},_getValue:function(){return this.element.checked},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")}})}(jQuery),function(a){a.fn.zoeCheckBoxList=function(b){return a.zoeui.run.call(this,"zoeCheckBoxList",arguments)},a.fn.zoeGetCheckBoxListManager=function(){return a.zoeui.run.call(this,"zoeGetCheckBoxListManager",arguments)},a.zoeDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null},a.zoeMethos.CheckBoxList=a.zoeMethos.CheckBoxList||{},a.zoeui.controls.CheckBoxList=function(b,c){a.zoeui.controls.CheckBoxList.base.constructor.call(this,b,c)},a.zoeui.controls.CheckBoxList.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return a.zoeMethos.CheckBoxList},_init:function(){a.zoeui.controls.CheckBoxList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data,b.valueField=null,c.valueFieldID?(b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input"),0==b.valueField.length&&(b.valueField=a('<input type="hidden"/>')),b.valueField[0].id=b.valueField[0].name=c.valueFieldID):(b.valueField=a('<input type="hidden"/>'),b.valueField[0].id=b.valueField[0].name=b.id+"_val"),null==b.valueField[0].name&&(b.valueField[0].name=b.valueField[0].id),c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass),b.valueField.attr("data-zoeid",b.id),b.checkboxList=a(this.element),b.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(b.valueField),b.checkboxList.table=a("table:first",b.checkboxList),b.set(c),b._addClickEven()},destroy:function(){this.checkboxList&&this.checkboxList.remove(),this.options=null,a.zoeui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setCss:function(a){a&&this.checkboxList.addClass(a)},_setDisabled:function(b){b?(this.checkboxList.addClass("l-checkboxlist-disabled"),a("input:checkbox",this.radioList).attr("disabled",!0)):(this.checkboxList.removeClass("l-checkboxlist-disabled"),a("input:checkbox",this.radioList).removeAttr("disabled"))},_setWidth:function(a){this.checkboxList.width(a)},_setHeight:function(a){this.checkboxList.height(a)},indexOf:function(a){var b=this,c=this.options;if(!b.data)return-1;for(var d=0,e=b.data.length;e>d;d++)if("object"==typeof a){if(b.data[d]==a)return d}else if(b.data[d][c.valueField].toString()==a.toString())return d;return-1},removeItems:function(b){var c=this;c.data&&(a(b).each(function(a,b){var d=c.indexOf(b);-1!=d&&c.data.splice(d,1)}),c.refresh())},removeItem:function(a){if(this.data){var b=this.indexOf(a);-1!=b&&(this.data.splice(b,1),this.refresh())}},insertItem:function(a,b){var c=this;c.data||(c.data=[]),c.data.splice(b,0,a),c.refresh()},addItems:function(b){var c=this;c.data||(c.data=[]),a(b).each(function(a,b){c.data.push(b)}),c.refresh()},addItem:function(a){var b=this;b.data||(b.data=[]),b.data.push(a),b.refresh()},_setValue:function(a){var b=this,c=this.options;c.value=a,b.valueField.val(c.value),this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(b){if(b){var c=this,d=this.options,e=a.isFunction(d.parms)?d.parms():d.parms;a.ajax({type:"post",url:b,data:e,cache:!1,dataType:"json",success:function(a){c.setData(a),c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var c=this,d=c.get("parms");d||(d={}),d[a]=b,c.set("parms",d)}},clearContent:function(){var b=this;this.options;a("table",b.checkboxList).html("")},_setData:function(a){this.setData(a)},setData:function(a){var b=this;this.options;a&&a.length&&(b.data=a,b.refresh(),b.updateStyle())},refresh:function(){var a=this,b=this.options,c=this.data;if(this.clearContent(),c){for(var d=[],e=b.rowSize,f=!1,g=b.name||a.id,h=0;h<c.length;h++){var i=c[h][b.valueField],j=c[h][b.textField],k=a.id+"-"+h,l=h%e==0;l&&(f&&d.push("</tr>"),d.push("<tr>"),f=!0),d.push("<td><input type='checkbox' name='"+g+"' value='"+i+"' id='"+k+"'/><label for='"+k+"'>"+j+"</label></td>")}f&&d.push("</tr>"),a.checkboxList.table.append(d.join(""))}},_getValue:function(){var b=this,c=this.options,d=c.name||b.id,e=[];return a('input:checkbox[name="'+d+'"]:checked').each(function(){e.push(this.value)}),e.length?e.join(c.split):null},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var a=this,b=(this.options,a.valueField.val());a._changeValue(b)},_changeValue:function(b){var c=this,d=this.options,e=d.name||c.id,f=b?b.split(d.split):[];a("input:checkbox[name='"+e+"']",c.checkboxList).each(function(){this.checked=a.inArray(this.value,f)>-1}),c.valueField.val(b),c.selectedValue=b},_addClickEven:function(){var a=this;this.options;a.checkboxList.click(function(b){var c=a.getValue();c&&a.valueField.val(c)})}})}(jQuery),function(a){a.fn.zoeComboBox=function(b){return a.zoeui.run.call(this,"zoeComboBox",arguments)},a.fn.zoeGetComboBoxManager=function(){return a.zoeui.run.call(this,"zoeGetComboBoxManager",arguments)},a.zoeDefaults.ComboBox={resize:!0,isMultiSelect:!1,isShowCheckBox:!1,columns:null,selectBoxWidth:null,selectBoxHeight:120,onBeforeSelect:!1,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:!1,split:";",data:null,tree:null,treeLeafOnly:!0,condition:null,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:!0,hideGridOnLoseFocus:!1,url:null,emptyText:null,addRowButton:"新增",addRowButtonClick:null,triggerIcon:null,onSuccess:null,onError:null,onBeforeOpen:null,dblClickCombobox:!1,onAfterOpen:null,onButtonClick:null,render:null,absolute:!0,cancelable:!0,css:null,parms:null,renderItem:null,autocomplete:!1,highLight:!1,autoSpellCode:!0,readonly:!1,ajaxType:"post",alwayShowInTop:!1,isResize:!1,autoWidth:!1,valueFieldCssClass:null,keySupport:!1,isDataNull:!0,dataNullMess:"暂无数据",clickEve:null},a.zoeDefaults.ComboBoxString={Search:"搜索"},a.zoeMethos.ComboBox=a.zoeMethos.ComboBox||{},a.zoeui.controls.ComboBox=function(b,c){a.zoeui.controls.ComboBox.base.constructor.call(this,b,c)},a.zoeui.controls.ComboBox.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return a.zoeMethos.ComboBox},_init:function(){a.zoeui.controls.ComboBox.base._init.call(this);var b=this.options;b.columns&&(b.isShowCheckBox=!0),b.isMultiSelect&&(b.isShowCheckBox=!0)},_render:function(){var b=this,c=this.options;b.data=c.data,b.inputText=null,b.select=null,b.textFieldID="",b.valueFieldID="",b.valueField=null,"input"==this.element.tagName.toLowerCase()?(this.element.readOnly=!0,b.inputText=a(this.element),b.textFieldID=this.element.id):"select"==this.element.tagName.toLowerCase()&&(a(this.element).hide(),b.select=a(this.element),c.isMultiSelect=!1,c.isShowCheckBox=!1,c.cancelable=!1,b.textFieldID=this.element.id+"_txt",b.inputText=a('<input type="text" readonly="true"/>'),b.inputText.attr("id",b.textFieldID).insertAfter(a(this.element))),void 0==b.inputText[0].name&&(b.inputText[0].name=b.textFieldID),b.valueField=null,b.inputText.attr("data-comboboxid",b.id),c.valueFieldID?(b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input").filter("input:hidden"),0==b.valueField.length&&(b.valueField=a('<input type="hidden"/>')),b.valueField[0].id=b.valueField[0].name=c.valueFieldID):(b.valueField=a('<input type="hidden"/>'),b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"),c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass),void 0==b.valueField[0].name&&(b.valueField[0].name=b.valueField[0].id),null!=c.initValue&&(b.valueField[0].value=c.initValue),b.valueField.attr("data-zoeid",b.id),b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),c.triggerIcon&&b.link.find("div:first").addClass(c.triggerIcon),b.selectBox=a('<div class="l-box-select" style="display:none"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>'),b.selectBox.table=a("table:first",b.selectBox),b.selectBoxInner=b.selectBox.find(".l-box-select-inner:first"),b.wrapper=b.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.wrapper.append(b.link),b.textwrapper=b.wrapper.wrap('<div class="l-text-wrapper"></div>').parent(),c.absolute?b.selectBox.appendTo("body").addClass("l-box-select-absolute"):b.textwrapper.append(b.selectBox),b.textwrapper.append(b.valueField),b.inputText.addClass("l-text-field"),c.isShowCheckBox&&!b.select?a("table",b.selectBox).addClass("l-table-checkbox"):(c.isShowCheckBox=!1,a("table",b.selectBox).addClass("l-table-nocheckbox")),b.link.hover(function(){c.disabled||c.readonly||(this.className="l-trigger-hover")},function(){c.disabled||c.readonly||(this.className="l-trigger")}).mousedown(function(){c.disabled||c.readonly||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||c.readonly||(this.className="l-trigger-hover")}).click(function(){if(!c.disabled&&!c.readonly){if(0==b.trigger("buttonClick"))return!1;if(0==b.trigger("beforeOpen"))return!1;b._setWidth(),b._toggleSelectBox(b.selectBox.is(":visible"))}}),c.dblClickCombobox&&b.inputText.dblclick(function(){return 0==b.trigger("afterOpen")?!1:void 0}),b.inputText.click(function(){if(!c.disabled&&!c.readonly){if(0==b.trigger("beforeOpen"))return!1;b._setWidth(),b._toggleSelectBox(b.selectBox.is(":visible")),a.isFunction(c.clickEve)&&c.clickEve()}}).blur(function(){c.disabled||b.wrapper.removeClass("l-text-focus")}).focus(function(){c.disabled||c.readonly||b.wrapper.addClass("l-text-focus")}),b.wrapper.hover(function(){c.disabled||c.readonly||b.wrapper.addClass("l-text-over")},function(){c.disabled||c.readonly||b.wrapper.removeClass("l-text-over")}),b.resizing=!1,b.selectBox.hover(null,function(a){c.hideOnLoseFocus&&b.selectBox.is(":visible")&&!b.boxToggling&&!b.resizing&&b._toggleSelectBox(!0)}),b.bulidContent(),b.set(c),c.selectBoxWidth?b.selectBox.width(c.selectBoxWidth):b.selectBox.css("width",b.wrapper.css("width")),c.grid&&b.bind("show",function(){b.grid||(b.setGrid(c.grid),b.set("SelectBoxHeight",c.selectBoxHeight))}),b.updateSelectBoxPosition(),a(document).bind("click.combobox",function(c){b.selectBox.is(":visible")&&0==a(c.target||c.srcElement).closest(".l-box-select, .l-text-combobox").length&&b._toggleSelectBox(!0)})},destroy:function(){this.wrapper&&this.wrapper.remove(),this.selectBox&&this.selectBox.remove(),this.options=null,a.zoeui.remove(this)},clear:function(){this._changeValue("",""),a("a.l-checkbox-checked",this.selectBox).removeClass("l-checkbox-checked"),a("td.l-selected",this.selectBox).removeClass("l-selected"),a(":checkbox",this.selectBox).each(function(){this.checked=!1}),this.trigger("clear")},_setSelectBoxHeight:function(b){if(b){var c=this,d=this.options;if(d.grid)c.grid&&c.grid.set("height",c.getGridHeight(b));else if(!d.tree){var e=a("tr",c.selectBox.table).length;!d.selectBoxHeight&&8>e&&(d.selectBoxHeight=30*e),d.selectBoxHeight&&(8>e?c.selectBoxInner.height("auto"):c.selectBoxInner.height(d.selectBoxHeight))}}},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(b){var c=this,d=this.options;!b&&c.unselect&&(c.unselect.remove(),c.unselect=null),(b||c.unselect)&&(c.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),c.wrapper.hover(function(){c.unselect.show()},function(){c.unselect.hide()}),d.disabled||d.readonly||!d.cancelable||c.wrapper.append(c.unselect),c.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){c.clear()}))},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setReadonly:function(a){a?this.wrapper.addClass("l-text-readonly"):this.wrapper.removeClass("l-text-readonly")},_setLable:function(b){var c=this,d=this.options;b&&(c.labelwrapper?c.labelwrapper.find(".l-text-label:first").html(b+":&nbsp"):(c.labelwrapper=c.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),c.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+b+":&nbsp</div>"),c.textwrapper.css("float","left")),d.labelWidth?a(".l-text-label",c.labelwrapper).outerWidth(d.labelWidth):d.labelWidth=a(".l-text-label",c.labelwrapper).outerWidth(),a(".l-text-label",c.labelwrapper).width(d.labelWidth),a(".l-text-label",c.labelwrapper).height(c.wrapper.height()),c.labelwrapper.append('<br style="clear:both;" />'),d.labelAlign&&a(".l-text-label",c.labelwrapper).css("text-align",d.labelAlign),c.textwrapper.css({display:"inline"}),c.labelwrapper.width(c.wrapper.outerWidth()+d.labelWidth+2))},_setWidth:function(a){var b=this,c=this.options;a>20&&(b.wrapper.css({width:a}),b.inputText.css({width:a-20}),c.selectBoxWidth||b.selectBox.css({width:a})),c.autoWidth&&!c.isResize&&void 0==a&&(c.selectBoxWidth||b.selectBox.css({width:b.wrapper.width()-2}))},_setHeight:function(a){var b=this;a>10&&(b.wrapper.height(a),b.inputText.height(a-2))},_setResize:function(b){var c=this,d=this.options;if(!d.columns&&d.isResize&&b&&a.fn.zoeResizable){var e=d.selectBoxHeight?"e":"se,s,e";c.selectBox.zoeResizable({handles:e,onStartResize:function(){c.resizing=!0,c.trigger("startResize")},onEndResize:function(){return c.resizing=!1,0==c.trigger("endResize")?!1:void 0},onStopResize:function(a,b){return c.grid?(a.newWidth&&c.selectBox.width(a.newWidth),a.newHeight&&c.set({selectBoxHeight:a.newHeight}),c.grid.refreshSize(),c.trigger("endResize"),!1):!0}}),c.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(b){var c=this,d=this.options;if(null==b)return"";var e,f="",g=function(a){for(var c=b.toString().split(d.split),e=0;e<c.length;e++)if(c[e]==a)return!0;return!1};return e=c.options.grid&&c.options.grid.data?c.options.grid.data.Rows:c.data,a(e).each(function(a,b){var c=b[d.valueField],e=b[d.textField];g(c)&&(f+=e+d.split)}),f.length>0&&(f=f.substr(0,f.length-1)),f},findValueByText:function(b){var c=this,d=this.options;if(!b&&""==b)return"";var e=function(a){for(var c=b.toString().split(d.split),e=0;e<c.length;e++)if(c[e]==a)return!0;return!1},f="";return a(c.data).each(function(a,b){var c=b[d.valueField],g=b[d.textField];e(g)&&(f+=c+d.split)}),f.length>0&&(f=f.substr(0,f.length-1)),f},insertItem:function(a,b){var c=this;this.options;c.data=c.data||[],c.data.splice(b,0,a),c.setData(c.data)},addItem:function(a){var b=this;this.options;b.insertItem(a,(b.data||[]).length)},_setValue:function(b,c){var d=this,e=this.options;if(c=d.findTextByValue(b),e.tree)d.selectValueByTree(b);else if(e.isMultiSelect){if(d._changeValue(b,c),null!=b){b.toString().split(e.split);d._setData(d.data)}}else d._changeValue(b,c),a("tr[value='"+b+"'] td",d.selectBox).addClass("l-selected"),a("tr[value!='"+b+"'] td",d.selectBox).removeClass("l-selected")},selectValue:function(a){this._setValue(a)},bulidContent:function(){var a=this,b=this.options;this.clearContent(),a.select?a.setSelect():b.tree&&a.setTree(b.tree)},reload:function(){var a=this,b=this.options;b.url?a.set("url",b.url):a.grid&&a.grid.reload()},_setUrl:function(b){if(b){var c=this,d=this.options,e=a.isFunction(d.parms)?d.parms():d.parms;a.ajax({type:d.ajaxType,url:b,data:e,cache:!1,dataType:"json",success:function(a){c.setData(a),c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var c=this,d=c.get("parms");d||(d={}),d[a]=b,c.set("parms",d)}},clearContent:function(){var b=this,c=this.options;a("table",b.selectBox).html(""),b._setSelectBoxHeight(c.selectBoxHeight)},setSelect:function(){var b=this,c=this.options;this.clearContent(),a("option",b.select).each(function(c){var d=a(this).val(),e=a(this).html(),f=a("<tr><td index='"+c+"' value='"+d+"' text='"+e+"'>"+e+"</td>");a("table.l-table-nocheckbox",b.selectBox).append(f),a("td",f).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})}),a("td:eq("+b.select[0].selectedIndex+")",b.selectBox).each(function(){if(a(this).hasClass("l-selected"))return void b.selectBox.hide();a(".l-selected",b.selectBox).removeClass("l-selected"),a(this).addClass("l-selected"),b.select[0].selectedIndex!=a(this).attr("index")&&b.select[0].onchange&&(b.select[0].selectedIndex=a(this).attr("index"),b.select[0].onchange());var d=parseInt(a(this).attr("index"));b.select[0].selectedIndex=d,b.select.trigger("change"),b.selectBox.hide();var e=a(this).attr("value"),f=a(this).html();c.render?b.inputText.val(c.render(e,f)):b.inputText.val(f)}),b._addClickEven()},_setData:function(a){this.setData(a)},setData:function(b){var c=this,d=this.options;if(!c.select){if(!b||!b.length){b=[];try{d.isDataNull&&(b[0]={},b[0][d.textField]=d.dataNullMess)}catch(e){return}}if(c.data!=b&&(c.data=b),this.clearContent(),d.columns){c.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px'></td></tr>"),c.selectBox.table.append(c.selectBox.table.headrow),c.selectBox.table.addClass("l-box-select-grid");for(var f=0;f<d.columns.length;f++){var g=a("<td columnindex='"+f+"' columnname='"+d.columns[f].name+"'>"+d.columns[f].header+"</td>");d.columns[f].width&&g.width(d.columns[f].width),c.selectBox.table.headrow.append(g)}}var h=[];!d.emptyText||c.emptyRow||0!=b.length&&b[0][d.textField]==d.emptyText||(c.emptyRow={},c.emptyRow[d.textField]=d.emptyText,c.emptyRow[d.valueField]=null,b.splice(0,0,c.emptyRow));for(var i=0;i<b.length;i++){var j=b[i][d.valueField],k=b[i][d.textField];if(d.columns){h.push("<tr value='"+j+"'><td style='width:18px;'  index='"+i+"' value='"+j+"' text='"+k+"' ><input type='checkbox' /></td>");for(var f=0;f<d.columns.length;f++){var l=d.columns[f].name;h.push("<td>"+b[i][l]+"</td>")}h.push("</tr>")}else{h.push("<tr value='"+j+"'>"),d.isShowCheckBox&&h.push("<td style='width:18px;'  index='"+i+"' value='"+j+"' text='"+k+"' ><input type='checkbox' /></td>");var m=k;d.renderItem?m=d.renderItem.call(c,{data:b[i],value:j,text:k,key:c.inputText.val()}):d.autocomplete&&d.highLight&&(m=c._highLight(k,c.inputText.val())),h.push("<td index='"+i+"' value='"+j+"' text='"+k+"' align='left'>"+m+"</td></tr>")}}d.columns?c.selectBox.table.append(h.join("")):d.isShowCheckBox?a("table.l-table-checkbox",c.selectBox).append(h.join("")):a("table.l-table-nocheckbox",c.selectBox).append(h.join("")),d.addRowButton&&d.addRowButtonClick&&!c.addRowButton&&(c.addRowButton=a('<div class="l-box-select-add"><a href="javascript:void(0)" class="link"><div class="icon"></div></a></div>'),c.addRowButton.find(".link").append(d.addRowButton).click(d.addRowButtonClick),c.selectBoxInner.after(c.addRowButton)),c.set("selectBoxHeight",d.selectBoxHeight),d.isShowCheckBox&&a.fn.zoeCheckBox&&a("table input:checkbox",c.selectBox).zoeCheckBox(),a(".l-table-checkbox input:checkbox",c.selectBox).change(function(){if(this.checked&&c.hasBind("beforeSelect")){var b=null;if(b="div"==a(this).parent().get(0).tagName.toLowerCase()?a(this).parent().parent():a(this).parent(),null!=b&&0==c.trigger("beforeSelect",[b.attr("value"),b.attr("text")]))return c.selectBox.slideToggle("fast"),!1}d.isMultiSelect||this.checked&&(a("input:checked",c.selectBox).not(this).each(function(){this.checked=!1,a(".l-checkbox-checked",a(this).parent()).removeClass("l-checkbox-checked")}),c.selectBox.slideToggle("fast")),c._checkboxUpdateValue()}),a("table.l-table-nocheckbox td",c.selectBox).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),c._addClickEven(),d.autocomplete||c.updateStyle()}},setTree:function(b){var c=this,d=this.options;this.clearContent(),c.selectBox.table.remove(),0!=b.checkbox?b.onCheck=function(){var b=c.treeManager.getChecked(),e=[],f=[];a(b).each(function(a,b){d.treeLeafOnly&&b.data.children||(e.push(b.data[d.valueField]),f.push(b.data[d.textField]))}),c._changeValue(e.join(d.split),f.join(d.split))}:(b.onSelect=function(a){if(!(0==c.trigger("BeforeSelect"[a])||d.treeLeafOnly&&a.data.children)){var b=a.data[d.valueField],e=a.data[d.textField];c._changeValue(b,e),c.selectBox.hide()}},b.onCancelSelect=function(a){c._changeValue("","")}),b.onAfterAppend=function(a,b){if(c.treeManager){var e=null;d.initValue?e=d.initValue:""!=c.valueField.val()&&(e=c.valueField.val()),c.selectValueByTree(e)}},c.tree=a("<ul></ul>"),a("div:first",c.selectBox).append(c.tree),c.innerTree=c.tree.zoeTree(b),c.treeManager=c.tree.zoeGetTreeManager()},getTree:function(){return this.innerTree},selectValueByTree:function(b){var c=this,d=this.options;if(null!=b){var e="",f=b.toString().split(d.split);a(f).each(function(a,b){c.treeManager.selectNode(b.toString()),e+=c.treeManager.getTextByID(b),a<f.length-1&&(e+=d.split)}),c._changeValue(b,e)}},setGrid:function(b){var c=this,d=this.options;if(!c.grid){d.hideOnLoseFocus=d.hideGridOnLoseFocus?!0:!1,this.clearContent(),c.selectBox.addClass("l-box-select-lookup"),c.selectBox.table.remove();var e=a("div:first",c.selectBox),f=a("<div></div>").appendTo(e),g=a("<div></div>").appendTo(e);if(c.conditionPanel=f,d.condition){var h=a.extend({labelWidth:60,space:20,width:d.selectBoxWidth},d.condition);c.condition=f.zoeForm(h)}else f.remove();b=a.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0,allowUnSelectRow:!0},b,{width:"100%",height:c.getGridHeight(),inWindow:!1,parms:d.parms,isChecked:function(b){var e=c.getValue();return e&&d.valueField&&b[d.valueField]?-1!=a.inArray(b[d.valueField].toString(),e.split(d.split)):!1}}),c.grid=c.gridManager=g.zoeGrid(b),c.grid.bind("afterShowData",function(){c.updateSelectBoxPosition()});var i=[],j=function(){var e=[],f=[];a(i).each(function(a,b){e.push(b[d.valueField]),f.push(b[d.textField])}),b.checkbox?c.selected=i:i.length?c.selected=i[0]:c.selected=null,c._changeValue(e.join(d.split),f.join(d.split)),c.trigger("gridSelect",{value:e.join(d.split),text:f.join(d.split),data:i})},k=function(a){for(var b=i.length-1;b>=0;b--)i[b][d.valueField]==a[d.valueField]&&i.splice(b,1)},l=function(a){for(var b=i.length-1;b>=0;b--)if(i[b][d.valueField]==a[d.valueField])return;i.push(a)};if(b.checkbox){var m=function(a,b){a&&l(b),!a&&k(b)};c.grid.bind("CheckAllRow",function(b){a(c.grid.rows).each(function(a,c){m(b,c)}),j()}),c.grid.bind("CheckRow",function(a,b){m(a,b),j()})}else c.grid.bind("SelectRow",function(a){i=[a],j(),c._toggleSelectBox(!0)}),c.grid.bind("UnSelectRow",function(){i=[],j()});if(c.bind("show",function(){c.grid.refreshSize()}),c.bind("clear",function(){i=[],c.grid.selecteds=[],c.grid._showData()}),d.condition){var n=a('<li style="margin-right:9px"><div></div></li>'),o=a('<li style="margin-right:9px;float:right"><div></div></li>');a("ul:first",f).append(n).append(o).after('<div class="l-clear"></div>'),a("div",n).zoeButton({text:d.Search,width:40,click:function(){var d=c.condition.toConditions();c.grid.setParm(b.conditionParmName||"condition",a.zoeui.toJSON(d)),c.grid.reload()}}),a("div",o).zoeButton({text:"关闭",width:40,click:function(){c.selectBox.hide()}})}c.grid.refreshSize()}},getGridHeight:function(a){var b=this;this.options;return a=a||b.selectBox.height(),a-=b.conditionPanel.height()},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},getSelected:function(){return this.selected},upFocus:function(){var a=this,b=(this.options,a.selectBox.table.find("td.l-over").attr("index"));void 0!=b&&"0"!=b&&(b=parseInt(b)-1,a.selectBox.table.find("td.l-over").removeClass("l-over"),a.selectBox.table.find("td[index="+b+"]").addClass("l-over"),a._scrollAdjust(b))},downFocus:function(){var a=this,b=(this.options,a.selectBox.table.find("td.l-over").attr("index"));b!=a.data.length-1&&(b=void 0==b?0:parseInt(b)+1,a.selectBox.table.find("td.l-over").removeClass("l-over"),a.selectBox.table.find("td[index="+b+"]").addClass("l-over"),a._scrollAdjust(b))},_scrollAdjust:function(b){var c=this,d=(this.options,a(".l-box-select-inner",c.selectBox).height()),e=a(".l-box-select-inner table",c.selectBox).height();if(!(d>=e)){var f=(parseInt(e/d)+(e%d?1:0),e/c.data.length),g=parseInt((b+1)*f/d)+((b+1)*f%d?1:0);a(".l-box-select-inner",c.selectBox).scrollTop((g-1)*d)}},getText:function(){return this.inputText.val()},setText:function(a){this.inputText.val(a)},updateStyle:function(){var a=this,b=this.options;b.initValue=a._getValue(),a._dataInit()},_dataInit:function(){var b=this,c=this.options,d=null;if(null!=c.initValue&&null!=c.initText&&b._changeValue(c.initValue,c.initText),null!=c.initValue){if(d=c.initValue,c.tree)d&&b.selectValueByTree(d);else if(b.data){var e=b.findTextByValue(d);b._changeValue(d,e)}}else if(""!=b.valueField.val())if(d=b.valueField.val(),c.tree)d&&b.selectValueByTree(d);else if(b.data){var e=b.findTextByValue(d);b._changeValue(d,e)}c.isShowCheckBox?a(":checkbox",b.selectBox).each(function(){var b=null,e=a(this);if(b="div"==e.parent().get(0).tagName.toLowerCase()?e.parent().parent():e.parent(),null!=b){a(".l-checkbox",b).removeClass("l-checkbox-checked"),e[0].checked=!1;var f=(d||"").toString().split(c.split);a(f).each(function(c,f){null!=d&&f==b.attr("value")&&(a(".l-checkbox",b).addClass("l-checkbox-checked"),e[0].checked=!0)})}}):a("table tr",b.selectBox).find("td:first").each(function(){null!=d&&d==a(this).attr("value")?a(this).addClass("l-selected"):a(this).removeClass("l-selected")})},_changeValue:function(a,b){var c=this,d=this.options;c.valueField.val(a),d&&d.render?c.inputText.val(d.render(a,b)):c.inputText.val(b),c.selectedValue=a,c.selectedText=b,c.inputText.trigger("change").focus(),c.trigger("selected",[a,b])},_checkboxUpdateValue:function(){var b=this,c=this.options,d="",e="";a("input:checked",b.selectBox).each(function(){var b=null;b="div"==a(this).parent().get(0).tagName.toLowerCase()?a(this).parent().parent():a(this).parent(),b&&(d+=b.attr("value")+c.split,e+=b.attr("text")+c.split)}),d.length>0&&(d=d.substr(0,d.length-1)),e.length>0&&(e=e.substr(0,e.length-1)),b._changeValue(d,e)},enabledLoadDetail:function(){var a=this.options;return a.detailUrl&&a.detailEnabled?!0:!1},_addClickEven:function(){var b=this,c=this.options;a(".l-table-nocheckbox td",b.selectBox).click(function(){var d=a(this).attr("value"),e=parseInt(a(this).attr("index")),f=a(this).attr("text");if(f!=c.dataNullMess){if(b.hasBind("beforeSelect")&&0==b.trigger("beforeSelect",[d,f]))return c.slide?b.selectBox.slideToggle("fast"):b.selectBox.hide(),
!1;if(a(this).hasClass("l-selected"))return void(c.slide?b.selectBox.slideToggle("fast"):b.selectBox.hide());a(".l-selected",b.selectBox).removeClass("l-selected"),a(this).addClass("l-selected"),b.select&&b.select[0].selectedIndex!=e&&(b.select[0].selectedIndex=e,b.select.trigger("change")),c.slide?(b.boxToggling=!0,b.selectBox.hide("fast",function(){b.boxToggling=!1})):b.selectBox.hide(),b._changeValue(d,f)}})},updateSelectBoxPosition:function(){var b=this,c=this.options;if(c&&c.absolute){var d=a(document).height();c.alwayShowInTop||Number(b.wrapper.offset().top+1+b.wrapper.outerHeight()+b.selectBox.height())>d&&d>Number(b.selectBox.height()+1)?b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top-1-b.selectBox.height()}):b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top+1+b.wrapper.outerHeight()})}else{var e=b.wrapper.offset().top-a(window).scrollTop(),f=b.selectBox.height()+textHeight+4;e+f>a(window).height()&&e>f&&b.selectBox.css("marginTop",-1*(b.selectBox.height()+textHeight+5))}},_toggleSelectBox:function(b){var c=this,d=this.options;if(c&&d){for(var e=a.zoeui.find(a.zoeui.controls.ComboBox),f=0,g=e.length;g>f;f++){var h=e[f];h.id!=c.id&&null!=h.selectBox.is(":visible")&&h.selectBox.is(":visible")&&h.selectBox.hide()}e=a.zoeui.find(a.zoeui.controls.DateEditor);for(var f=0,g=e.length;g>f;f++){var h=e[f];h.id!=c.id&&null!=h.dateeditor.is(":visible")&&h.dateeditor.is(":visible")&&h.dateeditor.hide()}c.wrapper.height();if(c.boxToggling=!0,b)d.slide?c.selectBox.slideToggle("fast",function(){c.boxToggling=!1}):(c.selectBox.hide(),c.boxToggling=!1);else if(c.updateSelectBoxPosition(),d.slide)c.selectBox.slideToggle("fast",function(){if(c.boxToggling=!1,!d.isShowCheckBox&&a("td.l-selected",c.selectBox).length>0){var b=a("td.l-selected",c.selectBox).offset().top-c.selectBox.offset().top;a(".l-box-select-inner",c.selectBox).animate({scrollTop:b})}});else if(c.selectBox.show(),c.boxToggling=!1,!c.tree&&!c.grid&&!d.isShowCheckBox&&a("td.l-selected",c.selectBox).length>0){var i=a("td.l-selected",c.selectBox).offset().top-c.selectBox.offset().top;a(".l-box-select-inner",c.selectBox).animate({scrollTop:i})}c.isShowed=c.selectBox.is(":visible"),c.trigger("toggle",[b]),c.trigger(b?"hide":"show")}},_highLight:function(a,b){if(!a)return a;var c=a.indexOf(b);return-1==c?a:a.substring(0,c)+"<span class='l-highLight'>"+b+"</span>"+a.substring(b.length+c)},_setAutocomplete:function(a){var b=this,c=this.options;if(a){b.inputText.removeAttr("readonly");var d=b.inputText.val();b.inputText.keyup(function(){this._acto&&clearTimeout(this._acto),this._acto=setTimeout(function(){if(d!=b.inputText.val()){if(c.initValue="",b.valueField.val(""),c.url)b.setParm("key",b.inputText.val()),b.set("url",c.url),b.selectBox.show();else if(c.grid)b.grid.setParm("key",b.inputText.val()),b.grid.reload();else if(c.data){b.showData=[];var a=b.inputText.val().toUpperCase();for(var e in c.data){var f,g=c.data[e][c.textField].toUpperCase();c.autoSpellCode&&c.data[e].spellCode&&(f=c.data[e].spellCode.toUpperCase()),g.indexOf(a)>-1?b.showData.push(c.data[e]):f&&f.indexOf(a)>-1&&b.showData.push(c.data[e])}b._setData(b.showData),b.selectBox.show()}d=b.inputText.val(),this._acto=null}},300)})}}}),a.zoeui.controls.ComboBox.prototype.setValue=a.zoeui.controls.ComboBox.prototype.selectValue,a.zoeui.controls.ComboBox.prototype.setInputValue=a.zoeui.controls.ComboBox.prototype._changeValue,function(){a(document).unbind("keydown.zoecombobox"),a(document).bind("keydown.zoecombobox",function(b){function c(){g.selectBox.is(":visible")||g.selectBox.show(),g.downFocus()}function d(){g._changeValue(i,h.attr("text"),!0),g.selectBox.hide(),g.trigger("textBoxKeyEnter",[{element:h.get(0)}])}var e=document.activeElement;if(a(e).is(":text")){var f=a(e);if(f.length&&f.attr("data-comboboxid")){var g=zoe.get(f.attr("data-comboboxid"));if(!g)return;if(!g.get("keySupport"))return;if(38==b.keyCode)g.upFocus();else if(40==b.keyCode)g.hasBind("textBoxKeyDown")?g.trigger("textBoxKeyDown",[{callback:function(){c()}}]):c();else if(13==b.keyCode){if(!g.selectBox.is(":visible"))return;var h=g.selectBox.table.find("td.l-over");if(h.length){var i=h.attr("value");g.enabledLoadDetail()?g.loadDetail(i,function(a){var b=g.getRowIndex(i);-1!=b&&(g.data=g.data||[],g.data[b]=g.selected=a,d())}):d()}else""!=g.selectedValue&&void 0!=g.selectedValue&&null!=g.selectedValue&&(g._changeValue(g.selectedValue,g.selectedText,!0),g.selectBox.hide())}}}})}()}(jQuery),function($){$.fn.zoeDateEditor=function(){return $.zoeui.run.call(this,"zoeDateEditor",arguments)},$.fn.zoeGetDateEditorManager=function(){return $.zoeui.run.call(this,"zoeGetDateEditorManager",arguments)},$.zoeDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",width:null,showTime:!1,onChangeDate:!1,absolute:!0,cancelable:!0,readonly:!1,inputReadonly:!0,onSetValue:null,timeOnly:!1,target:[]},$.zoeDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",currentMessage:"当前",closeMessage:"关闭"},$.zoeMethos.DateEditor={},$.zoeui.controls.DateEditor=function(a,b){$.zoeui.controls.DateEditor.base.constructor.call(this,a,b)},$.zoeui.controls.DateEditor.zoeExtend($.zoeui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return $.zoeMethos.DateEditor},_render:function(){var a=this,b=this.options;if(!b.showTime&&b.format.indexOf(" hh:mm")>-1&&(b.format=b.format.replace(" hh:mm","")),"input"==this.element.tagName.toLowerCase()&&"text"==this.element.type){a.inputText=$(this.element),a.inputText.hasClass("l-text-field")||a.inputText.addClass("l-text-field"),b.timeOnly?a.link=$('<div class="l-trigger"><div class="zoe-trigger-icon"></div></div>'):a.link=$('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),a.text=a.inputText.wrap('<div class="l-text l-text-date"></div>').parent(),a.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),a.text.append(a.link),a.textwrapper=a.text.wrap('<div class="l-text-wrapper"></div>').parent();var c="";if(c+="<div class='l-box-dateeditor' style='display:none'>",b.timeOnly||(c+="    <div class='l-box-dateeditor-header'>",c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>",c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>",c+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>",c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>",c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>",c+="    </div>"),c+="    <div class='l-box-dateeditor-body'>",b.timeOnly){c+="       <div class='zoe-time'>",c+="            <div class='zoe-time-top'>快速选择</div>",c+="            <ul class='zoe-time-begin'>";for(var d=0;d<b.target.length;d+=2)c+="                 <li><span>"+b.target[d]+"</span>:<span>"+b.target[d+1]+"</span></li>";c+="                 </ul> ",c+="       </div> "}else c+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>",c+="            <thead>",c+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",c+="            </thead>",c+="            <tbody>",c+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",c+="            </tbody>",c+="        </table>";c+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",c+="        <div class='l-box-dateeditor-yearselector'><ul><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><span class='l-box-dateeditor-arr-l'></span><span class='l-box-dateeditor-arr-r'></span><div class='clear'></div></div>",c+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",c+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",c+="    </div>",c+="    <div class='l-box-dateeditor-toolbar'>",c+="        <div class='l-box-dateeditor-time'><div class='hourspinner'><a class='hourspinnerup'></a><a class='hourspinnerdown'></a></div><div class='minutespinner'><a class='minutespinnerup'></a><a class='minutespinnerdown'></a></div></div>",c+="        <div class='l-button l-button-today'></div>",c+="        <div class='l-button l-button-close'></div>",c+="        <div class='l-clear'></div>",c+="    </div>",c+="</div>",a.dateeditor=$(c),b.absolute?a.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute"):a.textwrapper.append(a.dateeditor),a.header=$(".l-box-dateeditor-header",a.dateeditor),a.body=$(".l-box-dateeditor-body",a.dateeditor),a.quickSelect=$(".zoe-time",a.body),b.timeOnly&&$(".l-box-dateeditor-body").css("border-top","none"),a.toolbar=$(".l-box-dateeditor-toolbar",a.dateeditor),a.body.thead=$("thead",a.body),a.body.tbody=$("tbody",a.body),a.body.monthselector=$(".l-box-dateeditor-monthselector",a.body),a.body.yearselector=$(".l-box-dateeditor-yearselector",a.body),a.body.hourselector=$(".l-box-dateeditor-hourselector",a.body),a.body.minuteselector=$(".l-box-dateeditor-minuteselector",a.body),a.body.yearBtnLeft=$(".l-box-dateeditor-arr-l",a.body),a.body.yearBtnRight=$(".l-box-dateeditor-arr-r",a.body),a.toolbar.time=$(".l-box-dateeditor-time",a.toolbar),a.toolbar.hourspinner=$(".hourspinner",a.toolbar.time),a.toolbar.hourspinnerup=$(".hourspinnerup",a.toolbar.hourspinner),a.toolbar.hourspinnerdown=$(".hourspinnerdown",a.toolbar.hourspinner),a.toolbar.minutespinner=$(".minutespinner",a.toolbar.time),a.toolbar.minutespinnerup=$(".minutespinnerup",a.toolbar.minutespinner),a.toolbar.minutespinnerdown=$(".minutespinnerdown",a.toolbar.minutespinner),a.toolbar.time.hour=$("<a></a>"),a.toolbar.time.minute=$("<a></a>"),a.buttons={btnPrevYear:$(".l-box-dateeditor-header-prevyear",a.header),btnNextYear:$(".l-box-dateeditor-header-nextyear",a.header),btnPrevMonth:$(".l-box-dateeditor-header-prevmonth",a.header),btnNextMonth:$(".l-box-dateeditor-header-nextmonth",a.header),btnYear:$(".l-box-dateeditor-header-year",a.header),btnMonth:$(".l-box-dateeditor-header-month",a.header),btnToday:$(".l-button-today",a.toolbar),btnClose:$(".l-button-close",a.toolbar)};var e=new Date;a.now={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()},a.currentDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()},a.selectedDate=null,a.usedDate=null,$("td",a.body.thead).each(function(a,c){$(c).html(b.dayMessage[a])}),$("li",a.body.monthselector).each(function(a,c){$(c).html(b.monthMessage[a])}),b.timeOnly?a.buttons.btnToday.html(b.currentMessage):a.buttons.btnToday.html(b.todayMessage),a.buttons.btnClose.html(b.closeMessage),b.showTime&&(a.toolbar.time.show(),a.toolbar.hourspinner.show(),a.toolbar.minutespinner.show(),a.toolbar.time.append(a.toolbar.time.hour).append(":").append(a.toolbar.time.minute),$("li",a.body.hourselector).each(function(a,b){var c=a;10>a&&(c="0"+a.toString()),$(this).html(c)}),$("li",a.body.minuteselector).each(function(a,b){var c=a;10>a&&(c="0"+a.toString()),$(this).html(c)})),a.bulidContent(),b.initValue&&a.inputText.val(b.initValue),""!=a.inputText.val()&&a.onTextChange(),a.dateeditor.hover(null,function(b){a.dateeditor.is(":visible")&&!a.editorToggling&&a.toggleDateEditor(!0)}),a.link.hover(function(){b.disabled||(this.className="l-trigger-hover")},function(){b.disabled||(this.className="l-trigger")}).mousedown(function(){b.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){b.disabled||(this.className="l-trigger-hover")}).click(function(){b.disabled||(a.bulidContent(),a.toggleDateEditor(a.dateeditor.is(":visible")))}),a.inputText.click(function(){b.disabled||(a.bulidContent(),a.toggleDateEditor(a.dateeditor.is(":visible")))}),b.disabled&&(a.inputText.attr("readonly","readonly"),a.text.addClass("l-text-disabled")),a.buttons.btnClose.click(function(){a.toggleDateEditor(!0)}),$("td",a.body.tbody).hover(function(){$(this).hasClass("l-box-dateeditor-today")||$(this).addClass("l-box-dateeditor-over")},function(){$(this).removeClass("l-box-dateeditor-over")}).click(function(){$(".l-box-dateeditor-selected",a.body.tbody).removeClass("l-box-dateeditor-selected"),$(this).hasClass("l-box-dateeditor-today")||$(this).addClass("l-box-dateeditor-selected"),a.currentDate.date=parseInt($(this).html()),a.currentDate.day=new Date(a.currentDate.year,a.currentDate.month-1,1).getDay(),$(this).hasClass("l-box-dateeditor-out")&&(0==$("tr",a.body.tbody).index($(this).parent())?0==--a.currentDate.month&&(a.currentDate.month=12,a.currentDate.year--):13==++a.currentDate.month&&(a.currentDate.month=1,a.currentDate.year++)),a.selectedDate={year:a.currentDate.year,month:a.currentDate.month,date:a.currentDate.date},a.showDate(),a.editorToggling=!0,a.dateeditor.slideToggle("fast",function(){a.editorToggling=!1})}),$(".l-box-dateeditor-header-btn",a.header).hover(function(){$(this).addClass("l-box-dateeditor-header-btn-over")},function(){$(this).removeClass("l-box-dateeditor-header-btn-over")}),a.body.yearBtnLeft.click(function(){var b=parseInt($("li:first",a.body.yearselector).text(),10);$("li",a.body.yearselector).each(function(c,d){var e=b+(c-10);e==a.currentDate.year?$(this).addClass("l-selected"):$(this).removeClass("l-selected"),$(this).html(e)})}),a.body.yearBtnRight.click(function(){var b=parseInt($("li:first",a.body.yearselector).text(),10);$("li",a.body.yearselector).each(function(c,d){var e=b+(c+10);e==a.currentDate.year?$(this).addClass("l-selected"):$(this).removeClass("l-selected"),$(this).html(e)})}),a.buttons.btnYear.click(function(){a.body.yearselector.is(":visible")||$("li",a.body.yearselector).each(function(b,c){var d=a.currentDate.year+(b-4);d==a.currentDate.year?$(this).addClass("l-selected"):$(this).removeClass("l-selected"),$(this).html(d)}),a.body.monthselector.slideUp(),a.body.yearselector.is(":hidden")?(a.body.yearselector.slideDown(),a.body.yearBtnLeft.show(),a.body.yearBtnRight.show()):(a.body.yearselector.slideUp(),a.body.yearBtnLeft.hide(),a.body.yearBtnRight.hide())}),a.body.yearselector.hover(function(){},function(){a.body.yearBtnLeft.hide(),a.body.yearBtnRight.hide(),$(this).slideUp()}),$("li",a.body.yearselector).click(function(){a.currentDate.year=parseInt($(this).html()),a.body.yearselector.slideUp(),a.bulidContent()}),a.buttons.btnMonth.click(function(){$("li",a.body.monthselector).each(function(b,c){a.currentDate.month==b+1?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.body.yearselector.slideUp(),a.body.monthselector.is(":hidden")?a.body.monthselector.slideDown():a.body.monthselector.slideUp()}),a.body.monthselector.hover(function(){},function(){$(this).slideUp("fast")}),$("li",a.body.monthselector).click(function(){var b=$("li",a.body.monthselector).index(this);a.currentDate.month=b+1,a.body.monthselector.slideUp(),a.bulidContent()}),a.toolbar.time.hour.click(function(){$("li",a.body.hourselector).each(function(b,c){a.currentDate.hour==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.body.minuteselector.slideUp(),a.toolbar.time.minute.removeClass("btn-selected"),a.body.hourselector.is(":hidden")?(a.body.hourselector.slideDown(),a.toolbar.time.hour.addClass("btn-selected")):(a.body.hourselector.slideUp(),a.toolbar.time.hour.removeClass("btn-selected"))}),a.body.hourselector.hover(function(){},function(){$(this).slideUp("fast"),a.toolbar.time.hour.removeClass("btn-selected")}),$("li",a.body.hourselector).click(function(){var b=$("li",a.body.hourselector).index(this);a.currentDate.hour=b,a.body.hourselector.slideUp("fast"),a.toolbar.time.hour.removeClass("btn-selected"),a.bulidContent(),a.showDate()}),a.toolbar.time.minute.click(function(){if($("li",a.body.minuteselector).each(function(b,c){a.currentDate.minute==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.body.hourselector.slideUp(),a.toolbar.time.hour.removeClass("btn-selected"),a.body.minuteselector.is(":hidden")){a.body.minuteselector.slideDown(),a.toolbar.time.minute.addClass("btn-selected");var b=$("li",this).index($("li.l-selected",this));if(b>29){var c=$("li.l-selected",this).offset().top-$(this).offset().top;$(this).animate({scrollTop:c})}}else a.body.minuteselector.slideUp(),a.toolbar.time.minute.removeClass("btn-selected")}),$("ul li",a.quickSelect).click(function(){var b=parseInt($(this).find("span").eq(0).html(),10),c=parseInt($(this).find("span").eq(1).html(),10);a.currentDate.hour=b,a.currentDate.minute=c,a.dateeditor.slideToggle(),a.bulidContent(),a.showDate()}),a.body.minuteselector.hover(function(){},function(){$(this).slideUp("fast"),a.toolbar.time.minute.removeClass("btn-selected")}),$("li",a.body.minuteselector).click(function(){var b=$("li",a.body.minuteselector).index(this);a.currentDate.minute=b,a.body.minuteselector.slideUp("fast"),a.toolbar.time.minute.removeClass("btn-selected"),a.bulidContent(),a.showDate()}),a.buttons.btnPrevMonth.click(function(){0==--a.currentDate.month&&(a.currentDate.month=12,a.currentDate.year--),a.bulidContent()}),a.buttons.btnNextMonth.click(function(){13==++a.currentDate.month&&(a.currentDate.month=1,a.currentDate.year++),a.bulidContent()}),a.buttons.btnPrevYear.click(function(){a.currentDate.year--,a.bulidContent()}),a.buttons.btnNextYear.click(function(){a.currentDate.year++,a.bulidContent()}),a.buttons.btnToday.click(function(){a.currentDate={year:a.now.year,month:a.now.month,day:a.now.day,date:a.now.date},a.selectedDate={year:a.now.year,month:a.now.month,day:a.now.day,date:a.now.date},a.showDate(),a.dateeditor.slideToggle("fast")}),a.toolbar.hourspinnerup.click(function(){var b=parseInt(a.toolbar.time.hour.html(),10),c=b+1;c>23&&(c=23),a.currentDate.hour=c,$("li",a.body.hourselector).each(function(b,c){a.currentDate.hour==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.bulidContent(),a.showDate()}),a.toolbar.hourspinnerdown.click(function(){var b=parseInt(a.toolbar.time.hour.html(),10),c=b-1;0>c&&(c=0),a.currentDate.hour=c,$("li",a.body.hourselector).each(function(b,c){a.currentDate.hour==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.bulidContent(),a.showDate()}),a.toolbar.minutespinnerup.click(function(){var b=parseInt(a.toolbar.time.minute.html(),10),c=b+1;c>59&&(c=59),a.currentDate.minute=c,$("li",a.body.minuteselector).each(function(b,c){a.currentDate.minute==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.bulidContent(),a.showDate()}),a.toolbar.minutespinnerdown.click(function(){var b=parseInt(a.toolbar.time.minute.html(),10),c=b-1;0>c&&(c=0),a.currentDate.minute=c,$("li",a.body.minuteselector).each(function(b,c){a.currentDate.minute==b?$(this).addClass("l-selected"):$(this).removeClass("l-selected")}),a.bulidContent(),a.showDate()}),a.inputText.change(function(){a.onTextChange()}).blur(function(){a.text.removeClass("l-text-focus")}).focus(function(){a.text.addClass("l-text-focus")}),a.text.hover(function(){a.text.addClass("l-text-over")},function(){a.text.removeClass("l-text-over")}),b.label&&(a.labelwrapper=a.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),a.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+b.label+":&nbsp</div>"),a.textwrapper.css("float","left"),b.labelWidth?$(".l-text-label",a.labelwrapper).outerWidth(b.labelWidth):b.labelWidth=$(".l-text-label",a.labelwrapper).outerWidth(),$(".l-text-label",a.labelwrapper).width(b.labelWidth),$(".l-text-label",a.labelwrapper).height(a.text.height()),a.labelwrapper.append('<br style="clear:both;" />'),b.labelAlign&&$(".l-text-label",a.labelwrapper).css("text-align",b.labelAlign),a.textwrapper.css({display:"inline"}),a.labelwrapper.width(a.text.outerWidth()+b.labelWidth+2)),a.set(b),$(document).bind("click.dateeditor",function(b){a.dateeditor.is(":visible")&&0==$(b.target||b.srcElement).closest(".l-box-dateeditor, .l-text-date").length&&a.toggleDateEditor(!0)}),b.inputReadonly&&a.inputText.attr("readonly","readonly")}},destroy:function(){this.textwrapper&&this.textwrapper.remove(),this.dateeditor&&this.dateeditor.remove(),this.options=null,$.zoeui.remove(this)},bulidContent:function(){var a=this,b=this.options,c=new Date(a.currentDate.year,a.currentDate.month-1,1).getDay(),d=a.currentDate.month,e=a.currentDate.year;13==++d&&(d=1,e++);var f=new Date(e,d-1,0).getDate(),g=new Date(a.currentDate.year,a.currentDate.month-1,0).getDate();a.buttons.btnMonth.html(b.monthMessage[a.currentDate.month-1]),a.buttons.btnYear.html(a.currentDate.year),a.toolbar.time.hour.html(a.currentDate.hour),a.toolbar.time.minute.html(a.currentDate.minute),1==a.toolbar.time.hour.html().length&&a.toolbar.time.hour.html("0"+a.toolbar.time.hour.html()),1==a.toolbar.time.minute.html().length&&a.toolbar.time.minute.html("0"+a.toolbar.time.minute.html()),$("td",this.body.tbody).each(function(){this.className=""}),$("tr",this.body.tbody).each(function(b,d){$("td",d).each(function(d,e){var h=7*b+(d-c),i=h+1;a.selectedDate&&a.currentDate.year==a.selectedDate.year&&a.currentDate.month==a.selectedDate.month&&h+1==a.selectedDate.date?((0==d||6==d)&&$(e).addClass("l-box-dateeditor-holiday"),$(e).addClass("l-box-dateeditor-selected"),$(e).siblings().removeClass("l-box-dateeditor-selected")):a.currentDate.year==a.now.year&&a.currentDate.month==a.now.month&&h+1==a.now.date?((0==d||6==d)&&$(e).addClass("l-box-dateeditor-holiday"),$(e).addClass("l-box-dateeditor-today")):0>h?(i=g+i,$(e).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):h>f-1?(i-=f,$(e).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):0==d||6==d?$(e).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected"):e.className="",$(e).html(i)})})},updateSelectBoxPosition:function(){var a=this,b=this.options;if(b.absolute){var c=$(document).height();Number(a.text.offset().top+1+a.text.outerHeight()+a.dateeditor.height())>c&&c>Number(a.dateeditor.height()+1)?a.dateeditor.css({left:a.text.offset().left,top:a.text.offset().top-1-a.dateeditor.height()}):a.dateeditor.css({left:a.text.offset().left,top:a.text.offset().top+1+a.text.outerHeight()})}else a.text.offset().top+4>a.dateeditor.height()&&a.text.offset().top+a.dateeditor.height()+textHeight+4-$(window).scrollTop()>$(window).height()?(a.dateeditor.css("marginTop",-1*(a.dateeditor.height()+textHeight+5)),a.showOnTop=!0):a.showOnTop=!1},toggleDateEditor:function(a){for(var b=this,c=(this.options,$.zoeui.find($.zoeui.controls.ComboBox)),d=0,e=c.length;e>d;d++){var f=c[d];f.id!=b.id&&null!=f.selectBox.is(":visible")&&f.selectBox.is(":visible")&&f.selectBox.hide()}c=$.zoeui.find($.zoeui.controls.DateEditor);for(var d=0,e=c.length;e>d;d++){var f=c[d];f.id!=b.id&&null!=f.dateeditor.is(":visible")&&f.dateeditor.is(":visible")&&f.dateeditor.hide()}b.text.height();b.editorToggling=!0,a?b.dateeditor.hide("fast",function(){b.editorToggling=!1}):(b.updateSelectBoxPosition(),b.dateeditor.slideDown("fast",function(){b.editorToggling=!1}))},showDate:function(){var a=this,b=this.options;if(this.currentDate){this.currentDate.hour=parseInt(a.toolbar.time.hour.html(),10),this.currentDate.minute=parseInt(a.toolbar.time.minute.html(),10);var c=new Date,d=c.getSeconds(),e=this.currentDate.year+"/"+this.currentDate.month+"/"+this.currentDate.date+" "+this.currentDate.hour+":"+this.currentDate.minute+":"+d,f=new Date(e);e=a.getFormatDate(f),this.inputText.val(e),this.onTextChange(),$.isFunction(b.onSetValue)&&b.onSetValue(e)}},isDateTime:function(a){var b=(this.options,a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/));if(null==b)return!1;var c=new Date(b[1],b[3]-1,b[4]);return"NaN"==c?!1:c.getFullYear()==b[1]&&c.getMonth()+1==b[3]&&c.getDate()==b[4]},isLongDateTime:function(a){var b=(this.options,/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/),c=a.match(b);if(null==c)return!1;var d=new Date(c[1],c[3]-1,c[4],c[5],c[6]);return"NaN"==d?!1:d.getFullYear()==c[1]&&d.getMonth()+1==c[3]&&d.getDate()==c[4]&&d.getHours()==c[5]&&d.getMinutes()==c[6]},getFormatDate:function(a){var b=this.options;if("NaN"==a)return null;var c=b.format,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(c)&&(c=c.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var e in d)new RegExp("("+e+")").test(c)&&(c=c.replace(RegExp.$1,1==RegExp.$1.length?d[e]:("00"+d[e]).substr((""+d[e]).length)));return c},clear:function(){this.set("value",""),this.usedDate=null},_setCancelable:function(a){var b=this,c=this.options;!a&&b.unselect&&(b.unselect.remove(),b.unselect=null),(a||b.unselect)&&(b.unselect=$('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),b.text.hover(function(){b.unselect.show()},function(){b.unselect.hide()}),!c.disabled&&c.cancelable&&b.text.append(b.unselect),b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){c.readonly||b.clear()}))},_rever:function(){var a=this;this.options;a.usedDate?a.inputText.val(a.getFormatDate(a.usedDate)):a.inputText.val("")},_getMatch:function(a){for(var b=[-1,-1,-1,-1,-1,-1],c=0,d="^",e=a||this.options.format;;){var f=e.match(/^yyyy|MM|dd|mm|hh|HH|ss|-|\/|:|\s/);if(!f)return null;var g=f[0].charAt(0),h=f[0].length,i="yMdhms".indexOf(g);if(-1!=i)b[i]=c+1,d+="(\\d{1,"+h+"})";else{var j=" "==g?"\\s":g;d+="("+j+")"}if(c++,h==e.length){d+="$";break}e=e.substring(h)}return{reg:new RegExp(d),position:b}},_bulidDate:function(a){var b=this.options,c=this._getMatch();if(!c)return null;var d=a.match(c.reg);if(!d)return null;var e={y:-1==c.position[0]?1900:d[c.position[0]],M:-1==c.position[1]?0:parseInt(d[c.position[1]],10)-1,d:-1==c.position[2]?1:parseInt(d[c.position[2]],10),h:-1==c.position[3]?0:parseInt(d[c.position[3]],10),m:-1==c.position[4]?0:parseInt(d[c.position[4]],10),s:-1==c.position[5]?0:parseInt(d[c.position[5]],10)};if(e.M<0||e.M>11||e.d<0||e.d>31)return null;var f=new Date(e.y,e.M,e.d);if(b.showTime){if(e.m<0||e.m>59||e.h<0||e.h>23||e.s<0||e.s>59)return null;f.setHours(e.h),f.setMinutes(e.m),f.setSeconds(e.s)}return f},updateStyle:function(){this.onTextChange()},onTextChange:function(){var a=this,b=(this.options,a.inputText.val());if(!b)return a.selectedDate=null,!0;var c=a._bulidDate(b);if(!c)return void a._rever();a.usedDate=c,a.selectedDate={year:a.usedDate.getFullYear(),month:a.usedDate.getMonth()+1,day:a.usedDate.getDay(),date:a.usedDate.getDate(),hour:a.usedDate.getHours(),minute:a.usedDate.getMinutes()},a.currentDate={year:a.usedDate.getFullYear(),month:a.usedDate.getMonth()+1,day:a.usedDate.getDay(),date:a.usedDate.getDate(),hour:a.usedDate.getHours(),minute:a.usedDate.getMinutes()};var d=a.getFormatDate(c);a.inputText.val(d),a.trigger("changeDate",[d]),$(a.dateeditor).is(":visible")&&a.bulidContent()},_setHeight:function(a){var b=this;a>4&&(b.text.css({height:a}),b.inputText.css({height:a}),b.textwrapper.css({height:a}))},_setWidth:function(a){var b=this;a>20&&(b.text.css({width:a}),b.inputText.css({width:a-20}),b.textwrapper.css({width:a}))},_setValue:function(value){var g=this;value||g.inputText.val(""),"string"==typeof value&&(/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),g.inputText.val(value),g.usedDate=value),"object"==typeof value&&value instanceof Date&&(g.inputText.val(g.getFormatDate(value)),g.onTextChange())},_getValue:function(){return this.usedDate},setEnabled:function(){var a=this.options;this.inputText.removeAttr("readonly"),this.text.removeClass("l-text-disabled"),a.disabled=!1},setDisabled:function(){var a=this.options;this.inputText.attr("readonly","readonly"),this.text.addClass("l-text-disabled"),a.disabled=!0}})}(jQuery),function(a){var b=a.zoeui;a(".l-dialog-btn").live("mouseover",function(){a(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-btn-over")}),a(".l-dialog-tc .l-dialog-close").live("mouseover",function(){a(this).addClass("l-dialog-close-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-close-over")}),a.zoeDialog=function(){return b.run.call(null,"zoeDialog",arguments,{isStatic:!0})},a.zoeui.DialogImagePath="../skins/default/images/win/",a.zoeDefaults.Dialog={cls:null,contentCls:null,id:null,form:null,buttons:null,isDrag:!0,width:280,height:null,content:"",target:null,url:null,load:!1,type:"none",left:null,top:null,modal:!0,data:null,name:null,isResize:!1,allowClose:!0,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:!0,show:!0,title:"消息提示",showMax:!1,showToggle:!1,showMin:!1,slide:a.browser.msie?!1:!0,fixedType:null,showType:null,onLoaded:null,onExtend:null,onExtended:null,onCollapse:null,onCollapseed:null,onContentHeightChange:null,onClose:null,onClosed:null,onHidden:null,isCloseBtn:!1,onStopResize:null},a.zoeDefaults.DialogString={titleMessage:"提示",ok:"确定",yes:"确定",no:"取消",cancel:"取消",waittingMessage:"正在等待中,请稍候..."},a.zoeMethos.Dialog=a.zoeMethos.Dialog||{},b.controls.Dialog=function(a){b.controls.Dialog.base.constructor.call(this,null,a)},b.controls.Dialog.zoeExtend(b.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return a.zoeMethos.Dialog},_render:function(){function c(){var b=0,c=0,f=e.width||d.dialog.width();if("waitting"==e.type)var f=48;1==e.slide&&(e.slide="fast"),null!=e.left?b=e.left:e.left=b=.5*(a(window).width()-f),null!=e.top?c=e.top:e.top=c=.5*(a(window).height()-d.dialog.height())+a(window).scrollTop()-10,0>b&&(e.left=b=0),0>c&&(e.top=c=0),d.dialog.css({left:b,top:c})}var d=this,e=this.options,f="";if(d.set(e,!0),"waitting"==e.type)var g=a('<div class="l-dialog"><div class="l-dialog-content"></div></div>');else var g=a('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"><span class="alert-text"></span></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');
if(a("body").append(g),d.dialog=g,d.element=g[0],d.dialog.body=a(".l-dialog-body:first",d.dialog),d.dialog.header=a(".l-dialog-tc-inner:first",d.dialog),d.dialog.winbtns=a(".l-dialog-winbtns:first",d.dialog.header),d.dialog.buttons=a(".l-dialog-buttons:first",d.dialog),d.dialog.content=a(".l-dialog-content:first",d.dialog),d.set(e,!1),0==e.allowClose&&a(".l-dialog-close",d.dialog).remove(),(e.target||e.url||"none"==e.type)&&(e.type=null,d.dialog.addClass("l-dialog-win")),e.cls&&d.dialog.addClass(e.cls),e.id&&d.dialog.attr("id",e.id),d.mask(),e.isDrag&&d._applyDrag(),e.isResize&&d._applyResize(),e.type?d._setImage():(a(".l-dialog-image",d.dialog).remove(),d.dialog.content.addClass("l-dialog-content-noimage")),e.contentCls&&d.dialog.content.addClass(e.contentCls),e.show||(d.unmask(),d.dialog.hide()),e.target)d.dialog.content.prepend(e.target),a(e.target).show();else if(e.url)if(e.timeParmName&&(e.url+=-1==e.url.indexOf("?")?"?":"&",e.url+=e.timeParmName+"="+(new Date).getTime()),e.load)d.dialog.body.load(e.url,function(){d._saveStatus(),d.trigger("loaded")});else{d.jiframe=a("<iframe frameborder='0'></iframe>");var h=e.name?e.name:"zoewindow"+(new Date).getTime();d.jiframe.attr("name",h),d.jiframe.attr("id",h),d.dialog.content.prepend(d.jiframe),d.dialog.content.addClass("l-dialog-content-nopadding l-dialog-content-frame"),setTimeout(function(){0==d.dialog.body.find(".l-dialog-loading:first").length&&d.dialog.body.append("<div class='l-dialog-loading' style='display:block;'></div>");var b=a(".l-dialog-loading:first",d.dialog.body);d.jiframe[0].dialog=d,d.jiframe.attr("src",e.url).bind("load.dialog",function(){b.hide(),d.trigger("loaded")}),d.frame=window.frames[d.jiframe.attr("name")]},0),f="jquery_zoeui_"+(new Date).getTime(),d.tmpInput=a("<input></input>"),d.tmpInput.attr("id",f),d.dialog.content.prepend(d.tmpInput)}e.opener&&(d.dialog.opener=e.opener),e.buttons?a(e.buttons).each(function(b,c){var e=a('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');a(".l-dialog-btn-inner",e).html(c.text),"取消"==c.text&&a(".l-dialog-btn-inner",e).addClass("l-dialog-tip-cancel"),a(".l-dialog-buttons-inner",d.dialog.buttons).prepend(e),c.width&&e.width(c.width),c.onclick&&e.click(function(){c.onclick(c,d,b)}),c.cls&&e.addClass(c.cls)}):d.dialog.buttons.remove(),a(".l-dialog-buttons-inner",d.dialog.buttons).append("<div class='l-clear'></div>"),a(".l-dialog-title",d.dialog).bind("selectstart",function(){return!1}),d.dialog.click(function(){b.win.setFront(d)}),a(".l-dialog-tc .l-dialog-close",d.dialog).click(function(){e.isHidden?d.hide():d.close()}),e.isCloseBtn&&a(".l-dialog-tc .l-dialog-close",d.dialog).hide(),e.fixedType||("auto"==e.width?setTimeout(function(){c()},100):c()),d.show(),a("body").bind("keydown.dialog",function(a){var b=a.which;13==b?d.enter():27==b&&d.esc()}),d._updateBtnsWidth(),d._saveStatus(),d._onReisze(),""!=f&&(a("#"+f).focus(),a("#"+f).remove())},_borderX:12,_borderY:32,doMax:function(c){var d=this,e=this.options,f=a(window).width(),g=a(window).height(),h=0,i=0;b.win.taskbar&&(g-=b.win.taskbar.outerHeight(),b.win.top&&(i+=b.win.taskbar.outerHeight())),c?(d.dialog.body.animate({width:f-d._borderX},e.slide),d.dialog.animate({left:h,top:i},e.slide),d.dialog.content.animate({height:g-d._borderY-d.dialog.buttons.outerHeight()},e.slide,function(){d._onReisze()})):(d.set({width:f,height:g,left:h,top:i}),d._onReisze())},max:function(){var b=this,c=this.options;b.winmax&&(b.winmax.addClass("l-dialog-recover"),b.doMax(c.slide),b.wintoggle&&(b.wintoggle.hasClass("l-dialog-extend")?b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled"):b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")),b.resizable&&b.resizable.set({disabled:!0}),b.draggable&&b.draggable.set({disabled:!0}),b.maximum=!0,a(window).bind("resize.dialogmax",function(){b.doMax(!1)}))},recover:function(){var b=this,c=this.options;b.winmax&&(b.winmax.removeClass("l-dialog-recover"),c.slide?(b.dialog.body.animate({width:b._width-b._borderX},c.slide),b.dialog.animate({left:b._left,top:b._top},c.slide),b.dialog.content.animate({height:b._height-b._borderY-b.dialog.buttons.outerHeight()},c.slide,function(){b._onReisze()})):(b.set({width:b._width,height:b._height,left:b._left,top:b._top}),b._onReisze()),b.wintoggle&&b.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled"),a(window).unbind("resize.dialogmax")),this.resizable&&this.resizable.set({disabled:!1}),b.draggable&&b.draggable.set({disabled:!1}),b.maximum=!1},min:function(){var a=this,c=this.options,d=b.win.getTask(this);c.slide?(a.dialog.body.animate({width:1},c.slide),d.y=d.offset().top+d.height(),d.x=d.offset().left+d.width()/2,a.dialog.animate({left:d.x,top:d.y},c.slide,function(){a.dialog.hide()})):a.dialog.hide(),a.unmask(),a.minimize=!0,a.actived=!1},active:function(){var c=this,d=this.options;if(c.minimize){var e=c._width,f=c._height,g=c._left,h=c._top;c.maximum&&(e=a(window).width(),f=a(window).height(),g=h=0,b.win.taskbar&&(f-=b.win.taskbar.outerHeight(),b.win.top&&(h+=b.win.taskbar.outerHeight()))),d.slide?(c.dialog.body.animate({width:e-c._borderX},d.slide),c.dialog.animate({left:g,top:h},d.slide)):c.set({width:e,height:f,left:g,top:h})}c.actived=!0,c.minimize=!1,b.win.setFront(c),c.show()},toggle:function(){var a=this;this.options;a.wintoggle&&(a.wintoggle.hasClass("l-dialog-extend")?a.extend():a.collapse())},collapse:function(){var a=this,b=this.options;a.wintoggle&&(b.slide?a.dialog.content.animate({height:1},b.slide):a.dialog.content.height(1),this.resizable&&this.resizable.set({disabled:!0}))},extend:function(){var a=this,b=this.options;if(a.wintoggle){var c=a._height-a._borderY-a.dialog.buttons.outerHeight();b.slide?a.dialog.content.animate({height:c},b.slide):a.dialog.content.height(c),this.resizable&&this.resizable.set({disabled:!1})}},_updateBtnsWidth:function(){var b=this,c=a(">div",b.dialog.winbtns).length;b.dialog.winbtns.width(22*c)},_setLeft:function(a){this.dialog&&null!=a&&this.dialog.css({left:a})},_setTop:function(a){this.dialog&&null!=a&&this.dialog.css({top:a})},_setWidth:function(a){this.dialog&&a>=this._borderX&&this.dialog.body.width(a-this._borderX)},_setHeight:function(a){var b=this;this.options;if(this.dialog)if("auto"==a)b.dialog.content.height("auto");else if(a>=this._borderY){var c=a-this._borderY-b.dialog.buttons.outerHeight();if(0==b.trigger("ContentHeightChange",[c]))return;b.dialog.content.height(c),b.trigger("ContentHeightChanged",[c])}},_setShowMax:function(b){var c=this;this.options;b?c.winmax||(c.winmax=a('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(c.dialog.winbtns).hover(function(){a(this).hasClass("l-dialog-recover")?a(this).addClass("l-dialog-recover-over"):a(this).addClass("l-dialog-max-over")},function(){a(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){a(this).hasClass("l-dialog-recover")?c.recover():c.max()})):c.winmax&&(c.winmax.remove(),c.winmax=null),c._updateBtnsWidth()},_setShowMin:function(c){var d=this;this.options;c?d.winmin||(d.winmin=a('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(d.dialog.winbtns).hover(function(){a(this).addClass("l-dialog-min-over")},function(){a(this).removeClass("l-dialog-min-over")}).click(function(){d.min()}),b.win.addTask(d)):d.winmin&&(d.winmin.remove(),d.winmin=null),d._updateBtnsWidth()},_setShowToggle:function(b){var c=this;this.options;b?c.wintoggle||(c.wintoggle=a('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(c.dialog.winbtns).hover(function(){a(this).hasClass("l-dialog-toggle-disabled")||(a(this).hasClass("l-dialog-extend")?a(this).addClass("l-dialog-extend-over"):a(this).addClass("l-dialog-collapse-over"))},function(){a(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(!a(this).hasClass("l-dialog-toggle-disabled"))if(c.wintoggle.hasClass("l-dialog-extend")){if(0==c.trigger("extend"))return;c.wintoggle.removeClass("l-dialog-extend"),c.extend(),c.trigger("extended")}else{if(0==c.trigger("collapse"))return;c.wintoggle.addClass("l-dialog-extend"),c.collapse(),c.trigger("collapseed")}})):c.wintoggle&&(c.wintoggle.remove(),c.wintoggle=null)},enter:function(){var a,b=this,c=this.options;void 0!=c.closeWhenEnter?a=c.closeWhenEnter:("warn"==c.type||"error"==c.type||"success"==c.type||"question"==c.type)&&(a=!0),a&&b.close()},esc:function(){},_removeDialog:function(){function b(){var b=a("iframe",c.dialog);if(b.length){var d=b[0];if(d.src="about:blank",d.contentWindow&&d.contentWindow.document)try{d.contentWindow.document.write("")}catch(e){}a.browser.msie&&CollectGarbage(),b.remove()}c.dialog.remove()}var c=this,d=this.options;d.showType&&d.fixedType?c.dialog.animate({bottom:-1*d.height},function(){b()}):b()},close:function(){var a=this;this.options;0!=a.trigger("Close")&&(a.doClose(),0==a.trigger("Closed"))},doClose:function(){var c=this,d=this.options;b.win.removeTask(this),a.zoeui.remove(this),c.unmask(),c._removeDialog(),a("body").unbind("keydown.dialog");try{var e=d.form;null!=e&&e.hideTip()}catch(f){return}},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(a){var b=this,c=this.options;c.url=a,c.load?b.dialog.body.html("").load(c.url,function(){b.trigger("loaded")}):b.jiframe&&b.jiframe.attr("src",c.url)},_setContent:function(a){this.dialog.content.html(a)},_setTitle:function(b){var c=this;this.options;b&&a(".l-dialog-title",c.dialog).html(b)},_hideDialog:function(){var a=this,b=this.options;b.showType&&b.fixedType?a.dialog.animate({bottom:-1*b.height},function(){a.dialog.hide()}):a.dialog.hide()},hidden:function(){var c=this,d=this.options,e=d.form;null!=e&&e.hideTip(),b.win.removeTask(c),c.dialog.hide(),c.unmask(),a.isFunction(d.onHidden)&&d.onHidden()},show:function(){var b=this,c=this.options;b.mask(),c.fixedType?c.showType?(b.dialog.css({bottom:-1*c.height}).addClass("l-dialog-fixed"),b.dialog.show().animate({bottom:0})):b.dialog.show().css({bottom:0}):b.dialog.show(),a.zoeui.win.setFront.zoeDefer(a.zoeui.win,100,[b])},setButtons:function(b){var c=this,d=this.options;d.buttons=b,a(".l-dialog-buttons-inner").replaceWith('<div class="l-dialog-buttons-inner"></div>'),a(d.buttons).each(function(b,d){var e=a('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');a(".l-dialog-btn-inner",e).html(d.text),a(".l-dialog-buttons-inner",c.dialog.buttons).prepend(e),d.width&&e.width(d.width),d.onclick&&e.click(function(){d.onclick(d,c,b)}),d.cls&&e.addClass(d.cls)}),a(".l-dialog-buttons-inner",c.dialog.buttons).append("<div class='l-clear'></div>")},setUrl:function(a){this._setUrl(a)},_saveStatus:function(){var a=this;a._width=a.dialog.body.width(),a._height=a.dialog.body.height();var b=0,c=0;isNaN(parseInt(a.dialog.css("top")))||(b=parseInt(a.dialog.css("top"))),isNaN(parseInt(a.dialog.css("left")))||(c=parseInt(a.dialog.css("left"))),a._top=b,a._left=c},_applyDrag:function(){var c=this,d=this.options;a.fn.zoeDrag&&(c.draggable=c.dialog.zoeDrag({handler:".l-dialog-title",animate:!1,onStartDrag:function(){b.win.setFront(c);var d=a("<div class='l-dragging-mask' style='display:block'></div>").height(c.dialog.height());c.dialog.append(d),c.dialog.content.addClass("l-dialog-content-dragging")},onDrag:function(a,b){var c=b.pageY||b.screenY;return 0>c?!1:void 0},onStopDrag:function(){if(c.dialog.find("div.l-dragging-mask:first").remove(),c.dialog.content.removeClass("l-dialog-content-dragging"),d.target){var e=b.find(a.zoeui.controls.DateEditor),f=b.find(a.zoeui.controls.ComboBox);a(a.merge(e,f)).each(function(){this.updateSelectBoxPosition&&this.updateSelectBoxPosition()})}c._saveStatus()}}))},_onReisze:function(){var b=this,c=this.options;if(c.target){var d=a(c.target).zoe();if(d||(d=a(c.target).find(":first").zoe()),!d)return;var e=b.dialog.content.height(),f=b.dialog.content.width();d.trigger("resize",[{width:f,height:e}])}},_applyResize:function(){var b=this;this.options;a.fn.zoeResizable&&(b.resizable=b.dialog.zoeResizable({onStopResize:function(a,c){var d=0,e=0;return isNaN(parseInt(b.dialog.css("top")))||(d=parseInt(b.dialog.css("top"))),isNaN(parseInt(b.dialog.css("left")))||(e=parseInt(b.dialog.css("left"))),a.diffLeft&&b.set({left:e+a.diffLeft}),a.diffTop&&b.set({top:d+a.diffTop}),a.newWidth&&(b.set({width:a.newWidth}),b.dialog.body.css({width:a.newWidth-b._borderX})),a.newHeight&&b.set({height:a.newHeight}),b._onReisze(),b._saveStatus(),b.trigger("stopResize"),!1},animate:!1}))},_setImage:function(){var b=this,c=this.options;c.type&&(a(".l-dialog-body",b.dialog).addClass("l-dialog-body-tips"),"success"==c.type||"donne"==c.type||"ok"==c.type?a(".l-dialog-content",b.dialog).addClass("l-dialog-image-donne").show():"error"==c.type?a(".l-dialog-content",b.dialog).addClass("l-dialog-image-error").show():"warn"==c.type?a(".l-dialog-content",b.dialog).addClass("l-dialog-image-warn").show():"question"==c.type&&a(".l-dialog-content",b.dialog).addClass("l-dialog-image-question").show())}}),b.controls.Dialog.prototype.hide=b.controls.Dialog.prototype.hidden,a.fn.zoeDialog=function(){return zoe.get(a(this).attr("zoeuiid"))},a.zoeDialog.open=function(b){if(!b.popupType){var c,d=a.zoeui,e=d.find("Dialog"),f=!1;if(b.target){c=b.target.selector;for(var g in e)if(e[g].options.target&&c==e[g].options.target.selector){f=!0,e[g].show();break}}else for(var g in e)if(e[g].options.content&&b.content&&e[g].options.content==b.content){f=!0,e[g].show();break}}return f?void 0:a.zoeDialog(b)},a.zoeDialog.close=function(){var a=b.find(b.controls.Dialog.prototype.__getType());for(var c in a){var d=a[c];d.destroy.zoeDefer(d,5)}b.win.unmask()},a.zoeDialog.show=function(c){var d=b.find(b.controls.Dialog.prototype.__getType());if(d.length)for(var e in d)return void d[e].show();return a.zoeDialog(c)},a.zoeDialog.hide=function(){var a=b.find(b.controls.Dialog.prototype.__getType());for(var c in a){var d=a[c];d.hide()}},a.zoeDialog.tip=function(b){return b=a.extend({showType:"slide",width:240,modal:!1,height:100},b||{}),a.extend(b,{fixedType:"se",type:"none",isDrag:!1,isResize:!1,showMax:!1,showToggle:!1,showMin:!1}),a.zoeDialog.open(b)},a.zoeDialog.alert=function(b,c,d,e,f){b=b||"","function"==typeof c?(e=c,d=null):"function"==typeof d&&(e=d);var g=function(a,b,c){b.close(),e&&e(a,b,c)};return p={content:b,buttons:[{text:a.zoeDefaults.DialogString.ok,onclick:g}]},"string"==typeof c&&""!=c&&(p.title=c),"string"==typeof d&&""!=d&&(p.type=d),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1},f||{}),a.zoeDialog(p)},a.zoeDialog.confirm=function(b,c,d){"function"==typeof c&&(d=c,type=null);var e=function(a,b){b.close(),d&&d("ok"==a.type)};return p={type:"question",content:b,buttons:[{text:a.zoeDefaults.DialogString.yes,onclick:e,type:"ok"},{text:a.zoeDefaults.DialogString.no,onclick:e,type:"no"}]},"string"==typeof c&&""!=c&&(p.title=c),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),a.zoeDialog(p)},a.zoeDialog.warning=function(b,c,d,e){"function"==typeof c&&(d=c,type=null);var f=function(a,b){b.close(),d&&d(a.type)};return p={type:"question",content:b,buttons:[{text:a.zoeDefaults.DialogString.yes,onclick:f,type:"yes"},{text:a.zoeDefaults.DialogString.no,onclick:f,type:"no"},{text:a.zoeDefaults.DialogString.cancel,onclick:f,type:"cancel"}]},"string"==typeof c&&""!=c&&(p.title=c),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1},e||{}),a.zoeDialog(p)},a.zoeDialog.waitting=function(b,c){return b=b||a.zoeDefaults.Dialog.waittingMessage,c?a.zoeDialog.open({cls:"l-dialog-waittingdialog-diy",type:"waitting",content:'<div class="l-dialog-waittingdialog-diy-image"></div>',allowClose:!1}):a.zoeDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:12px">'+b+"</div>",allowClose:!1})},a.zoeDialog.closeWaitting=function(){var a=b.find(b.controls.Dialog);for(var c in a){var d=a[c];(d.dialog.hasClass("l-dialog-waittingdialog")||d.dialog.hasClass("l-dialog-waittingdialog-diy"))&&d.close()}},a.zoeDialog.success=function(b,c,d,e){return a.zoeDialog.alert(b,c,"success",d,e)},a.zoeDialog.error=function(b,c,d,e){return a.zoeDialog.alert(b,c,"error",d,e)},a.zoeDialog.warn=function(b,c,d,e){return a.zoeDialog.alert(b,c,"warn",d,e)},a.zoeDialog.question=function(b,c,d){return a.zoeDialog.alert(b,c,"question",null,d)},a.zoeDialog.prompt=function(b,c,d,e){var f=a('<input type="text" class="l-dialog-inputtext"/>');"function"==typeof d&&(e=d),"function"==typeof c?e=c:"boolean"==typeof c&&(d=c),"boolean"==typeof d&&d&&(f=a('<textarea class="l-dialog-textarea"></textarea>')),("string"==typeof c||"int"==typeof c)&&f.val(c);var g=function(a,b,c){b.close(),e&&e("yes"==a.type,f.val())};return p={title:b,target:f,width:320,buttons:[{text:a.zoeDefaults.DialogString.ok,onclick:g,type:"yes"},{text:a.zoeDefaults.DialogString.cancel,onclick:g,type:"cancel"}]},a.zoeDialog(p)}}(jQuery),function(a){var b=a.zoeui;a.fn.zoeDrag=function(a){return b.run.call(this,"zoeDrag",arguments,{idAttrName:"zoeuidragid",hasElement:!1,propertyToElemnt:"target"})},a.fn.zoeGetDragManager=function(){return b.run.call(this,"zoeGetDragManager",arguments,{idAttrName:"zoeuidragid",hasElement:!1,propertyToElemnt:"target"})},a.zoeDefaults.Drag={onStartDrag:!1,onDrag:!1,onStopDrag:!1,handler:null,proxy:!0,revert:!1,animate:!0,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:!1,proxyX:null,proxyY:null},b.controls.Drag=function(a){b.controls.Drag.base.constructor.call(this,null,a)},b.controls.Drag.zoeExtend(b.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var a=this,b=this.options;this.set(b),a.cursor="move",a.handler.css("cursor",a.cursor),a.handler.bind("mousedown.drag",function(c){b.disabled||2!=c.button&&a._start.call(a,c)}).bind("mousemove.drag",function(){b.disabled||a.handler.css("cursor",a.cursor)})},_rendered:function(){this.options.target.zoeuidragid=this.id},_start:function(c){var d=this,e=this.options;if(!d.reverting&&!e.disabled){if(d.current={target:d.target,left:d.target.offset().left,top:d.target.offset().top,startX:c.pageX||c.screenX,startY:c.pageY||c.clientY},0==d.trigger("startDrag",[d.current,c]))return!1;if(d.cursor="move",d._createProxy(e.proxy,c),e.proxy&&!d.proxy)return!1;(d.proxy||d.handler).css("cursor",d.cursor),a(document).bind("selectstart.drag",function(){return!1}),a(document).bind("mousemove.drag",function(){d._drag.apply(d,arguments)}),b.draggable.dragging=!0,a(document).bind("mouseup.drag",function(){b.draggable.dragging=!1,d._stop.apply(d,arguments)})}},_drag:function(b){var c=this;this.options;if(c.current){var d=b.pageX||b.screenX,e=b.pageY||b.screenY;c.current.diffX=d-c.current.startX,c.current.diffY=e-c.current.startY,(c.proxy||c.handler).css("cursor",c.cursor),c.receive&&c.receive.each(function(f,g){var h=a(g),i=h.offset();d>i.left&&d<i.left+h.width()&&e>i.top&&e<i.top+h.height()?c.receiveEntered[f]?c.trigger("dragOver",[g,c.proxy||c.target,b]):(c.receiveEntered[f]=!0,c.trigger("dragEnter",[g,c.proxy||c.target,b])):c.receiveEntered[f]&&(c.receiveEntered[f]=!1,c.trigger("dragLeave",[g,c.proxy||c.target,b]))}),c.hasBind("drag")?0!=c.trigger("drag",[c.current,b])?c._applyDrag():c.proxy?c._removeProxy():c._stop():c._applyDrag()}},_stop:function(b){var c=this,d=this.options;a(document).unbind("mousemove.drag"),a(document).unbind("mouseup.drag"),a(document).unbind("selectstart.drag"),c.receive&&c.receive.each(function(a,d){c.receiveEntered[a]&&c.trigger("drop",[d,c.proxy||c.target,b])}),c.proxy&&(d.revert?c.hasBind("revert")?0!=c.trigger("revert",[c.current,b])?c._revert(b):c._removeProxy():c._revert(b):(c._applyDrag(c.target),c._removeProxy())),c.cursor="move",c.trigger("stopDrag",[c.current,b]),c.current=null,c.handler.css("cursor",c.cursor)},_revert:function(a){var b=this;b.reverting=!0,b.proxy.animate({left:b.current.left,top:b.current.top},function(){b.reverting=!1,b._removeProxy(),b.trigger("endRevert",[b.current,a]),b.current=null})},_applyDrag:function(b){var c=this,d=this.options;b=b||c.proxy||c.target;var e={},f=!1,g=b==c.target;if(c.current.diffX&&(g||null==d.proxyX?e.left=c.current.left+c.current.diffX:e.left=c.current.startX+d.proxyX+c.current.diffX,f=!0),c.current.diffY&&(g||null==d.proxyY?e.top=c.current.top+c.current.diffY:e.top=c.current.startY+d.proxyY+c.current.diffY,f=!0),!d.isOver){var h=a(window).width()-c.target.context.offsetWidth,i=a(window).height()-c.target.context.offsetHeight;e.top<0&&(e.top=0),e.top>i&&(e.top=i),e.left<0&&(e.left=0),e.left>h&&(e.left=h)}b==c.target&&c.proxy&&d.animate?(c.reverting=!0,b.animate(e,function(){c.reverting=!1})):b.css(e)},_setReceive:function(b){this.receiveEntered={},b&&("string"==typeof b?this.receive=a(b):this.receive=b)},_setHandler:function(b){var c=this,d=this.options;b?c.handler="string"==typeof b?a(b,d.target):b:c.handler=a(d.target)},_setTarget:function(b){this.target=a(b)},_setCursor:function(a){this.cursor=a,(this.proxy||this.handler).css("cursor",a)},_createProxy:function(b,c){if(b){var d=this,e=this.options;"function"==typeof b?d.proxy=b.call(this.options.target,d,c):"clone"==b?(d.proxy=d.target.clone().css("position","absolute"),d.proxy.appendTo("body")):(d.proxy=a("<div class='l-draggable'></div>"),d.proxy.width(d.target.width()).height(d.target.height()),d.proxy.attr("dragid",d.id).appendTo("body")),d.proxy.css({left:null==e.proxyX?d.current.left:d.current.startX+e.proxyX,top:null==e.proxyY?d.current.top:d.current.startY+e.proxyY}).show()}},_removeProxy:function(){var a=this;a.proxy&&(a.proxy.remove(),a.proxy=null)}})}(jQuery),function($){function removeArrItem(a,b){for(var c=a.length-1;c>=0;c--)b(a[c])&&a.splice(c,1)}var l=$.zoeui;$.fn.zoeGrid=function(a){return $.zoeui.run.call(this,"zoeGrid",arguments)},$.fn.zoeGetGridManager=function(){return $.zoeui.run.call(this,"zoeGetGridManager",arguments)},$.zoeDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:!0,url:!1,data:null,usePager:!0,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:!1,switchPageSizeApplyComboBox:!1,allowAdjustColWidth:!0,checkbox:!1,allowHideColumn:!1,enabledEdit:!1,isScroll:!0,dateFormat:"yyyy-MM-dd",inWindow:!0,statusName:"__status",method:"post",async:!0,fixedCellHeight:!0,heightDiff:0,cssClass:null,root:"rows",record:"total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",allowUnSelectRow:!1,alternatingRow:!0,groupsAlterNatingRow:!1,mouseoverRowCssClass:"l-grid-row-over",enabledSort:!0,rowAttrRender:null,groupColumnName:null,groupNewRowName:null,groupNewRowRender:null,groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:!1,where:null,selectRowButtonOnly:!1,whenRClickToSelect:!1,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:!0,detailToEdit:!1,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,isSelected:null,frozen:!0,frozenDetail:!1,frozenCheckbox:!0,detail:null,detailHeight:260,isShowDetailToggle:null,rownumbers:!1,frozenRownumbers:!0,rownumbersColWidth:26,colDraggable:!1,rowDraggable:!1,rowDraggingRender:null,autoCheckChildren:!0,onRowDragDrop:null,rowHeight:28,headerRowHeight:28,toolbar:null,toolbarShowInLeft:!0,headerImg:null,editorTopDiff:0,unSetValidateAttr:!0,autoFilter:!1,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,rowSelectable:!0,onBeforeSelectRow:null,onError:null,onSubmit:null,onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onBeforeCancelEdit:null,onAfterSubmitEdit:null,onRowDragDrop:null,onGroupExtend:null,onGroupCollapse:null,onTreeExpand:null,onTreeCollapse:null,onTreeExpanded:null,onTreeCollapsed:null,onLoadData:null,pageDialog:!0,deleteSelectedRowAfter:null,updateSelectedRowAfter:null,endRowAfter:null,isNull:!1,isNewPage:null,isNullMes:null,isDetailBtn:!1,isDetailOneShow:!0,detailRowClick:!0},$.zoeDefaults.GridString={errorMessage:"发生错误",pageStatMessage:"共 {total} 条",pageTextMessage:"Page",loadingMessage:"加载中...",findTextMessage:"查找",noRecordMessage:"没有符合条件的记录存在",isContinueByDataChanged:"数据已经改变,如果继续将丢失数据,是否继续?",cancelMessage:"取消",saveMessage:"保存",applyMessage:"应用",draggingMessage:"{count}行"},$.zoeDefaults.Grid_columns={id:null,name:null,totalSummary:null,display:null,headerRender:null,isAllowHide:!0,isSort:!1,type:null,columns:null,width:120,minWidth:80,format:null,align:"left",hide:!1,editor:null,render:null,enabledCustom:!1,textField:null,isKey:!1,isColumNull:!1,isDblClickEven:!0,isMust:!1},$.zoeDefaults.Grid_editor={type:null,isContrast:null,toFixed:null,ext:null,onChange:null,onChanged:null},$.zoeMethos.Grid=$.zoeMethos.Grid||{},$.zoeDefaults.Grid.sorters=$.zoeDefaults.Grid.sorters||{},$.zoeDefaults.Grid.formatters=$.zoeDefaults.Grid.formatters||{},$.zoeDefaults.Grid.editors=$.zoeDefaults.Grid.editors||{},$.zoeDefaults.Grid.sorters.date=function(a,b){return b>a?-1:a>b?1:0},$.zoeDefaults.Grid.sorters["int"]=function(a,b){return parseInt(a)<parseInt(b)?-1:parseInt(a)>parseInt(b)?1:0},$.zoeDefaults.Grid.sorters["float"]=function(a,b){return parseFloat(a)<parseFloat(b)?-1:parseFloat(a)>parseFloat(b)?1:0},$.zoeDefaults.Grid.sorters.string=function(a,b){return a?a.localeCompare(b):!1},$.zoeDefaults.Grid.formatters.date=function(value,column){function getFormatDate(a,b){this.options;if(isNaN(a))return null;var c=b,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(c)&&(c=c.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var e in d)new RegExp("("+e+")").test(c)&&(c=c.replace(RegExp.$1,1==RegExp.$1.length?d[e]:("00"+d[e]).substr((""+d[e]).length)));return c}if(!value)return"";if("string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),value instanceof Date){var format=column.format||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}return value.toString()},$.zoeui.controls.Grid=function(a,b){$.zoeui.controls.Grid.base.constructor.call(this,a,b)},$.zoeui.controls.Grid.zoeExtend($.zoeui.core.UIComponent,{__getType:function(){return"Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.zoeMethos.Grid},_init:function(){$.zoeui.controls.Grid.base._init.call(this);var a=this,b=this.options;b.dataType=b.url?"server":"local","local"==b.dataType&&(b.data=b.data||[],b.dataAction="local"),0==b.isScroll&&(b.height="auto"),b.frozen||(b.frozenCheckbox=!1,b.frozenDetail=!1,b.frozenRownumbers=!1),b.detailToEdit&&(b.enabledEdit=!0,b.clickToEdit=!1,b.detail={height:"auto",onShowDetail:function(c,d,e){function f(){$(d).parent().parent().remove(),a.collapseDetail(c)}$(d).addClass("l-grid-detailpanel-edit"),a.beginEdit(c,function(a,c){var e=$("<div class='l-editbox'></div>");return e.width(120).height(b.rowHeight+1),e.appendTo(d),e}),$("<div class='l-clear'></div>").appendTo(d),$("<div class='l-button'>"+b.saveMessage+"</div>").appendTo(d).click(function(){a.endEdit(c),f()}),$("<div class='l-button'>"+b.applyMessage+"</div>").appendTo(d).click(function(){a.submitEdit(c)}),$("<div class='l-button'>"+b.cancelMessage+"</div>").appendTo(d).click(function(){a.cancelEdit(c),f()})}}),b.tree&&(b.tree.childrenName=b.tree.childrenName||"children",b.tree.isParent=b.tree.isParent||function(a){var c=b.tree.childrenName in a,d=a[b.tree.childrenName];return(null==d||0==d.length)&&(c=!1),c},b.tree.isExtend=b.tree.isExtend||function(a){return"isextend"in a&&0==a.isextend?!1:!0});for(var c in zoe.editors){var d=zoe.editors[c];!d||c in b.editors||(b.editors[c]=zoe.getEditor($.extend({type:c,master:a},d)))}},_render:function(){var a=this,b=this.options;a.grid=$(a.element),a.grid.addClass("l-panel");var c=[];if(c.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>"),c.push("                    <div class='l-grid-loading'></div>"),c.push("        <div class='l-panel-topbar' style='display:none'><div class='l-panel-topbarinner'></div></div><div class='l-clear'></div>"),c.push("        <div class='l-panel-bwarp'>"),c.push("            <div class='l-panel-body'>"),c.push("                <div class='l-grid'>"),c.push("                    <div class='l-grid-dragging-line'></div>"),c.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),c.push("                  <div class='l-grid1'>"),c.push("                      <div class='l-grid-header l-grid-header1'>"),c.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),c.push("                      </div>"),c.push("                      <div class='l-grid-body l-grid-body1'>"),c.push("                      </div>"),c.push("                  </div>"),c.push("                  <div class='l-grid2'>"),c.push("                      <div class='l-grid-header l-grid-header2'>"),c.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),c.push("                      </div>"),c.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>"),c.push("                      </div>"),c.push("                      <div class='l-grid-mes' style='display:none'>"),c.push("                      </div>"),c.push("                  </div>"),c.push("                 </div>"),c.push("              </div>"),c.push("         </div>"),c.push("         <div class='l-panel-bar'>"),c.push("            <div class='l-panel-bbar-inner'>"),c.push("                <div class='l-bar-group zoe-select-text-l ' >每页显示</div>"),c.push("                <div class='l-bar-group l-bar-selectpagesize'></div>"),c.push("                <div class='l-bar-group zoe-select-text-r  ' >条，</div>"),c.push("                <div class='l-bar-group l-bar-text'></div>"),c.push("                <div class='l-bar-group'>"),c.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>"),c.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>"),c.push("                </div>"),c.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>"),c.push("                <div class='l-bar-group'>"),c.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>"),c.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>"),c.push("                </div>"),c.push("                <div class='l-clear'></div>"),c.push("            </div>"),c.push("         </div>"),a.grid.html(c.join("")),a.header=$(".l-panel-header:first",a.grid),a.body=$(".l-panel-body:first",a.grid),a.toolbar=$(".l-panel-bar:first",a.grid),a.popup=$(".l-grid-popup:first",a.grid),a.gridloading=$(".l-grid-loading:first",a.grid),a.draggingline=$(".l-grid-dragging-line",a.grid),a.topbar=$(".l-panel-topbarinner:first",a.grid),a.gridview=$(".l-grid:first",a.grid),a.gridview.attr("id",a.id+"grid"),a.gridview1=$(".l-grid1:first",a.gridview),a.gridview2=$(".l-grid2:first",a.gridview),a.gridheader=$(".l-grid-header:first",a.gridview2),a.gridbody=$(".l-grid-body:first",a.gridview2),a.gridmes=$(".l-grid-mes:first",a.gridview2),b.autoFilter){var d={text:"高级查询",gridid:a.id,click:function(){a.showFilter();
},icon:"search2"};b.toolbar&&b.toolbar.items?b.toolbar.items.push(d):b.toolbar={items:[d]}}a.f={},a.f.gridheader=$(".l-grid-header:first",a.gridview1),a.f.gridbody=$(".l-grid-body:first",a.gridview1),a.currentData=null,a.changedCells={},a.editors={},a.editor={editing:!1},a.cacheData={},"auto"==b.height&&a.bind("SysGridHeightChanged",function(){a.enabledFrozen()&&a.gridview.height(Math.max(a.gridview1.height(),a.gridview2.height()))});var e=$.extend({},b);this._bulid(),this._setColumns(b.columns),delete e.columns,delete e.data,delete e.url,a.set(e),b.delayLoad||(b.url?a.set({url:b.url}):b.data&&a.set({data:b.data}))},_setFrozen:function(a){a?this.grid.addClass("l-frozen"):this.grid.removeClass("l-frozen")},_setCssClass:function(a){this.grid.addClass(a)},_setLoadingMessage:function(a){this.gridloading.html(a)},_setToolbar:function(a){var b=this,c=this.options;if(a&&$.fn.zoeToolBar){if(b.topbar.parent().show(),b.toolbarManager=b.topbar.zoeToolBar(a),a.title){var d=$("<div class='l-panel-topbartitle'><span>"+a.title+"</span></div>");a.icon&&(d.append("<img class='l-panel-topbaricon' src='"+a.icon+"'></img>"),d.addClass("l-panel-topbartitle-hasicon")),b.topbar.parent().append(d)}c.toolbarShowInLeft&&b.topbar.addClass("l-panel-topbarinner-left")}else b.topbar.parent().remove()},isHorizontalScrollShowed:function(){var a=this,b=a.gridbody.find(".l-grid-body-inner:first");return b.length?a.gridbody.width()-20<b.width():!1},_setHeight:function(a){var b=this,c=this.options;if(b.unbind("SysGridHeightChanged"),"auto"==a)return void b.bind("SysGridHeightChanged",function(){b.enabledFrozen()&&b.gridview.height(Math.max(b.gridview1.height(),b.gridview2.height()))});if(a=b._calculateGridBodyHeight(a),a>0){b.gridbody.height(a),b.f.gridbody.height(a);var d=c.headerRowHeight*(b._columnMaxLevel-1)+c.headerRowHeight-1;b.gridview.height(a+d)}b._updateHorizontalScrollStatus.zoeDefer(b,10)},_calculateGridBodyHeight:function(a){var b=this,c=this.options;"string"==typeof a&&a.indexOf("%")>0&&(a=c.inWindow?$(window).height()*parseInt(a)*.01:b.grid.parent().height()*parseInt(a)*.01),c.title&&(a-=24),c.usePager&&(a-=32),c.totalRender&&(a-=25),c.toolbar&&(a-=b.topbar.outerHeight());var d=c.headerRowHeight*(b._columnMaxLevel-1)+c.headerRowHeight-1;return a-=d},_updateHorizontalScrollStatus:function(){var a=this;this.options;a.isHorizontalScrollShowed()?a.gridview.addClass("l-grid-hashorizontal"):a.gridview.removeClass("l-grid-hashorizontal")},_updateFrozenWidth:function(){var a=this;this.options;if(a.enabledFrozen()){a.gridview1.width(a.f.gridtablewidth);var b=a.gridview.width()-a.f.gridtablewidth;a.gridview2.css({left:a.f.gridtablewidth}),b>0&&a.gridview2.css({width:b})}},_setWidth:function(a){var b=this;this.options;b.enabledFrozen()&&b._onResize()},_setUrl:function(a){this.options.url=a,a?(this.options.dataType="server",this.loadData(!0)):this.options.dataType="local"},removeParm:function(a){var b=this,c=b.get("parms");c||(c={}),c instanceof Array?removeArrItem(c,function(b){return b.name==a}):delete c[a],b.set("parms",c)},setParm:function(a,b){var c=this,d=c.get("parms");d||(d={}),d instanceof Array?(removeArrItem(d,function(b){return b.name==a}),d.push({name:a,value:b})):d[a]=b,c.set("parms",d)},_setData:function(a){this.loadData(this.options.data)},loadData:function(a){var b=this,c=this.options;b.loading=!0,b.trigger("loadData");var d=null,e=!0;"function"==typeof a?(d=a,b.lastData?b.data=b.lastData:(b.data=b.currentData,b.data||(b.data={}),b.data[c.root]||(b.data[c.root]=[]),b.lastData=b.data),e=!1):"boolean"==typeof a?e=a:"object"==typeof a&&a&&(e=!1,c.dataType="local",c.data=a),c.newPage||(c.newPage=1),c.isNewPage&&(c.newPage=c.isNewPage,c.isNewPage=null),"server"==c.dataAction&&(c.sortOrder||(c.sortOrder="asc"));var f=[];if(c.parms){var g=$.isFunction(c.parms)?c.parms():c.parms;if(g.length){$(g).each(function(){f.push({name:this.name,value:this.value})});for(var h=g.length-1;h>=0;h--)g[h].temp&&g.splice(h,1)}else if("object"==typeof g)for(var i in g)f.push({name:i,value:g[i]})}"server"==c.dataAction&&(c.usePager&&(f.push({name:c.pageParmName,value:c.newPage}),f.push({name:c.pagesizeParmName,value:c.pageSize})),c.sortName&&(f.push({name:c.sortnameParmName,value:c.sortName}),f.push({name:c.sortorderParmName,value:c.sortOrder}))),$(".l-bar-btnload span",b.toolbar).addClass("l-disabled"),"local"==c.dataType?(b.filteredData=$.extend(!0,{},c.data||b.currentData),d&&(b.filteredData[c.root]=b._searchData(b.filteredData[c.root],d)),c.usePager?b.currentData=b._getCurrentPageData(b.filteredData):b.currentData=b.filteredData,b._convertTreeData(),b._showData()):"local"!=c.dataAction||e?b.loadServerData(f,d):b.data&&b.data[c.root]&&(b.filteredData=b.data,d&&(b.filteredData[c.root]=b._searchData(b.filteredData[c.root],d)),b.currentData=b._getCurrentPageData(b.filteredData),b._convertTreeData(),b._showData()),b.loading=!1},_convertTreeData:function(){var a=this,b=this.options;b.tree&&b.tree.idField&&b.tree.parentIDField&&(a.currentData[b.root]=a.arrayToTree(a.currentData[b.root],b.tree.idField,b.tree.parentIDField),a.currentData[b.record]=a.currentData[b.root].length)},loadServerData:function(a,b){var c=this,d=this.options,e=d.url;$.isFunction(e)&&(e=e());var f={type:d.method,url:e,data:a,async:d.async,dataType:"json",beforeSend:function(){c.hasBind("loading")?c.trigger("loading"):c.toggleLoading(!0)},success:function(a){return a&&a[d.root]&&a[d.root].length?c.gridmes.hide():d.isNullMes&&c.gridmes.text(d.isNullMes).show(),c.trigger("success",[a,c]),a&&a[d.root]&&a[d.root].length?(c.data=a,null!=c.data[d.record]&&(c.cacheData.records=c.data[d.record]),"server"==d.dataAction?(c.currentData=c.data,null==c.currentData[d.record]&&c.cacheData.records&&(c.currentData[d.record]=c.cacheData.records)):(c.filteredData=c.data,b&&(c.filteredData[d.root]=c._searchData(c.filteredData[d.root],b)),d.usePager?c.currentData=c._getCurrentPageData(c.filteredData):c.currentData=c.filteredData),c._convertTreeData(),void c._showData.zoeDefer(c,10,[c.currentData])):(c.currentData=c.data={},c.currentData[d.root]=c.data[d.root]=[],a&&a[d.record]?c.currentData[d.record]=c.data[d.record]=a[d.record]:c.currentData[d.record]=c.data[d.record]=0,c._convertTreeData(),void c._showData())},complete:function(){c.trigger("complete",[c]),c.hasBind("loaded")?c.trigger("loaded",[c]):c.toggleLoading.zoeDefer(c,10,[!1])},error:function(a,b,e){c.currentData=c.data={},c.currentData[d.root]=c.data[d.root]=[],c.currentData[d.record]=c.data[d.record]=0,c.toggleLoading.zoeDefer(c,10,[!1]),$(".l-bar-btnload span",c.toolbar).removeClass("l-disabled"),c.trigger("error",[a,b,e])}};d.contentType&&(f.contentType=d.contentType),$.ajax(f)},toggleLoading:function(a){this.gridloading[a?"show":"hide"]()},_createEditor:function(a,b,c,d,e){var f=a.create.call(this,b,c);return a.setValue&&a.setValue.call(this,f,c.value,c),a.setText&&c.column.textField&&a.setText.call(this,f,c.text,c),a.resize&&a.resize.call(this,f,d,e,c),f},beginEdit:function(a,b){var c=this,d=this.options;if(d.enabledEdit&&!d.clickToEdit){var e=c.getRow(a);if(!e._editing&&0!=c.trigger("beginEdit",{record:e,rowindex:e.__index})){c.editors[e.__id]={},e._editing=!0,c.reRender({rowdata:e}),b=b||function(a,b){var d=c.getCellObj(a,b),e=$(d).html("");return c.setCellEditing(a,b,!0),e};for(var f=0,g=c.columns.length;g>f;f++){var h=c.columns[f];if(h.name&&h.editor&&h.editor.type&&d.editors[h.editor.type]){var i=d.editors[h.editor.type],j={record:e,value:c._getValueByName(e,h.name),column:h,rowindex:e.__index,grid:c},k=b(e,h),l=k.width(),m=k.height(),n=c._createEditor(i,k,j,l,m);c.editors[e.__id][h.__id]={editor:i,input:n,editParm:j,container:k}}}c.trigger("afterBeginEdit",{record:e,rowindex:e.__index})}}},cancelEdit:function(a){var b=this;if(void 0==a)for(var c in b.editors)b.cancelEdit(c);else{var d=b.getRow(a);if(!b.editors[d.__id])return;if(0==b.trigger("beforeCancelEdit",{record:d,rowindex:d.__index}))return;for(var e in b.editors[d.__id]){var f=b.editors[d.__id][e];f.editor.destroy&&f.editor.destroy(f.input,f.editParm)}delete b.editors[d.__id],delete d._editing,b.reRender({rowdata:d})}},addEditRow:function(a,b){this.submitEdit(),a=this.add(a),this.beginEdit(a,b)},submitEdit:function(a){var b=this;this.options;if(void 0==a)for(var c in b.editors)b.submitEdit(c);else{var d=b.getRow(a),e={};if(!b.editors[d.__id])return;for(var f in b.editors[d.__id]){var g=b.editors[d.__id][f],h=g.editParm.column;h.name&&(e[h.name]=g.editor.getValue(g.input,g.editParm)),h.textField&&g.editor.getText&&(e[h.textField]=g.editor.getText(g.input,g.editParm))}if(0==b.trigger("beforeSubmitEdit",{record:d,rowindex:d.__index,newdata:e}))return!1;b.updateRow(d,e),b.trigger("afterSubmitEdit",{record:d,rowindex:d.__index,newdata:e})}},endEdit:function(a){var b=this,c=this.options;if(b.editor.editing){var d=b.editor;b.trigger("sysEndEdit",[b.editor.editParm]),b.trigger("endEdit",[b.editor.editParm]),d.editor.destroy&&d.editor.destroy(d.input,d.editParm),b.editor.container.remove(),b.reRender({rowdata:b.editor.editParm.record,column:b.editor.editParm.column}),b.trigger("afterEdit",[b.editor.editParm]),b.editor={editing:!1}}else if(void 0!=a){var e=b.getRow(a);if(!b.editors[e.__id])return;if(0==b.submitEdit(a))return!1;for(var f in b.editors[e.__id]){var d=b.editors[e.__id][f];d.editor.destroy&&d.editor.destroy(d.input,d.editParm)}delete b.editors[e.__id],delete e._editing,b.trigger("afterEdit",{record:e,rowindex:e.__index})}else for(var g in b.editors)b.endEdit(g);b._fixHeight.zoeDefer(b,10),c.endRowAfter&&c.endRowAfter.zoeDefer(this,30)},setWidth:function(a){return this._setWidth(a)},setHeight:function(a){return this._setHeight(a)},enabledCheckbox:function(){return this.options.checkbox?!0:!1},enabledFrozen:function(){var a=this,b=this.options;if(!b.frozen)return!1;var c=a.columns||[];if(a.enabledDetail()&&b.frozenDetail||a.enabledCheckbox()&&b.frozenCheckbox||b.frozenRownumbers&&b.rownumbers)return!0;for(var d=0,e=c.length;e>d;d++)if(c[d].frozen)return!0;return this._setFrozen(!1),!1},enabledDetailEdit:function(){return this.enabledDetail()&&this.options.detailToEdit?!0:!1},enabledDetail:function(){return this.options.detail&&this.options.detail.onShowDetail?!0:!1},enabledGroup:function(){return this.options.groupColumnName?!0:!1},deleteSelectedRow:function(){if(this.selected){for(var a in this.selected){var b=this.selected[a];b.__id in this.records&&this._deleteData.zoeDefer(this,10,[b])}this.reRender.zoeDefer(this,20),p.deleteSelectedRowAfter&&p.deleteSelectedRowAfter.zoeDefer(this,30)}},removeRange:function(a){var b=this;this.options;$.each(a,function(){b._removeData(this)}),b.reRender()},remove:function(a){var b=this;this.options,b.getRow(a);b._removeData(a),b.reRender()},deleteRange:function(a){var b=this;this.options;$.each(a,function(){b._deleteData(this)}),b.reRender()},deleteRow:function(a){var b=this,c=(this.options,b.getRow(a));c&&(b._deleteData(c),b.reRender(),b.isDataChanged=!0)},_deleteData:function(a){var b=this,c=this.options,d=b.getRow(a);if(d[c.statusName]="delete",c.tree){var e=b.getChildren(d,!0);if(e)for(var f=0,g=e.length;g>f;f++)e[f][c.statusName]="delete"}b.deletedRows=b.deletedRows||[],b.deletedRows.push(d),b._removeSelected(d)},updateCell:function(a,b,c){var d,e,f,g=this,h=this.options;if("string"!=typeof a){if("number"==typeof a)d=g.columns[a],f=g.getRow(c),e=g.getCellObj(f,d);else if("object"==typeof a&&a.__id)d=a,f=g.getRow(c),e=g.getCellObj(f,d);else{e=a;var i=e.id.split("|"),j=i[i.length-1];d=g._columns[j];var k=$(e).parent();f=f||g.getRow(k[0])}null!=b&&d.name&&(g._setValueByName(f,d.name,b),"add"!=f[h.statusName]&&(f[h.statusName]="update"),g.isDataChanged=!0),g.reRender({rowdata:f,column:d})}else for(var l=0,m=g.columns.length;m>l;l++)g.columns[l].name==a&&g.updateCell(l,b,c)},addRows:function(a,b,c,d){var e=this;this.options;$(a).each(function(){e.addRow(this,b,c,d)})},_createRowid:function(){return"r"+(1e3+this.recordNumber)},_isRowId:function(a){return a in this.records},_addNewRecord:function(a,b,c){var d=this,e=this.options;if(d.recordNumber++,a.__id=d._createRowid(),a.__previd=b,b&&-1!=b){var f=d.records[b];if(f.__nextid&&-1!=f.__nextid){var g=d.records[f.__nextid];g&&(g.__previd=a.__id)}f.__nextid=a.__id,a.__index=f.__index+1}else a.__index=0;if(e.tree){if(c&&-1!=c){var h=d.records[c];a.__pid=c,a.__level=h.__level+1}else a.__pid=-1,a.__level=1;a.__hasChildren=a[e.tree.childrenName]?!0:!1}return a[e.statusName]=a[e.statusName]||"nochanged",d.rows[a.__index]=a,d.records[a.__id]=a,a},_getRows:function(a){function b(a){if(a&&a.length)for(var e=0,f=a.length;f>e;e++){var g=a[e];d.push(g),g[c.tree.childrenName]&&b(g[c.tree.childrenName])}}var c=this.options,d=[];return b(a),d},_updateGridData:function(){function a(e,f){if(e&&e.length)for(var g=0,h=e.length;h>g;g++){var i=e[g];b.formatRecord(i),"delete"!=i[c.statusName]&&(b._addNewRecord(i,d,f),d=i.__id,i.__hasChildren&&a(i[c.tree.childrenName],i.__id))}}var b=this,c=this.options;b.recordNumber=0,b.rows=[],b.records={};var d=-1;return a(b.currentData[c.root],-1),b.rows},_moveData:function(a,b,c){var d,e,f=this,g=(this.options,f.getRow(a)),h=f.getRow(b),i=f._getParentChildren(g);d=$.inArray(g,i),i.splice(d,1),i=f._getParentChildren(h),e=$.inArray(h,i),i.splice(e+(c?1:0),0,g)},move:function(a,b,c){this._moveData(a,b,c),this.reRender()},moveRange:function(a,b,c){for(var d in a)this._moveData(a[d],b,c);this.reRender()},up:function(a){var b=this,c=(this.options,b.getRow(a)),d=b._getParentChildren(c),e=$.inArray(c,d);if(-1!=e&&0!=e){var f=b.getSelected();b.move(c,d[e-1],!1),b.select(f)}},down:function(a){var b=this,c=(this.options,b.getRow(a)),d=b._getParentChildren(c),e=$.inArray(c,d);if(-1!=e&&e!=d.length-1){var f=b.getSelected();b.move(c,d[e+1],!0),b.select(f)}},addRow:function(a,b,c,d){var e=this,f=this.options;if(a=a||{},e._addData(a,d,b,c),e.reRender(),a[f.statusName]="add",f.tree){var g=e.getChildren(a,!0);if(g)for(var h=0,i=g.length;i>h;h++)g[h][f.statusName]="add"}return e.isDataChanged=!0,f.total=f.total?f.total+1:1,f.pageCount=Math.ceil(f.total/f.pageSize),e._buildPager(),e.trigger("SysGridHeightChanged"),e.trigger("afterAddRow",[a]),a},updateRow:function(a,b){var c=this,d=this.options,e=c.getRow(a);return c.isDataChanged=!0,$.extend(e,b||{}),"add"!=e[d.statusName]&&(e[d.statusName]="update"),c.reRender.zoeDefer(c,10,[{rowdata:e}]),d.updateSelectedRowAfter&&d.updateSelectedRowAfter.zoeDefer(this,30),e},setCellEditing:function(a,b,c){var d=this,e=(this.options,d.getCellObj(a,b)),f=c?"addClass":"removeClass";if($(e)[f]("l-grid-row-cell-editing"),0!=a.__id){var g=$(d.getRowObj(a.__id)).prev();if(!g.length||g.length<=0||null==g[0].id||""==g[0].id)return;var h=d.getRow(g[0]),i=d.getCellObj(h,b);if(!i)return;$(i)[f]("l-grid-row-cell-editing-topcell")}if(-1!=b.__previd&&null!=b.__previd){var i=$(d.getCellObj(a,b)).prev();$(i)[f]("l-grid-row-cell-editing-leftcell")}},reRender:function(a){var b=this,c=this.options;a=a||{};var d=a.rowdata,e=a.column;if(!(e&&(e.isdetail||e.ischeckbox)||d&&"delete"==d[c.statusName]))if(d&&e){var f=b.getCellObj(d,e);$(f).html(b._getCellHtml(d,e)),e.issystem||b.setCellEditing(d,e,!1)}else if(d)$(b.columns).each(function(){b.reRender({rowdata:d,column:this})});else if(e){for(var g in b.records)b.reRender({rowdata:b.records[g],column:e});for(var h=0;h<b.totalNumber;h++){var i=document.getElementById(b.id+"|total"+h+"|"+e.__id);$("div:first",i).html(b._getTotalCellContent(e,b.groups&&b.groups[h]?b.groups[h]:b.currentData[c.root]))}}else b._showData()},getData:function(a,b){var c,d=this,e=this.options,f=d.editor,g=!1,h=[];f.editing&&(f.editParm.column.name&&(d.rows[f.editParm.rowindex][f.editParm.column.name]=f.input.selectedValue||f.input.value),f.editParm.column.textField&&(d.rows[f.editParm.rowindex][f.editParm.column.textField]=f.input.selectedText)),void 0==b&&(b=!0);for(var i in e.columns)if(e.columns[i].isKey){g=!0,c=e.columns[i].columnname;break}for(var j in d.records){var k=$.extend(!0,{},d.records[j]);if(k[e.statusName]==a||void 0==a)if(e.isNull){var l=0;for(var m in e.columns){var n=e.columns[m].columnname;if(k.hasOwnProperty(n)){l=1;break}}if(g&&(k.hasOwnProperty(c)?(""==k[c]||null==k[c])&&(l=0):l=0),l){for(var o in e.columns)if(e.columns[o].isColumNull&&(!k.hasOwnProperty(e.columns[o].columnname)||""==k[e.columns[o].columnname]||null==k[e.columns[o].columnname])){var p=k.__index+1;return $.zoeDialog.open({title:"消息提示",cls:"error-dialog",content:"第"+p+"行,"+e.columns[o].display+"为空，请输入!",width:360,isHidden:!1,buttons:[{text:"确&nbsp;定",cls:"l-dialog-error-y",onclick:function(a,b){b.close()}}]}),!1}h.push(d.formatRecord(k,b))}}else h.push(d.formatRecord(k,b))}return h},formatRecord:function(a,b){return delete a.__id,delete a.__previd,delete a.__nextid,delete a.__index,this.options.tree&&(delete a.__pid,delete a.__level,delete a.__hasChildren),b&&delete a[this.options.statusName],a},getUpdated:function(){return this.getData("update",!0)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",!0)},getChanges:function(){var a=this,b=(this.options,[]);return this.deletedRows&&$(this.deletedRows).each(function(){var c=$.extend(!0,{},this);b.push(a.formatRecord(c,!1))}),$.merge(b,a.getData("update",!1)),$.merge(b,a.getData("add",!1)),b},getColumn:function(a){var b=this;this.options;if("string"==typeof a)return b._isColumnId(a)?b._columns[a]:b.columns[parseInt(a)];if("number"==typeof a)return b.columns[a];if("object"==typeof a&&1==a.nodeType){var c=a.id.split("|"),d=c[c.length-1];return b._columns[d]}return a},getColumnType:function(a){var b=this;this.options;for(i=0;i<b.columns.length;i++)if(b.columns[i].name==a)return b.columns[i].type?b.columns[i].type:"string";return null},isTotalSummary:function(){for(var a=this,b=(this.options,0);b<a.columns.length;b++)if(a.columns[b].totalSummary)return!0;return!1},getColumns:function(a){var b=this,c=(this.options,[]);for(var d in b._columns){var e=b._columns[d];void 0!=a?e.__level==a&&c.push(e):e.__leaf&&c.push(e)}return c},changeSort:function(a,b){var c=this,d=this.options;if(c.loading)return!0;if("local"==d.dataAction){var e=c.getColumnType(a);if(c.sortedData||(c.sortedData=c.filteredData),!c.sortedData||!c.sortedData[d.root])return;d.sortName==a?c.sortedData[d.root].reverse():c.sortedData[d.root].sort(function(b,d){return c._compareData(b,d,a,e)}),d.usePager?c.currentData=c._getCurrentPageData(c.sortedData):c.currentData=c.sortedData,c._showData()}d.sortName=a,d.sortOrder=b,"server"==d.dataAction&&c.loadData(d.where)},changePage:function(a){var b=this,c=this.options;if(b.loading)return!0;if("local"!=c.dataAction&&b.isDataChanged&&!confirm(c.isContinueByDataChanged))return!1;switch(c.pageCount=parseInt($(".pcontrol span",b.toolbar).html()),a){case"first":if(1==c.page)return;c.newPage=1;break;case"prev":if(1==c.page)return;c.page>1&&(c.newPage=parseInt(c.page)-1);break;case"next":if(c.page>=c.pageCount)return;c.newPage=parseInt(c.page)+1;break;case"last":if(c.page>=c.pageCount)return;c.newPage=c.pageCount;break;case"input":var d=parseInt($(".pcontrol input",b.toolbar).val());isNaN(d)&&(d=1),1>d?d=1:d>c.pageCount&&(d=c.page,c.pageDialog&&($.zoeDialog.waitting("页码超出，请重新输入!"),setTimeout(function(){$.zoeDialog.closeWaitting()},1e3))),$(".pcontrol input",b.toolbar).val(d),c.newPage=d}if(c.newPage==c.page)return!1;if(1==c.newPage?($(".l-bar-btnfirst span",b.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",b.toolbar).addClass("l-disabled")):($(".l-bar-btnfirst span",b.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",b.toolbar).removeClass("l-disabled")),c.newPage==c.pageCount?($(".l-bar-btnlast span",b.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",b.toolbar).addClass("l-disabled")):($(".l-bar-btnlast span",b.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",b.toolbar).removeClass("l-disabled")),b.trigger("changePage",[c.newPage]),"server"==c.dataAction)c.parms instanceof Array?c.parms.push({name:"changepage",value:"1",temp:!0}):(c.parms.name="changepage",c.parms.value="1",c.parms.temp="true"),b.loadData(c.where);else{if(b.currentData=b._getCurrentPageData(b.filteredData),c.tree){var e=c.tree.childrenName;$(b.filteredData[c.root]).each(function(a,b){b[e]&&(b[e]=[])}),b._convertTreeData()}b._showData()}},getSelectedRow:function(){for(var a in this.selected){var b=this.selected[a];if(b.__id in this.records)return b}return null},getSelectedRows:function(){var a=[];for(var b in this.selected){var c=this.selected[b];c.__id in this.records&&a.push(c)}return a},getSelectedRowObj:function(){for(var a in this.selected){var b=this.selected[a];if(b.__id in this.records)return this.getRowObj(b)}return null},getSelectedRowObjs:function(){var a=[];for(var b in this.selected){var c=this.selected[b];c.__id in this.records&&a.push(this.getRowObj(c))}return a},getCellObj:function(a,b){var c=this.getRow(a);return b=this.getColumn(b),document.getElementById(this._getCellDomId(c,b))},getRowObj:function(a,b){var c=this;this.options;return null==a?null:"string"==typeof a?c._isRowId(a)?document.getElementById(c.id+(b?"|1|":"|2|")+a):document.getElementById(c.id+(b?"|1|":"|2|")+c.rows[parseInt(a)].__id):"number"==typeof a?document.getElementById(c.id+(b?"|1|":"|2|")+c.rows[a].__id):"object"==typeof a&&a.__id?c.getRowObj(a.__id,b):a},getRow:function(a){var b=this;this.options;return null==a?null:"string"==typeof a?b._isRowId(a)?b.records[a]:b.rows[parseInt(a)]:"number"==typeof a?b.rows[parseInt(a)]:"object"!=typeof a||1!=a.nodeType||a.__id?a:b._getRowByDomId(a.id)},_setColumnVisible:function(a,b){var c=this;this.options;if(b){if(a._hide=!0,document.getElementById(a.__domid).style.display="none",-1!=a.__pid){for(var d=!0,e=this._columns[a.__pid],f=0;e&&f<e.columns.length;f++)if(!e.columns[f]._hide){d=!1;break}d&&(e._hide=!0,document.getElementById(e.__domid).style.display="none",this._setColumnVisible(e,b))}}else if(a._hide=!1,document.getElementById(a.__domid).style.display="",-1!=a.__pid){var e=c._columns[a.__pid];e._hide&&(document.getElementById(e.__domid).style.display="",this._setColumnVisible(e,b))}},toggleCol:function(a,b,c){var d,e=this;this.options;if("number"==typeof a)d=e.columns[a];else if("object"==typeof a&&a.__id)d=a;else if("string"==typeof a){if(!e._isColumnId(a))return void $(e.columns).each(function(){this.name==a&&e.toggleCol(this,b,c)});d=e._columns[a]}if(d){var f=d.__leafindex,g=document.getElementById(d.__domid);if(g){g=$(g);var h=[];for(var i in e.rows){var j=e.getCellObj(e.rows[i],d);j&&h.push(j)}for(var i=0;i<e.totalNumber;i++){var k=document.getElementById(e.id+"|total"+i+"|"+d.__id);k&&h.push(k)}var l=d._width;b&&d._hide?(d.frozen?e.f.gridtablewidth+=parseInt(l)+1:e.gridtablewidth+=parseInt(l)+1,e._setColumnVisible(d,!1),$(h).show()):b||d._hide||(d.frozen?e.f.gridtablewidth-=parseInt(l)+1:e.gridtablewidth-=parseInt(l)+1,e._setColumnVisible(d,!0),$(h).hide()),d.frozen?($("div:first",e.f.gridheader).width(e.f.gridtablewidth),$("div:first",e.f.gridbody).width(e.f.gridtablewidth)):($("div:first",e.gridheader).width(e.gridtablewidth+40),$("div:first",e.gridbody).width(e.gridtablewidth)),e._updateFrozenWidth(),c||$(":checkbox[columnindex="+f+"]",e.popup).each(function(){if(this.checked=b,$.fn.zoeCheckBox){var a=$(this).zoeGetCheckBoxManager();a&&a.updateStyle()}})}}},setColumnWidth:function(a,b){var c=this,d=this.options;if(b){b=parseInt(b,10);var e;if("number"==typeof a)e=c.columns[a];else if("object"==typeof a&&a.__id)e=a;else if("string"==typeof a){if(!c._isColumnId(a))return void $(c.columns).each(function(){this.name==a&&c.setColumnWidth(this,b)});e=c._columns[a]}if(e){var f=d.minColumnWidth;e.minWidth&&(f=e.minWidth),b=f>b?f:b;var g=b-e._width;if(0!=c.trigger("beforeChangeColumnWidth",[e,b])){e._width=b,e.frozen?(c.f.gridtablewidth+=g,$("div:first",c.f.gridheader).width(c.f.gridtablewidth),$("div:first",c.f.gridbody).width(c.f.gridtablewidth)):(c.gridtablewidth+=g,$("div:first",c.gridheader).width(c.gridtablewidth+40),$("div:first",c.gridbody).width(c.gridtablewidth)),$(document.getElementById(e.__domid)).css("width",b);var h=[];for(var i in c.records){var j=c.getCellObj(c.records[i],e);if(j&&h.push(j),!c.enabledDetailEdit()&&c.editors[i]&&c.editors[i][e.__id]){var k=c.editors[i][e.__id];k.editor.resize&&k.editor.resize(k.input,b,k.container.height(),k.editParm)}}for(var l=0;l<c.totalNumber;l++){var m=document.getElementById(c.id+"|total"+l+"|"+e.__id);m&&h.push(m)}$(h).css("width",b).find("> div.l-grid-row-cell-inner:first").css("width",b-8),c._updateFrozenWidth(),c._updateHorizontalScrollStatus.zoeDefer(c,10),c.trigger("afterChangeColumnWidth",[e,b])}}}},changeHeaderText:function(a,b){var c,d=this,e=this.options;if("number"==typeof a)c=d.columns[a];else if("object"==typeof a&&a.__id)c=a;else if("string"==typeof a){if(!d._isColumnId(a))return void $(d.columns).each(function(){this.name==a&&d.changeHeaderText(this,b)});c=d._columns[a]}if(c){var f=c.__leafindex,g=document.getElementById(c.__domid);$(".l-grid-hd-cell-text",g).html(b),e.allowHideColumn&&$(":checkbox[columnindex="+f+"]",d.popup).parent().next().html(b)}},changeCol:function(a,b,c){var d=this,e=this.options;if(a&&b){var f=d.getColumn(a),g=d.getColumn(b);f.frozen=g.frozen;var h,i,j=-1==f.__pid?e.columns:d._columns[f.__pid].columns,k=-1==g.__pid?e.columns:d._columns[g.__pid].columns;h=$.inArray(f,j),i=$.inArray(g,k);var l=j==k;f.__level==g.__level;k.splice(i+(c?1:0),0,f),l?c?j.splice(h,1):j.splice(h+1,1):j.splice(h,1),d._setColumns(e.columns),d.reRender()}},collapseDetail:function(a){var b=this,c=(this.options,b.getRow(a));if(c)for(var d=0,e=b.columns.length;e>d;d++)if(b.columns[d].isdetail){var f=b.getRowObj(c),g=b.getCellObj(c,b.columns[d]);return $(f).next("tr.l-grid-detailpanel").hide(),$(".l-grid-row-cell-detailbtn:first",g).removeClass("l-open"),void b.trigger("SysGridHeightChanged")}},extendDetail:function(a){var b=this,c=(this.options,b.getRow(a));if(c)for(var d=0,e=b.columns.length;e>d;d++)if(b.columns[d].isdetail){var f=b.getRowObj(c),g=b.getCellObj(c,b.columns[d]);return $(f).next("tr.l-grid-detailpanel").show(),$(".l-grid-row-cell-detailbtn:first",g).addClass("l-open"),void b.trigger("SysGridHeightChanged")}},getParent:function(a){var b=this,c=this.options;if(!c.tree)return null;var d=b.getRow(a);return d&&d.__pid in b.records?b.records[d.__pid]:null},getChildren:function(a,b){function c(a){if(a[e.tree.childrenName])for(var d=0,f=a[e.tree.childrenName].length;f>d;d++){var h=a[e.tree.childrenName][d];"delete"!=h[e.statusName]&&(g.push(h),b&&c(h))}}var d=this,e=this.options;if(!e.tree)return null;var f=d.getRow(a);if(!f)return null;var g=[];return c(f),g},isLeaf:function(a){var b=this,c=(this.options,b.getRow(a));return c?c.__hasChildren?!1:!0:void 0},hasChildren:function(a){var b=this.options,c=this.getRow(a);return c?c[b.tree.childrenName]&&c[b.tree.childrenName].length?!0:!1:void 0},existRecord:function(a){for(var b in this.records)if(this.records[b]==a)return!0;return!1},_removeSelected:function(a){var b=this,c=this.options;if(c.tree){var d=b.getChildren(a,!0);if(d)for(var e=0,f=d.length;f>e;e++){var g=$.inArray(d[e],b.selected);-1!=g&&b.selected.splice(g,1)}}var h=$.inArray(a,b.selected);-1!=h&&b.selected.splice(h,1)},_getParentChildren:function(a){var b,c=this,d=this.options,e=c.getRow(a);return b=d.tree&&c.existRecord(e)&&e.__pid in c.records?c.records[e.__pid][d.tree.childrenName]:c.currentData[d.root]},_removeData:function(a){var b=this,c=(this.options,b._getParentChildren(a)),d=$.inArray(a,c);-1!=d&&c.splice(d,1),b._removeSelected(a)},_addData:function(a,b,c,d){var e=this,f=this.options;e.currentData||(e.currentData={}),e.currentData[f.root]||(e.currentData[f.root]=[]);var g=e.currentData[f.root];if(c){f.tree&&(b?g=b[f.tree.childrenName]:c.__pid in e.records&&(g=e.records[c.__pid][f.tree.childrenName]));var h=$.inArray(c,g);g.splice(-1==h?-1:h+(d?0:1),0,a)}else f.tree&&b&&(g=b[f.tree.childrenName]),g.push(a)},_appendData:function(a,b,c,d){var e=this,f=this.options;a[f.statusName]="update",e._removeData(a),e._addData(a,b,c,d)},appendRange:function(a,b,c,d){var e=this,f=(this.options,!1);$.each(a,function(a,g){g.__id&&e.existRecord(g)?(e.isLeaf(b)&&e.upgrade(b),e._appendData(g,b,c,d),f=!0):e.appendRow(g,b,c,d)}),f&&e.reRender()},appendRow:function(a,b,c,d){var e=this;this.options;return $.isArray(a)?void e.appendRange(a,b,c,d):a.__id&&e.existRecord(a)?(e._appendData(a,b,c,d),void e.reRender()):(b&&e.isLeaf(b)&&e.upgrade(b),void e.addRow(a,c,d?!0:!1,b))},upgrade:function(a){var b=this,c=this.options,d=b.getRow(a);if(d&&c.tree){d[c.tree.childrenName]=d[c.tree.childrenName]||[],d.__hasChildren=!0;var e=[b.getRowObj(d)];b.enabledFrozen()&&e.push(b.getRowObj(d,!0)),$("> td > div > .l-grid-tree-space:last",e).addClass("l-grid-tree-link l-grid-tree-link-open")}},demotion:function(a){var b=this,c=this.options,d=b.getRow(a);if(d&&c.tree){var e=[b.getRowObj(d)];if(b.enabledFrozen()&&e.push(b.getRowObj(d,!0)),$("> td > div > .l-grid-tree-space:last",e).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close"),b.hasChildren(d))for(var f=b.getChildren(d),g=0,h=f.length;h>g;g++)b.deleteRow(f[g]);d.__hasChildren=!1}},collapseAll:function(){var a=this;this.options;$(a.rows).each(function(b,c){var d=a.getRowObj(c),e=$(".l-grid-tree-link",d);e.hasClass("l-grid-tree-link-close")||a.toggle(c)})},expandAll:function(){var a=this;this.options;$(a.rows).each(function(b,c){var d=a.getRowObj(c),e=$(".l-grid-tree-link",d);e.hasClass("l-grid-tree-link-open")||a.toggle(c)})},collapse:function(a){var b=this,c=(this.options,b.getRowObj(a)),d=$(".l-grid-tree-link",c);d.hasClass("l-grid-tree-link-close")||b.toggle(a)},expand:function(a){var b=this,c=(this.options,b.getRowObj(a)),d=$(".l-grid-tree-link",c);d.hasClass("l-grid-tree-link-open")||b.toggle(a)},toggle:function(a){if(a){var b=this,c=(this.options,b.getRow(a)),d=[b.getRowObj(c)];b.enabledFrozen()&&d.push(b.getRowObj(c,!0));var e,f=(c.__level,$(".l-grid-tree-link:first",d)),g=!0;if(b.collapsedRows=b.collapsedRows||[],f.hasClass("l-grid-tree-link-close")){if(b.hasBind("treeExpand")&&0==b.trigger("treeExpand",[c]))return!1;f.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),e=$.inArray(c,b.collapsedRows),-1!=e&&b.collapsedRows.splice(e,1)}else{if(b.hasBind("treeCollapse")&&0==b.trigger("treeCollapse",[c]))return!1;g=!1,f.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open"),e=$.inArray(c,b.collapsedRows),-1==e&&b.collapsedRows.push(c)}for(var h=b.getChildren(c,!0),i=0,j=h.length;j>i;i++){var k=h[i],l=$([b.getRowObj(k.__id)]);b.enabledFrozen()&&(l=l.add(b.getRowObj(k.__id,!0))),g?($(".l-grid-tree-link",l).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),l.show()):($(".l-grid-tree-link",l).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close"),l.hide())}b.trigger(g?"treeExpanded":"treeCollapsed",[c])}},_bulid:function(){var a=this;a._clearGrid(),a._initBuildHeader(),a._initHeight(),a._initFootbar(),a._buildPager(),a._setEvent()},_setColumns:function(a){var b=this;b._initColumns(),b._initBuildGridHeader(),b._initBuildPopup()},_initBuildHeader:function(){var a=this,b=this.options;b.title?($(".l-panel-header-text",a.header).html(b.title),b.headerImg&&a.header.append("<img src='"+b.headerImg+"' />").addClass("l-panel-header-hasicon")):a.header.hide(),b.toolbar?$.fn.zoeToolBar&&(a.toolbarManager=a.topbar.zoeToolBar(b.toolbar),0==a.topbar.height()?a.topbar.parent().height(25):a.topbar.parent().height(a.topbar.height())):a.topbar.parent().remove()},_createColumnId:function(a){return null!=a.id&&""!=a.id?a.id.toString():"c"+(100+this._columnCount)},_isColumnId:function(a){return a in this._columns},_initColumns:function(){function a(a,b){for(var c in b)b[c]in a&&delete a[b[c]]}function b(d,e,f,g){if(a(d,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]),e>c._columnMaxLevel&&(c._columnMaxLevel=e),c._columnCount++,d.__id=c._createColumnId(d),d.__domid=c.id+"|hcell|"+d.__id,c._columns[d.__id]=d,
d.columns&&d.columns.length||(d.__leafindex=c._columnLeafCount++),d.__level=e,d.__pid=f,d.__previd=g,!d.columns||!d.columns.length)return d.__leaf=!0,1;for(var h=0,i=-1,j=0,k=d.columns.length;k>j;j++){var l=d.columns[j];h+=b(l,e+1,d.__id,i),i=l.__id}return d.__leafcount=h,h}var c=this,d=this.options;if(c._columns={},c._columnCount=0,c._columnLeafCount=0,c._columnMaxLevel=1,d.columns){var e=-1;if(d.rownumbers){var f=c.enabledGroup()?!1:d.frozen&&d.frozenRownumbers,g={isrownumber:!0,issystem:!0,width:d.rownumbersColWidth,frozen:f};b(g,1,-1,e),e=g.__id}if(c.enabledDetail()&&d.isDetailBtn){var h=c.enabledGroup()?!1:d.frozen&&d.frozenDetail,g={isdetail:!0,issystem:!0,width:d.detailColWidth,frozen:h};b(g,1,-1,e),e=g.__id}if(c.enabledCheckbox()){var i=c.enabledGroup()?!1:d.frozen&&d.frozenCheckbox,g={ischeckbox:!0,issystem:!0,width:d.detailColWidth,frozen:i};b(g,1,-1,e),e=g.__id}for(var j=0,k=d.columns.length;k>j;j++){var g=d.columns[j];g&&(b(g,1,-1,e),e=g.__id)}for(var l in c._columns){var g=c._columns[l];g.__leafcount>1&&(g.__colSpan=g.__leafcount),g.__leaf&&g.__level!=c._columnMaxLevel&&(g.__rowSpan=c._columnMaxLevel-g.__level+1)}c.columns=c.getColumns(),$(c.columns).each(function(a,b){b.columnname=b.name,b.columnindex=a,b.type=b.type||"string",b.islast=a==c.columns.length-1,b.isSort=0==b.isSort?!1:!0,b.frozen=b.frozen?!0:!1,b._width=c._getColumnWidth(b),b._hide=b.hide?!0:!1,b.enabledCustom=b.enabledCustom?!0:!1})}},_getColumnWidth:function(a){var b=this,c=this.options,d=a.width||c.columnWidth;if(!d||"auto"==d){var e=0,f=0;$(b.columns).each(function(a,d){var g=d.width||c.columnWidth,h=g&&"auto"!=g?!1:!0;h?e++:f+=parseInt(b._getColumnWidth(d))+1}),d=parseInt((b.grid.width()-f)/e)-1}if("string"==typeof d&&d.indexOf("%")>0){var g=0;b.enabledDetail()&&(g+=c.detailColWidth),b.enabledCheckbox()&&(g+=c.checkboxColWidth),b.options.rownumbers&&(g+=b.options.rownumbersColWidth),a._width=d=parseInt(.01*parseInt(d)*(b.grid.width()-g-b.columns.length/2-1))}return a.minWidth&&d<a.minWidth&&(d=a.minWidth),a.maxWidth&&d>a.maxWidth&&(d=a.maxWidth),d},_createHeaderCell:function(a){var b=this,c=this.options,d=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");if(d.attr("id",a.__domid),a.__leaf||d.addClass("l-grid-hd-cell-mul"),a.columnindex==b.columns.length-1&&d.addClass("l-grid-hd-cell-last"),a.isrownumber&&(d.addClass("l-grid-hd-cell-rownumbers"),d.html("<div class='l-grid-hd-cell-inner'></div>")),a.ischeckbox&&(d.addClass("l-grid-hd-cell-checkbox"),d.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")),a.isdetail&&(d.addClass("l-grid-hd-cell-detail"),d.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")),a.heightAlign&&$(".l-grid-hd-cell-inner:first",d).css("textAlign",a.heightAlign),a.__colSpan&&d.attr("colSpan",a.__colSpan),a.__rowSpan){d.attr("rowSpan",a.__rowSpan),d.height(c.headerRowHeight*a.__rowSpan);var e=(c.headerRowHeight*a.__rowSpan-c.headerRowHeight)/2-5;$(".l-grid-hd-cell-inner:first",d).css("paddingTop",e)}else d.height(c.headerRowHeight);a.__leaf&&(d.width(a._width),d.attr("columnindex",a.__leafindex));var f=d.height();!a.__rowSpan&&f>10&&$(">div:first",d).height(f),a._hide&&d.hide(),a.name&&d.attr({columnname:a.name});var g="";return g=a.display&&""!=a.display?a.display:a.headerRender?a.headerRender(a):"&nbsp;",$(".l-grid-hd-cell-text:first",d).html(g),!a.issystem&&a.__leaf&&a.resizable!==!1&&$.fn.zoeResizable&&c.allowAdjustColWidth&&(b.colResizable[a.__id]=d.zoeResizable({handles:"e",onStartResize:function(a,c){this.proxy.hide(),b.draggingline.css({height:b.body.height(),top:0,left:c.pageX-b.grid.offset().left+parseInt(b.body[0].scrollLeft)}).show()},onResize:function(a,c){b.colresizing=!0,b.draggingline.css({left:c.pageX-b.grid.offset().left+parseInt(b.body[0].scrollLeft)}),$("body").add(d).css("cursor","e-resize")},onStopResize:function(c){return b.colresizing=!1,$("body").add(d).css("cursor","default"),b.draggingline.hide(),b.setColumnWidth(a,parseInt(a._width)+c.diffX),!1}})),d},_initBuildGridHeader:function(){var a=this,b=this.options;if(a.gridtablewidth=0,a.f.gridtablewidth=0,a.colResizable){for(var c in a.colResizable)a.colResizable[c].destroy();a.colResizable=null}a.colResizable={},$("tbody:first",a.gridheader).html(""),$("tbody:first",a.f.gridheader).html("");for(var d=1;d<=a._columnMaxLevel;d++){var e=a.getColumns(d),f=d==a._columnMaxLevel,g=$("<tr class='l-grid-hd-row'></tr>"),h=$("<tr class='l-grid-hd-row'></tr>");f||g.add(h).addClass("l-grid-hd-mul"),$("tbody:first",a.gridheader).append(g),$("tbody:first",a.f.gridheader).append(h),$(e).each(function(b,c){if((c.frozen?h:g).append(a._createHeaderCell(c)),c.__leaf){var d=c._width;c.frozen?a.f.gridtablewidth+=(parseInt(d)?parseInt(d):0)+1:a.gridtablewidth+=(parseInt(d)?parseInt(d):0)+1}})}if(a._columnMaxLevel>0){var i=b.headerRowHeight*a._columnMaxLevel;a.gridheader.add(a.f.gridheader).height(i),b.rownumbers&&b.frozenRownumbers&&a.f.gridheader.find("td:first").height(i)}a._updateFrozenWidth(),$("div:first",a.gridheader).width(a.gridtablewidth+40)},_initBuildPopup:function(){var a=this,b=this.options;if($(":checkbox",a.popup).unbind(),$("tbody tr",a.popup).remove(),$(a.columns).each(function(b,c){if(!c.issystem&&0!=c.isAllowHide){var d='checked="checked"';c._hide&&(d="");var e=c.display;$("tbody",a.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+d+' class="l-checkbox" columnindex="'+b+'"/></td><td class="l-column-right">'+e+"</td></tr>")}}),$.fn.zoeCheckBox&&$("input:checkbox",a.popup).zoeCheckBox({onBeforeClick:function(c){return c.checked&&$("input:checked",a.popup).length<=b.minColToggle?!1:!0}}),b.allowHideColumn){$("tr",a.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")});var c=function(){return $("input:checked",a.popup).length+1<=b.minColToggle?!1:void a.toggleCol(parseInt($(this).attr("columnindex")),this.checked,!0)};$.fn.zoeCheckBox?$(":checkbox",a.popup).bind("change",c):$(":checkbox",a.popup).bind("click",c)}},_initHeight:function(){var a=this,b=this.options;"auto"==b.height&&(a.gridbody.height("auto"),a.f.gridbody.height("auto")),b.width&&a.grid.width(b.width),a._onResize.call(a)},_initFootbar:function(){var a=this,b=this.options;if(b.usePager){var c="",d=-1;$(b.pageSizeOptions).each(function(a,e){var f="";b.pageSize==e&&(d=a),c+="<option value='"+e+"' "+f+" >"+e+"</option>"}),$(".l-bar-selectpagesize",a.toolbar).append("<select name='rp' class='l-gridbar-select'>"+c+"</select>"),-1!=d&&($(".l-bar-selectpagesize select",a.toolbar)[0].selectedIndex=d),b.switchPageSizeApplyComboBox&&$.fn.zoeComboBox&&$(".l-bar-selectpagesize select",a.toolbar).zoeComboBox({onBeforeSelect:function(){return b.url&&a.isDataChanged&&!confirm(b.isContinueByDataChanged)?!1:!0},width:45})}else a.toolbar.hide()},_searchData:function(a,b){for(var c=(this.options,new Array),d=0;d<a.length;d++)b(a[d],d)&&(c[c.length]=a[d]);return c},_clearGrid:function(){var a=this;this.options;for(var b in a.rows){var c=$(a.getRowObj(a.rows[b]));a.enabledFrozen()&&(c=c.add(a.getRowObj(a.rows[b],!0))),c.unbind()}a.gridbody.html(""),a.f.gridbody.html(""),a.recordNumber=0,a.records={},a.rows=[],a.selected=[],a.totalNumber=0,a.editorcounter=0},clearGrid:function(){var a=this;this.options;a._clearGrid(),$.zoeui.remove(this),a.grid.remove(),$("body").unbind("keydown.grid")},_fillGridBody:function(a,b){var c=this,d=this.options,e=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(c.enabledGroup()){var f=[];if(d.groupNewRowName)var g=[];var h=[];c.groups=h;for(var i in a){var j=a[i],k=j[d.groupColumnName];if(d.groupNewRowName)var l=j[d.groupNewRowName];var m=$.inArray(k,f);if(d.groupNewRowName)var n=$.inArray(l,g);-1==m&&(f.push(k),m=f.length-1,h.push([])),d.groupNewRowName&&-1==n&&g.push(l),h[m].push(j)}$(h).each(function(a,i){1==h.length&&e.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"'),a==h.length-1?e.push('<tr class="l-grid-grouprow l-grid-grouprow-last"'):0==a?e.push('<tr class="l-grid-grouprow l-grid-grouprow-first"'):e.push('<tr class="l-grid-grouprow"'),e.push(' groupindex"='+a+'" id="'+c.id+"|"+a+"|"+f[a]+'" >'),e.push('<td colSpan="'+c.columns.length+'" class="l-grid-grouprow-cell">'),e.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>'),d.groupRender?e.push(d.groupRender(f[a],i,d.groupColumnDisplay)):e.push(d.groupColumnDisplay+":"+f[a]),e.push("</td>"),e.push("</tr>"),e.push(c._getHtmlFromData(i,b)),d.groupNewRowName&&$.isFunction(d.groupNewRowRender)&&e.push(d.groupNewRowRender(g[a])),c.isTotalSummary()&&e.push(c._getTotalSummaryHtml(i,"l-grid-totalsummary-group",b))})}else e.push(c._getHtmlFromData(a,b));e.push("</tbody></table></div>"),b&&e.push('<div class="l-jplace"></div>'),(b?c.f.gridbody:c.gridbody).html(e.join("")),c.enabledGroup()||c._bulidTotalSummary(b),$("> div:first",c.gridbody).width(c.gridtablewidth)},_showData:function(){var a=this,b=this.options;a.changedCells={};var c=a.currentData[b.root];if(b.usePager&&("server"==b.dataAction&&a.data&&a.data[b.record]?b.total=a.data[b.record]:a.filteredData&&a.filteredData[b.root]?b.total=a.filteredData[b.root].length:a.data&&a.data[b.root]?b.total=a.data[b.root].length:c&&(b.total=c.length),b.page=b.newPage,b.total||(b.total=0),b.page||(b.page=1),b.pageCount=Math.ceil(b.total/b.pageSize),b.pageCount||(b.pageCount=1),a._buildPager()),$(".l-bar-btnloading:first",a.toolbar).removeClass("l-bar-btnloading"),0!=a.trigger("beforeShowData",[a.currentData])){if(a._clearGrid(),a.isDataChanged=!1,!c||!c.length)return a.gridview.addClass("l-grid-empty"),$("<div style='text-align:center; padding-top:20px; color:#ff0000;'>当前没有数据</div>").addClass("l-grid-body-inner").appendTo(a.gridbody).css("height",a.gridbody.height()-20),a.trigger("afterShowData",[a.currentData]),void a._onResize.zoeDefer(a,50);if(a.gridview.removeClass("l-grid-empty"),$(".l-bar-btnload:first span",a.toolbar).removeClass("l-disabled"),a._updateGridData(),a.enabledFrozen()&&a._fillGridBody(a.rows,!0),a._fillGridBody(a.rows,!1),a.trigger("SysGridHeightChanged"),b.totalRender&&($(".l-panel-bar-total",a.element).remove(),$(".l-panel-bar",a.element).before('<div class="l-panel-bar-total">'+b.totalRender(a.data,a.filteredData)+"</div>")),b.mouseoverRowCssClass)for(var d in a.rows){var e=$(a.getRowObj(a.rows[d]));a.enabledFrozen()&&(e=e.add(a.getRowObj(a.rows[d],!0))),e.bind("mouseover.gridrow",function(){a._onRowOver(this,!0)}).bind("mouseout.gridrow",function(){a._onRowOver(this,!1)})}a._fixHeight(),a.gridbody.trigger("scroll.grid"),a.trigger("afterShowData",[a.currentData])}},_fixHeight:function(){var a=this,b=this.options;if(!b.fixedCellHeight&&b.frozen){var c,d;for(var e in a.columns){var f=a.columns[e];if(c&&d)break;!f.frozen||c?f.frozen||d||(d=f):c=f}if(c&&d)for(var g in a.records){var h=a.getCellObj(g,c),i=a.getCellObj(g,d),j=Math.max($(h).height(),$(i).height());$(h).add(i).height(j)}}},_getRowDomId:function(a,b){return this.id+"|"+(b?"1":"2")+"|"+a.__id},_getCellDomId:function(a,b){return this._getRowDomId(a,b.frozen)+"|"+b.__id},_getHtmlFromData:function(a,b){if(!a)return"";for(var c=this,d=this.options,e=[],f=0,g=a.length;g>f;f++){var h=a[f],i=h.__id;if(h){if(e.push("<tr"),e.push(' id="'+c._getRowDomId(h,b)+'"'),e.push(' class="l-grid-row'),!b&&c.enabledCheckbox()&&d.isChecked&&d.isChecked(h)?(c.select(h),e.push(" l-selected")):c.isSelected(h)?e.push(" l-selected"):d.isSelected&&d.isSelected(h)&&(c.select(h),e.push(" l-selected")),d.groupsAlterNatingRow&&(f+1)%2==1&&e.push(" l-grid-row-alt"),d.groupsAlterNatingRow||h.__index%2==1&&d.alternatingRow&&e.push(" l-grid-row-alt"),e.push('" '),d.rowAttrRender&&e.push(d.rowAttrRender(h,i)),d.tree&&c.collapsedRows&&c.collapsedRows.length){var j=function(){for(var a=c.getParent(h);a;){if(-1!=$.inArray(a,c.collapsedRows))return!0;a=c.getParent(a)}return!1};j()&&e.push(' style="display:none;" ')}e.push(">"),$(c.columns).each(function(a,f){if(b==f.frozen){if(e.push("<td"),e.push(' id="'+c._getCellDomId(h,this)+'"'),this.isrownumber)return e.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight?e.push(' style = "height:'+d.rowHeight+'px;" '):e.push(' style = "min-height:'+d.rowHeight+'px;" '),void e.push(">"+(parseInt(h.__index)+1)+"</div></td>");if(this.ischeckbox)return e.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight?e.push(' style = "height:'+d.rowHeight+'px;" '):e.push(' style = "min-height:'+d.rowHeight+'px;" '),e.push(">"),e.push('<span class="l-grid-row-cell-btn-checkbox"></span>'),void e.push("</div></td>");if(this.isdetail)return e.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight?e.push(' style = "height:'+d.rowHeight+'px;" '):e.push(' style = "min-height:'+d.rowHeight+'px;" '),e.push(">"),(!d.isShowDetailToggle||d.isShowDetailToggle(h))&&e.push('<span class="l-grid-row-cell-detailbtn"></span>'),void e.push("</div></td>");var g=this._width;e.push(' class="l-grid-row-cell '),c.changedCells[i+"_"+this.__id]&&e.push("l-grid-row-cell-edited "),this.islast&&e.push("l-grid-row-cell-last "),e.push('"'),e.push(' style = "'),e.push("width:"+g+"px; "),f._hide&&e.push("display:none;"),e.push(' ">'),e.push(c._getCellHtml(h,f)),e.push("</td>")}}),e.push("</tr>")}}return e.join("")},_getCellHtml:function(a,b){var c=this,d=this.options;if(b.isrownumber)return'<div class="l-grid-row-cell-inner">'+(parseInt(a.__index)+1)+"</div>";var e=[];e.push('<div class="l-grid-row-cell-inner"'),e.push(' style = "width:'+parseInt(b._width-8)+"px;"),d.fixedCellHeight&&e.push("height:"+d.rowHeight+"px;"),e.push("min-height:"+d.rowHeight+"px; "),b.align&&e.push("text-align:"+b.align+";"),e.push('"');var f=c._getCellContent(a,b);try{f.indexOf("</div>")<0&&f.indexOf("</a>")<0&&f.indexOf("</span>")<0&&e.push('title ="'+f+'"')}catch(g){e.push('title ="'+f+'"')}return e.push(">"+f+"</div>"),e.join("")},_setValueByName:function(a,b,c){if(!a||!b)return null;if(-1==b.indexOf("."))a[b]=c;else try{new Function("data,value","data."+b+"=value;")(a,c)}catch(d){}},_getValueByName:function(a,b){if(!a||!b)return null;if(-1==b.indexOf("."))return a[b];try{return new Function("data","return data."+b+";")(a)}catch(c){return null}},_getCellContent:function(a,b){var c=this,d=this.options;if(!a||!b)return"";if(b.isrownumber)return parseInt(a.__index)+1;var e=(a.__id,a.__index),f=c._getValueByName(a,b.name),g=c._getValueByName(a,b.textField),h="";if(b.render?h=b.render.call(c,a,e,f,b):d.formatters[b.type]?h=d.formatters[b.type].call(c,f,b):null!=g?h=g.toString():null!=f&&(h=f.toString()),d.tree&&(null!=d.tree.columnName&&d.tree.columnName==b.name||null!=d.tree.columnId&&d.tree.columnId==b.id)&&(h=c._getTreeCellHtml(h,a)),b.editor){"number"==b.editor.type&&null!=h&&""!=h&&null!=b.editor.toFixed&&(h=Number(h).toFixed(b.editor.toFixed),a[b.name]=h);var i=0;if(("combobox"==b.editor.type||"select"==b.editor.type)&&null!=h&&""!=h&&b.editor.data){for(var j in b.editor.data)b.editor.data[j][b.editor.textField]&&h==b.editor.data[j][b.editor.textField]&&(i=1);!i&&b.editor.isContrast&&(a[b.name]="",a[b.textField]="",h="")}}return h||""},_getTreeCellHtml:function(a,b){var c=b.__level,d=this,e=this.options,f=-1==$.inArray(b,d.collapsedRows||[]),g=e.tree.isParent(b),h="";c=parseInt(c)||1;for(var i=1;c>i;i++)h+="<div class='l-grid-tree-space'></div>";return h+=f&&g?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>":g?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>":"<div class='l-grid-tree-space'></div>",h+="<span class='l-grid-tree-content'>"+a+"</span>"},_applyEditor:function(a){var b=this,c=this.options,d=a,e=d.id.split("|"),f=e[e.length-1],g=b._columns[f],h=$(d).parent(),i=b.getRow(h[0]),j=i.__id,k=i.__index;if(g&&g.editor){var l=g.name;g.columnindex;if(g.editor.type&&c.editors[g.editor.type]){var m=b._getValueByName(i,l),n={record:i,value:m,column:g,rowindex:k};if(g.textField&&(n.text=b._getValueByName(i,g.textField)),0==b.trigger("beforeEdit",[n]))return!1;b.lastEditRow=i;var o=c.editors[g.editor.type],p=$(d),q=($(d).offset(),$(d).width()),r=$(d).height(),s=$("<div class='l-grid-editor'></div>").appendTo(b.grid),t=0,u=0,v=p.position(),w=b.gridbody.position(),x=b.gridview2.position(),y=(c.toolbar?b.topbar.parent().outerHeight():0)+(c.title?b.header.outerHeight():0),t=v.left+w.left+x.left,u=v.top+w.top+x.top+y;p.html(""),b.setCellEditing(i,g,!0),s.css({left:t,top:($.browser.safari?u:u-1)+c.editorTopDiff}).show(),g.textField&&(n.text=b._getValueByName(i,g.textField));var z=b._createEditor(o,s,n,q,r-1);b.editor={editing:!0,editor:o,input:z,editParm:n,container:s},b.unbind("sysEndEdit"),b.bind("sysEndEdit",function(){var a=o.getValue(z,n);if(""==a&&g.enabledCustom){var c="input[zoeuiid='"+z.id+"']";a=$(c).val(),n.record[n.column.editor.textField]=a}g.textField&&o.getText&&(n.text=o.getText(z,n)),o.getSelected&&(n.selected=o.getSelected(z,n)),a!=m&&($(d).addClass("l-grid-row-cell-edited"),b.changedCells[j+"_"+g.__id]=!0,g.textField!=g.name&&(n.value=a)),g.editor.onChange&&g.editor.onChange(n),b._checkEditAndUpdateCell(n)&&g.editor.onChanged&&g.editor.onChanged(n)})}}},_checkEditAndUpdateCell:function(a){var b=this;this.options;if(0==b.trigger("beforeSubmitEdit",[a]))return!1;var c=a.column;return a.text&&c.textField&&b._setValueByName(a.record,c.textField,a.text),b.updateCell(c,a.value,a.record),(c.render||b.enabledTotal())&&b.reRender({column:c}),b.reRender({rowdata:a.record}),!0},_getCurrentPageData:function(a){var b=this.options,c={};if(c[b.root]=[],!a||!a[b.root]||!a[b.root].length)return c[b.record]=0,c;for(c[b.record]=a[b.root].length,b.newPage||(b.newPage=1),i=(b.newPage-1)*b.pageSize;i<a[b.root].length&&i<b.newPage*b.pageSize;i++)c[b.root].push(a[b.root][i]);return c},_compareData:function(a,b,c,d){var e=this,f=this.options,g=a[c],h=b[c];return null==g&&null!=h?1:null==g&&null==h?0:null!=g&&null==h?-1:f.sorters[d]?f.sorters[d].call(e,g,h):h>g?-1:g>h?1:0},_getTotalCellContent:function(a,b){var c=this,d=this.options,e=[];if(a.totalSummary){for(var f=function(a){for(var b=0;b<o.length;b++)if(o[b].toLowerCase()==a.toLowerCase())return!0;return!1},g=0,h=0,i=0,j=parseFloat(b[0][a.name]),k=parseFloat(b[0][a.name]),l=0;l<b.length;l++)if("delete"!=b[l][d.statusName]){h+=1;var m=b[l][a.name];"string"==typeof m&&(m=m.replace(/\$|\,/g,"")),m=parseFloat(m),m&&(g+=m,m>j&&(j=m),k>m&&(k=m))}if(i=1*g/b.length,a.totalSummary.render){var n=a.totalSummary.render({sum:g,count:h,avg:i,min:k,max:j},a,c.data);e.push(n)}else if(a.totalSummary.type){var o=a.totalSummary.type.split(",");f("sum")&&e.push("<div>Sum="+g.toFixed(2)+"</div>"),f("count")&&e.push("<div>Count="+h+"</div>"),f("max")&&e.push("<div>Max="+j.toFixed(2)+"</div>"),f("min")&&e.push("<div>Min="+k.toFixed(2)+"</div>"),f("avg")&&e.push("<div>Avg="+i.toFixed(2)+"</div>")}}return e.join("")},_getTotalSummaryHtml:function(a,b,c){var d=this,e=(this.options,[]);return b?e.push('<tr class="l-grid-totalsummary '+b+'">'):e.push('<tr class="l-grid-totalsummary">'),$(d.columns).each(function(b,f){if(this.frozen==c){if(this.isrownumber)return void e.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');if(this.ischeckbox)return void e.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');if(this.isdetail)return void e.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');e.push('<td class="l-grid-totalsummary-cell'),this.islast&&e.push(" l-grid-totalsummary-cell-last"),e.push('" '),e.push('id="'+d.id+"|total"+d.totalNumber+"|"+f.__id+'" '),e.push('width="'+this._width+'" '),columnname=this.columnname,columnname&&e.push('columnname="'+columnname+'" '),e.push('columnindex="'+b+'" '),e.push('><div class="l-grid-totalsummary-cell-inner"'),f.align&&e.push(' style="text-Align:'+f.align+';"'),e.push(">"),e.push(d._getTotalCellContent(f,a)),e.push("</div></td>")}}),e.push("</tr>"),c||d.totalNumber++,e.join("")},_bulidTotalSummary:function(a){var b=this,c=this.options;if(!b.isTotalSummary())return!1;if(!b.currentData||0==b.currentData[c.root].length)return!1;var d=$(b._getTotalSummaryHtml(b.currentData[c.root],null,a));$("tbody:first",a?b.f.gridbody:b.gridbody).append(d),a?b.totalRow1=d:b.totalRow2=d},updateTotalSummary:function(){var a=this,b=this.options;if(a.isTotalSummary()&&a.currentData&&0!=a.currentData[b.root].length){var c=$(a._getTotalSummaryHtml(a.currentData[b.root],null,!1));a.totalRow2&&a.totalRow2.html(c.html())}},_buildPager:function(){var a=this,b=this.options;$(".pcontrol input",a.toolbar).val(b.page),b.pageCount||(b.pageCount=1),$(".pcontrol span",a.toolbar).html(b.pageCount);var c=parseInt((b.page-1)*b.pageSize)+1,d=parseInt(c)+parseInt(b.pageSize)-1;b.total||(b.total=0),b.total<d&&(d=b.total),b.total||(c=d=0),0>c&&(c=0),0>d&&(d=0);var e=b.pageStatMessage;e=e.replace(/{from}/,c),e=e.replace(/{to}/,d),e=e.replace(/{total}/,b.total),e=e.replace(/{pagesize}/,b.pageSize),$(".l-bar-text",a.toolbar).html(e),b.total||$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",a.toolbar).addClass("l-disabled"),1==b.page?($(".l-bar-btnfirst span",a.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",a.toolbar).addClass("l-disabled")):b.page>b.pageCount&&b.pageCount>0&&($(".l-bar-btnfirst span",a.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",a.toolbar).removeClass("l-disabled")),b.page==b.pageCount?($(".l-bar-btnlast span",a.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",a.toolbar).addClass("l-disabled")):b.page<b.pageCount&&b.pageCount>0&&($(".l-bar-btnlast span",a.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",a.toolbar).removeClass("l-disabled"))},_getRowIdByDomId:function(a){var b=a.split("|"),c=b[2];return c},_getRowByDomId:function(a){return this.records[this._getRowIdByDomId(a)]},_isEditing:function(a){return a.hasClass("l-box-dateeditor")||a.hasClass("l-box-select")},_getSrcElementByEvent:function(a){var b=this,c=a.target||a.srcElement,d=$(c).parents().add(c),e=function(a){for(var b=0,c=d.length;c>b;b++)if("string"==typeof a){if($(d[b]).hasClass(a))return d[b]}else if("object"==typeof a&&d[b]==a)return d[b];return null};if(e("l-grid-editor"))return{editing:!0,editor:e("l-grid-editor")};if(-1==d.index(this.element))return b._isEditing(d)?{editing:!0}:{out:!0};var f=!1;if(d.hasClass("l-grid-detailpanel")&&b.detailrows)for(var g=0,h=b.detailrows.length;h>g;g++)if(-1!=d.index(b.detailrows[g])){f=!0;break}var i={grid:e("l-panel"),indetail:f,frozen:e(b.gridview1[0])?!0:!1,header:e("l-panel-header"),gridheader:e("l-grid-header"),gridbody:e("l-grid-body"),total:e("l-panel-bar-total"),popup:e("l-grid-popup"),toolbar:e("l-panel-bar")};if(i.gridheader&&(i.hrow=e("l-grid-hd-row"),i.hcell=e("l-grid-hd-cell"),i.hcelltext=e("l-grid-hd-cell-text"),i.checkboxall=e("l-grid-hd-cell-checkbox"),i.hcell)){var j=i.hcell.id.split("|")[2];i.column=b._columns[j]}return i.gridbody&&(i.row=e("l-grid-row"),i.cell=e("l-grid-row-cell"),i.checkbox=e("l-grid-row-cell-btn-checkbox"),i.groupbtn=e("l-grid-group-togglebtn"),i.grouprow=e("l-grid-grouprow"),i.detailbtn=e("l-grid-row-cell-detailbtn"),i.detailrow=e("l-grid-detailpanel"),i.totalrow=e("l-grid-totalsummary"),i.totalcell=e("l-grid-totalsummary-cell"),i.rownumberscell=$(i.cell).hasClass("l-grid-row-cell-rownumbers")?i.cell:null,i.detailcell=$(i.cell).hasClass("l-grid-row-cell-detail")?i.cell:null,i.checkboxcell=$(i.cell).hasClass("l-grid-row-cell-checkbox")?i.cell:null,i.treelink=e("l-grid-tree-link"),i.editor=e("l-grid-editor"),i.row&&(i.data=this._getRowByDomId(i.row.id)),i.cell&&(i.editing=$(i.cell).hasClass("l-grid-row-cell-editing")),i.editor&&(i.editing=!0),i.editing&&(i.out=!1)),i.toolbar&&(i.first=e("l-bar-btnfirst"),i.last=e("l-bar-btnlast"),i.next=e("l-bar-btnnext"),i.prev=e("l-bar-btnprev"),i.load=e("l-bar-btnload"),i.button=e("l-bar-button")),i},_setEvent:function(){var a=this,b=this.options;a.grid.bind("mousedown.grid",function(b){a._onMouseDown.call(a,b)}),a.grid.bind("dblclick.grid",function(b){a._onDblClick.call(a,b)}),a.grid.bind("contextmenu.grid",function(b){return a._onContextmenu.call(a,b)}),$(document).bind("mouseup.grid",function(b){a._onMouseUp.call(a,b)}),$(document).bind("click.grid",function(b){a._onClick.call(a,b)}),$(window).bind("resize.grid",function(b){a._onResize.call(a)}),$(document).bind("keydown.grid",function(b){b.ctrlKey&&(a.ctrlKey=!0)}),$(document).bind("keyup.grid",function(b){delete a.ctrlKey}),a.gridbody.bind("scroll.grid",function(){var b=a.gridbody.scrollLeft(),c=a.gridbody.scrollTop();null!=b&&(a.gridheader[0].scrollLeft=b),null!=c&&(a.f.gridbody[0].scrollTop=c),a.trigger("SysGridHeightChanged")}),$("select",a.toolbar).change(function(){return a.isDataChanged&&"local"!=b.dataAction&&!confirm(b.isContinueByDataChanged)?!1:(b.newPage=1,b.pageSize=this.value,void a.loadData("local"!=b.dataAction?b.where:!1))}),$("span.pcontrol :text",a.toolbar).blur(function(b){a.changePage("input")}),$("span.pcontrol :text",a.toolbar).keypress(function(b){var c=b.charCode||b.keyCode||0;13===c&&(a.changePage("input"),$(this).blur())}),$("div.l-bar-button",a.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")}),$.fn.zoeDrag&&b.colDraggable&&(a.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body"),a.gridheader.add(a.f.gridheader).zoeDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(b,c){var d=a._getSrcElementByEvent(c);if(d.hcell&&d.column){var e=$(".l-grid-hd-cell-text:first",d.hcell).html(),f=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");return f.append(e),f}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),a.children[this.id]=this},onStartDrag:function(b,c){if(2==c.button)return!1;if(a.colresizing)return!1;this.set("cursor","default");var d=a._getSrcElementByEvent(c);if(!d.hcell||!d.column||d.column.issystem||d.hcelltext)return!1;if(-1!=$(d.hcell).css("cursor").indexOf("resize"))return!1;this.draggingColumn=d.column,a.coldragging=!0;var e=a.grid.offset();this.validRange={top:e.top,bottom:e.top+a.gridheader.height(),left:e.left-10,right:e.left+a.grid.width()+10}},onDrag:function(c,d){this.set("cursor","default");var e=this.draggingColumn;if(!e)return!1;if(a.colresizing)return!1;null==a.colDropIn&&(a.colDropIn=-1);var f=d.pageX,g=d.pageY,h=!1,i=(a.grid.offset(),this.validRange);if(f<i.left||f>i.right||g>i.bottom||g<i.top)return a.colDropIn=-1,a.colDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");for(var j in a._columns){var k=a._columns[j];if(e!=k){if(!k.issystem){var l=k.__level==e.__level,m=l&&h?!0:!1;if(e.frozen!=k.frozen&&(m=k.frozen?!1:!0),-1==a.colDropIn||a.colDropIn==j){var n=document.getElementById(k.__domid),o=$(n).offset(),p={top:o.top,bottom:o.top+$(n).height(),left:o.left-10,right:o.left+10};if(m){var q=$(n).width();p.left+=q,p.right+=q}if(f>p.left&&f<p.right&&g>p.top&&g<p.bottom){var r=b.headerRowHeight;k.__rowSpan&&(r*=k.__rowSpan),a.colDroptip.css({left:p.left+5,top:p.top-9,height:r+18}).show(),a.colDropIn=j,a.colDropDir=m?"right":"left",this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}-1!=a.colDropIn&&(a.colDropIn=-1,a.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no"))}}}else h=!0}},onStopDrag:function(b,c){var d=this.draggingColumn;a.coldragging=!1,-1!=a.colDropIn&&(a.changeCol.zoeDefer(a,0,[d,a.colDropIn,"right"==a.colDropDir]),a.colDropIn=-1),a.colDroptip.hide(),this.set("cursor","default")}})),$.fn.zoeDrag&&b.rowDraggable&&(a.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body"),a.gridbody.add(a.f.gridbody).zoeDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(c,d){var e=a._getSrcElementByEvent(d);if(e.row){var f=b.draggingMessage.replace(/{count}/,c.draggingRows?c.draggingRows.length:1);b.rowDraggingRender&&(f=b.rowDraggingRender(c.draggingRows,c,a));var g=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+f+"</div>").appendTo("body");return g}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),a.children[this.id]=this},onStartDrag:function(b,c){if(2==c.button)return!1;if(a.colresizing)return!1;if(!a.columns.length)return!1;this.set("cursor","default");var d=a._getSrcElementByEvent(c);if(!d.cell||!d.data||d.checkbox)return!1;var e=d.cell.id.split("|"),f=a._columns[e[e.length-1]];if(!(d.rownumberscell||d.detailcell||d.checkboxcell||f==a.columns[0]))return!1;if(a.enabledCheckbox()){if(this.draggingRows=a.getSelecteds(),!this.draggingRows||!this.draggingRows.length)return!1}else this.draggingRows=[d.data];this.draggingRow=d.data,this.set("cursor","move"),a.rowdragging=!0,this.validRange={top:a.gridbody.offset().top,bottom:a.gridbody.offset().top+a.gridbody.height(),left:a.grid.offset().left-10,right:a.grid.offset().left+a.grid.width()+10}},onDrag:function(c,d){var e=this.draggingRow;if(!e)return!1;var f=this.draggingRows?this.draggingRows:[e];if(a.colresizing)return!1;null==a.rowDropIn&&(a.rowDropIn=-1);var g=d.pageX,h=d.pageY,i=!1,j=this.validRange;if(g<j.left||g>j.right||h>j.bottom||h<j.top)return a.rowDropIn=-1,a.rowDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");for(var k in a.rows){var l=a.rows[k],m=l.__id;if(e==l&&(i=!0),-1==$.inArray(l,f)){var n=i?!0:!1;if(-1==a.rowDropIn||a.rowDropIn==m){var o=a.getRowObj(m),p=$(o).offset(),q={top:p.top-4,bottom:p.top+$(o).height()+4,left:a.grid.offset().left,right:a.grid.offset().left+a.grid.width()};if(g>q.left&&g<q.right&&h>q.top&&h<q.bottom){var r=p.top;n&&(r+=$(o).height()),a.rowDroptip.css({left:q.left,top:r,width:q.right-q.left}).show(),a.rowDropIn=m,a.rowDropDir=n?"bottom":"top",b.tree&&h>q.top+5&&h<q.bottom-5?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),a.rowDroptip.hide(),a.rowDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),a.rowDroptip.show(),a.rowDropInParent=!1);break}-1!=a.rowDropIn&&(a.rowDropIn=-1,a.rowDropInParent=!1,a.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}}},onStopDrag:function(c,d){var e=this.draggingRows;a.rowdragging=!1;for(var f=0;f<e.length;f++){var g=e[f].children;g&&(e=$.grep(e,function(a,b){var c=-1==$.inArray(a,g);return c}))}if(-1!=a.rowDropIn){if(b.tree){var h,i;a.rowDropInParent?i=a.getRow(a.rowDropIn):(h=a.getRow(a.rowDropIn),i=a.getParent(h)),a.appendRange(e,i,h,"bottom"!=a.rowDropDir),a.trigger("rowDragDrop",{rows:e,parent:i,near:h,after:"bottom"==a.rowDropDir})}else a.moveRange(e,a.rowDropIn,"bottom"==a.rowDropDir),a.trigger("rowDragDrop",{rows:e,parent:i,near:a.getRow(a.rowDropIn),after:"bottom"==a.rowDropDir});a.rowDropIn=-1}a.rowDroptip.hide(),this.set("cursor","default")}}))},_onRowOver:function(a,b){if(!l.draggable.dragging){var c=this,d=this.options,e=c.getRow(a),f=b?"addClass":"removeClass";c.enabledFrozen()&&$(c.getRowObj(e,!0))[f](d.mouseoverRowCssClass),$(c.getRowObj(e,!1))[f](d.mouseoverRowCssClass)}},_onMouseUp:function(a){var b=this;this.options;
if(l.draggable.dragging){var c=b._getSrcElementByEvent(a);c.hcell&&c.column?b.trigger("dragdrop",[{type:"header",column:c.column,cell:c.hcell},a]):c.row&&b.trigger("dragdrop",[{type:"row",record:c.data,row:c.row},a])}},_onMouseDown:function(a){this.options},_onContextmenu:function(a){var b=this,c=this.options,d=b._getSrcElementByEvent(a);if(d.row){if(c.whenRClickToSelect&&b.select(d.data),b.hasBind("contextmenu"))return b.trigger("contextmenu",[{data:d.data,rowindex:d.data.__index,row:d.row},a])}else if(d.hcell){if(!c.allowHideColumn)return!0;var e=$(d.hcell).attr("columnindex");if(void 0==e)return!0;var f=a.pageX-b.body.offset().left+parseInt(b.body[0].scrollLeft);return e==b.columns.length-1&&(f-=50),b.popup.css({left:f,top:b.gridheader.height()+1}),b.popup.toggle(),!1}},_onDblClick:function(a){var b=this,c=(this.options,b._getSrcElementByEvent(a));c.row&&b.trigger("dblClickRow",[c.data,c.data.__id,c.row])},_onClick:function(a){var b=(a.target||a.srcElement,this),c=this.options,d=b._getSrcElementByEvent(a);if(d.out)return b.editor.editing&&!$.zoeui.win.masking&&b.endEdit(),void(c.allowHideColumn&&b.popup.hide());if(!d.indetail&&!d.editing)if(b.editor.editing&&(b._onRowOver(b.editor.editParm.record,!1),b.endEdit()),c.allowHideColumn&&(d.popup||b.popup.hide()),d.checkboxall){var e=$(d.hrow),f=e.hasClass("l-checked");if(0==b.trigger("beforeCheckAllRow",[!f,b.element]))return!1;f?e.removeClass("l-checked"):e.addClass("l-checked"),b.selected=[];for(var g in b.records)f?b.unselect(b.records[g]):b.select(b.records[g]);b.trigger("checkAllRow",[!f,b.element])}else if(d.hcelltext){var h=$(d.hcelltext).parent().parent();if(!c.enabledSort||!d.column)return;if(0==d.column.isSort)return;if(c.url&&"local"!=c.dataAction&&b.isDataChanged&&!confirm(c.isContinueByDataChanged))return;var i=$(".l-grid-hd-cell-sort:first",h),j=d.column.name;if(!j)return;i.length>0?i.hasClass("l-grid-hd-cell-sort-asc")?(i.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc"),h.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc"),b.trigger("ChangeSort",[j,"desc"]),b.changeSort(j,"desc")):i.hasClass("l-grid-hd-cell-sort-desc")&&(i.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc"),h.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),b.trigger("ChangeSort",[j,"asc"]),b.changeSort(j,"asc")):(h.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),$(d.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>"),b.trigger("ChangeSort",[j,"asc"]),b.changeSort(j,"asc")),$(".l-grid-hd-cell-sort",b.gridheader).add($(".l-grid-hd-cell-sort",b.f.gridheader)).not($(".l-grid-hd-cell-sort:first",h)).remove()}else if(d.detailbtn&&c.detail&&d.cell||c.detailRowClick&&c.detail&&d.cell){var k=d.data;if(!k)return;var e=$([b.getRowObj(k,!1)]);b.enabledFrozen()&&(e=e.add(b.getRowObj(k,!0)));var g=k.__id;if($(d.detailbtn).hasClass("l-open")||$(e).hasClass("l-open"))c.detail.onCollapse&&c.detail.onCollapse(k,$(".l-grid-detailpanel-inner:first",l)[0]),e.next("tr.l-grid-detailpanel").hide(),$(d.detailbtn).removeClass("l-open"),c.detailRowClick?$(e).removeClass("l-open"):$(d.detailbtn).removeClass("l-open");else{var l=e.next("tr.l-grid-detailpanel");if(l.length>0)return l.show(),c.detail.onExtend&&c.detail.onExtend(k,$(".l-grid-detailpanel-inner:first",l)[0]),c.detailRowClick?(c.isDetailOneShow&&$(".l-open",b.grid).removeClass("l-open").next().hide(),$(e).addClass("l-open")):$(d.detailbtn).addClass("l-open"),void b.trigger("SysGridHeightChanged");c.detailRowClick?(c.isDetailOneShow&&$(".l-open",b.grid).removeClass("l-open").next().hide(),$(e).addClass("l-open")):$(d.detailbtn).addClass("l-open");for(var m=0,n=0;n<b.columns.length;n++)b.columns[n].frozen&&m++;var o=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>"),p=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");o.attr("id",b.id+"|detail|"+g),b.detailrows=b.detailrows||[],b.detailrows.push(o[0]),b.detailrows.push(p[0]);var q=$("div:first",o);q.parent().attr("colSpan",b.columns.length-m),e.eq(0).after(o),m>0&&(p.find("td:first").attr("colSpan",m),e.eq(1).after(p)),c.detail.onShowDetail?(c.detail.onShowDetail(k,q[0],function(){b.trigger("SysGridHeightChanged")}),$("div:first",p).add(q).show().height(c.detail.height||c.detailHeight)):c.detail.render&&(q.append(c.detail.render()),q.show()),b.trigger("SysGridHeightChanged")}}else if(d.groupbtn){var r=$(d.grouprow),s=!0;$(d.groupbtn).hasClass("l-grid-group-togglebtn-close")?($(d.groupbtn).removeClass("l-grid-group-togglebtn-close"),r.hasClass("l-grid-grouprow-last")&&$("td:first",r).width("auto")):(s=!1,$(d.groupbtn).addClass("l-grid-group-togglebtn-close"),r.hasClass("l-grid-grouprow-last")&&$("td:first",r).width(b.gridtablewidth));for(var t=r.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");;){if(0==t.length)break;s?(t.show(),t.hasClass("l-grid-detailpanel")&&!t.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")&&t.hide()):t.hide(),t=t.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}b.trigger(s?"groupExtend":"groupCollapse"),b.trigger("SysGridHeightChanged")}else if(d.treelink)b.toggle(d.data);else if(d.row&&b.enabledCheckbox()){var u=c.selectRowButtonOnly?!0:!1;if(c.enabledEdit&&(u=!0),d.checkbox||!u){var e=$(d.row),f=e.hasClass("l-selected");if(0==b.trigger("beforeCheckRow",[!f,d.data,d.data.__id,d.row]))return!1;var v=f?"unselect":"select";if(b[v](d.data),c.tree&&c.autoCheckChildren)for(var w=b.getChildren(d.data,!0),n=0,x=w.length;x>n;n++)b[v](w[n]);b.trigger("checkRow",[!f,d.data,d.data.__id,d.row])}!d.checkbox&&d.cell&&c.enabledEdit&&c.clickToEdit&&b._applyEditor(d.cell)}else if(d.row&&!b.enabledCheckbox())if(d.cell&&c.enabledEdit&&c.clickToEdit&&b._applyEditor(d.cell),$(d.row).hasClass("l-selected")){if(!c.allowUnSelectRow)return void $(d.row).addClass("l-selected-again");b.unselect(d.data)}else b.select(d.data);else if(d.toolbar)if(d.first){if(0==b.trigger("toFirst",[b.element]))return!1;b.changePage("first")}else if(d.prev){if(0==b.trigger("toPrev",[b.element]))return!1;b.changePage("prev")}else if(d.next){if(0==b.trigger("toNext",[b.element]))return!1;b.changePage("next")}else if(d.last){if(0==b.trigger("toLast",[b.element]))return!1;b.changePage("last")}else if(d.load){if($("span",d.load).hasClass("l-disabled"))return!1;if(0==b.trigger("reload",[b.element]))return!1;if(c.url&&b.isDataChanged&&!confirm(c.isContinueByDataChanged))return!1;b.loadData(c.where)}},select:function(a){var b=this,c=this.options,d=b.getRow(a),e=d.__id,f=b.getRowObj(e);if(c.rowSelectable&&0!=b.trigger("beforeSelectRow",[d,e,f])){var g=b.getRowObj(e,!0);if(!b.enabledCheckbox()&&!b.ctrlKey){for(var h in b.selected){var i=b.selected[h];i.__id in b.records&&($(b.getRowObj(i)).removeClass("l-selected l-selected-again"),b.enabledFrozen()&&$(b.getRowObj(i,!0)).removeClass("l-selected l-selected-again"))}b.selected=[]}f&&$(f).addClass("l-selected"),g&&$(g).addClass("l-selected"),b.selected[b.selected.length]=d,b.trigger("selectRow",[d,e,f])}},unselect:function(a){var b=this,c=(this.options,b.getRow(a)),d=c.__id,e=b.getRowObj(d),f=b.getRowObj(d,!0);$(e).removeClass("l-selected l-selected-again"),b.enabledFrozen()&&$(f).removeClass("l-selected l-selected-again"),b._removeSelected(c),b.trigger("unSelectRow",[c,d,e])},isSelected:function(a){var b=this,c=(this.options,b.getRow(a));for(var d in b.selected)if(b.selected[d]==c)return!0;return!1},arrayToTree:function(a,b,c){function d(a){return"string"==typeof a&&(a=a.replace(/[.]/g,"").toLowerCase()),a}var e=this.options,f="children";if(e.tree&&(f=e.tree.childrenName),!a||!a.length)return[];for(var g=[],h={},i=a.length,j=0;i>j;j++){var k=a[j],l=d(k[b]);h[l]=k}for(var j=0;i>j;j++){var m=a[j],l=d(m[c]),n=h[l];n?(n[f]=n[f]||[],n[f].push(m)):g.push(m)}return g},_onResize:function(){var a=this,b=this.options;if(a._setColumns(),0!=a.rows.length&&(a._fillGridBody(a.rows,!1),b.mouseoverRowCssClass))for(var c in a.rows){var d=$(a.getRowObj(a.rows[c]));a.enabledFrozen()&&(d=d.add(a.getRowObj(a.rows[c],!0))),d.bind("mouseover.gridrow",function(){a._onRowOver(this,!0)}).bind("mouseout.gridrow",function(){a._onRowOver(this,!1)})}if(b.height&&"auto"!=b.height){var e=$(window).height(),f=0,g=null;if("string"==typeof b.height&&b.height.indexOf("%")>0){var h=a.grid.parent();b.inWindow?(g=e,g-=parseInt($("body").css("paddingTop")),g-=parseInt($("body").css("paddingBottom"))):g=h.height(),f=g*parseInt(b.height)*.01,(b.inWindow||"body"==h[0].tagName.toLowerCase())&&(f-=a.grid.offset().top-parseInt($("body").css("paddingTop")))}else f=parseInt(b.height);f+=b.heightDiff,a.windowHeight=e,a._setHeight(f)}else a._updateHorizontalScrollStatus.zoeDefer(a,10);if(a.enabledFrozen()){var i=a.gridview1.width(),j=a.gridview.width();a.gridview2.css({width:j-i})}a.trigger("SysGridHeightChanged")},showFilter:function(){function a(){var a=[];return $(e.columns).each(function(){var b={name:this.name,display:this.display},c="int"==this.type||"number"==this.type||"float"==this.type,d="date"==this.type;c&&(b.type="number"),d&&(b.type="date"),this.editor&&(b.editor=this.editor),a.push(b)}),a}function b(){var a=g.getData();"server"==e.options.dataType?c(a):d(a)}function c(a){a&&a.rules&&a.rules.length?e.setParm("where",JSON.stringify(a)):e.removeParm("where"),e.loadData()}function d(a){e.loadData($.zoeFilter.getFilterFunction(a))}var e=this;this.options;if(e.winfilter)return void e.winfilter.show();var f=$('<div id="'+e.id+'_filtercontainer"></div>').width(380).height(120).hide(),g=f.zoeFilter({fields:a()});return g.addRule($(g.element.firstChild)),e.winfilter=$.zoeDialog.open({width:420,height:208,target:f,isResize:!0,top:50,buttons:[{text:"确定",onclick:function(a,c){b(),c.hide()}},{text:"取消",onclick:function(a,b){b.hide()}}]})}}),$.zoeui.controls.Grid.prototype.enabledTotal=$.zoeui.controls.Grid.prototype.isTotalSummary,$.zoeui.controls.Grid.prototype.add=$.zoeui.controls.Grid.prototype.addRow,$.zoeui.controls.Grid.prototype.update=$.zoeui.controls.Grid.prototype.updateRow,$.zoeui.controls.Grid.prototype.append=$.zoeui.controls.Grid.prototype.appendRow,$.zoeui.controls.Grid.prototype.getSelected=$.zoeui.controls.Grid.prototype.getSelectedRow,$.zoeui.controls.Grid.prototype.getSelecteds=$.zoeui.controls.Grid.prototype.getSelectedRows,$.zoeui.controls.Grid.prototype.getCheckedRows=$.zoeui.controls.Grid.prototype.getSelectedRows,$.zoeui.controls.Grid.prototype.getCheckedRowObjs=$.zoeui.controls.Grid.prototype.getSelectedRowObjs,$.zoeui.controls.Grid.prototype.setOptions=$.zoeui.controls.Grid.prototype.set,$.zoeui.controls.Grid.prototype.reload=$.zoeui.controls.Grid.prototype.loadData,$.zoeui.controls.Grid.prototype.refreshSize=$.zoeui.controls.Grid.prototype._onResize}(jQuery),function(a){a.fn.zoeLayout=function(b){return a.zoeui.run.call(this,"zoeLayout",arguments)},a.fn.zoeGetLayoutManager=function(){return a.zoeui.run.call(this,"zoeGetLayoutManager",arguments)},a.zoeDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,centerBottomHeight:100,allowCenterBottomResize:!0,inWindow:!0,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:!1,isRightCollapse:!1,allowLeftCollapse:!0,allowRightCollapse:!0,allowLeftResize:!0,allowRightResize:!0,allowTopResize:!0,allowBottomResize:!0,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80},a.zoeMethos.Layout={},a.zoeui.controls.Layout=function(b,c){a.zoeui.controls.Layout.base.constructor.call(this,b,c)},a.zoeui.controls.Layout.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return a.zoeMethos.Layout},_init:function(){a.zoeui.controls.Layout.base._init.call(this);var b=this.options;null!=b.InWindow&&null==b.inWindow&&(b.inWindow=b.InWindow)},_render:function(){var b=this,c=this.options;if(b.layout=a(this.element),b.layout.addClass("l-layout"),b.width=b.layout.width(),a("> div[position=top]",b.layout).length>0&&(b.top=a("> div[position=top]",b.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent(),b.top.content=a("> div[position=top]",b.top),b.top.content.hasClass("l-layout-content")||b.top.content.addClass("l-layout-content"),b.topHeight=c.topHeight,b.topHeight&&b.top.height(b.topHeight)),a("> div[position=bottom]",b.layout).length>0){b.bottom=a("> div[position=bottom]",b.layout).wrap('<div class="l-layout-bottom"></div>').parent(),b.bottom.content=a("> div[position=bottom]",b.bottom),b.bottom.content.hasClass("l-layout-content")||b.bottom.content.addClass("l-layout-content"),b.bottomHeight=c.bottomHeight,b.bottomHeight&&b.bottom.height(b.bottomHeight);var d=b.bottom.content.attr("title");d&&(b.bottom.header=a('<div class="l-layout-header"></div>'),b.bottom.prepend(b.bottom.header),b.bottom.header.html(d),b.bottom.content.attr("title",""))}if(a("> div[position=left]",b.layout).length>0){b.left=a("> div[position=left]",b.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent(),b.left.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),b.left.prepend(b.left.header),b.left.header.toggle=a(".l-layout-header-toggle",b.left.header),b.left.content=a("> div[position=left]",b.left),b.left.content.hasClass("l-layout-content")||b.left.content.addClass("l-layout-content"),c.allowLeftCollapse||a(".l-layout-header-toggle",b.left.header).remove();var e=b.left.content.attr("title");e&&(b.left.content.attr("title",""),a(".l-layout-header-inner",b.left.header).html(e)),b.left.content.attr("hidetitle")&&(b.left.content.attr("title",""),b.left.header.remove()),b.leftWidth=c.leftWidth,b.leftWidth&&b.left.width(b.leftWidth)}if(a("> div[position=center]",b.layout).length>0){b.center=a("> div[position=center]",b.layout).wrap('<div class="l-layout-center" ></div>').parent(),b.center.content=a("> div[position=center]",b.center),b.center.content.addClass("l-layout-content");var f=b.center.content.attr("title");if(f&&(b.center.content.attr("title",""),b.center.header=a('<div class="l-layout-header"></div>'),b.center.prepend(b.center.header),b.center.header.html(f)),b.center.content.attr("hidetitle")&&(b.center.content.attr("title",""),b.center.header.remove()),b.centerWidth=c.centerWidth,b.centerWidth&&b.center.width(b.centerWidth),a("> div[position=centerbottom]",b.layout).length>0){b.centerBottom=a("> div[position=centerbottom]",b.layout).wrap('<div class="l-layout-centerbottom" ></div>').parent(),b.centerBottom.content=a("> div[position=centerbottom]",b.centerBottom),b.centerBottom.content.addClass("l-layout-content");var f=b.centerBottom.content.attr("title");f&&(b.centerBottom.content.attr("title",""),b.centerBottom.header=a('<div class="l-layout-header"></div>'),b.centerBottom.prepend(b.centerBottom.header),b.centerBottom.header.html(f)),b.centerBottom.content.attr("hidetitle")&&(b.centerBottom.content.attr("title",""),b.centerBottom.header&&b.centerBottom.header.remove()),b.centerWidth&&b.centerBottom.width(b.centerWidth)}}if(a("> div[position=right]",b.layout).length>0){b.right=a("> div[position=right]",b.layout).wrap('<div class="l-layout-right"></div>').parent(),b.right.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),b.right.prepend(b.right.header),b.right.header.toggle=a(".l-layout-header-toggle",b.right.header),c.allowRightCollapse||a(".l-layout-header-toggle",b.right.header).remove(),b.right.content=a("> div[position=right]",b.right),b.right.content.hasClass("l-layout-content")||b.right.content.addClass("l-layout-content");var g=b.right.content.attr("title");g&&(b.right.content.attr("title",""),a(".l-layout-header-inner",b.right.header).html(g)),b.right.content.attr("hidetitle")&&(b.right.content.attr("title",""),b.right.header.remove()),b.rightWidth=c.rightWidth,b.rightWidth&&b.right.width(b.rightWidth)}b.layout.lock=a("<div class='l-layout-lock'></div>"),b.layout.append(b.layout.lock),b._addDropHandle(),b.isLeftCollapse=c.isLeftCollapse,b.isRightCollapse=c.isRightCollapse,b.leftCollapse=a('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>'),b.rightCollapse=a('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>'),b.layout.append(b.leftCollapse).append(b.rightCollapse),b.leftCollapse.toggle=a("> .l-layout-collapse-left-toggle",b.leftCollapse),b.rightCollapse.toggle=a("> .l-layout-collapse-right-toggle",b.rightCollapse),b._setCollapse(),b._bulid(),a(window).resize(function(){b._onResize()}),b.set(c),b.mask.height(b.layout.height())},setLeftCollapse:function(a){var b=this;this.options;return b.left?(b.isLeftCollapse=a,b.isLeftCollapse?(b.leftCollapse.show(),b.leftDropHandle&&b.leftDropHandle.hide(),b.left.hide()):(b.leftCollapse.hide(),b.leftDropHandle&&b.leftDropHandle.show(),b.left.show()),void b._onResize()):!1},setRightCollapse:function(a){var b=this;this.options;return b.right?(b.isRightCollapse=a,b._onResize(),b.isRightCollapse?(b.rightCollapse.show(),b.rightDropHandle&&b.rightDropHandle.hide(),b.right.hide()):(b.rightCollapse.hide(),b.rightDropHandle&&b.rightDropHandle.show(),b.right.show()),void b._onResize()):!1},_bulid:function(){var b=this,c=this.options;a("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",b.layout).hover(function(){a(this).addClass("l-layout-header-over")},function(){a(this).removeClass("l-layout-header-over")}),a(".l-layout-header-toggle",b.layout).hover(function(){a(this).addClass("l-layout-header-toggle-over")},function(){a(this).removeClass("l-layout-header-toggle-over")}),a(".l-layout-header-toggle",b.left).click(function(){b.setLeftCollapse(!0)}),a(".l-layout-header-toggle",b.right).click(function(){b.setRightCollapse(!0)}),b.middleTop=0,b.top&&(b.middleTop+=b.top.height(),b.middleTop+=parseInt(b.top.css("borderTopWidth")),b.middleTop+=parseInt(b.top.css("borderBottomWidth")),b.middleTop+=c.space),b.left&&(b.left.css({top:b.middleTop}),b.leftCollapse.css({top:b.middleTop})),b.center&&b.center.css({top:b.middleTop}),b.right&&(b.right.css({top:b.middleTop}),b.rightCollapse.css({top:b.middleTop})),b.left&&b.left.css({left:0}),b._onResize(),b._onResize()},_setCollapse:function(){var b=this;this.options;b.leftCollapse.hover(function(){a(this).addClass("l-layout-collapse-left-over")},function(){a(this).removeClass("l-layout-collapse-left-over")}),b.leftCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-left-toggle-over")},function(){a(this).removeClass("l-layout-collapse-left-toggle-over")}),b.rightCollapse.hover(function(){a(this).addClass("l-layout-collapse-right-over")},function(){a(this).removeClass("l-layout-collapse-right-over")}),b.rightCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-right-toggle-over")},function(){a(this).removeClass("l-layout-collapse-right-toggle-over")}),b.leftCollapse.toggle.click(function(){b.setLeftCollapse(!1)}),b.rightCollapse.toggle.click(function(){b.setRightCollapse(!1)}),b.left&&b.isLeftCollapse&&(b.leftCollapse.show(),b.leftDropHandle&&b.leftDropHandle.hide(),b.left.hide()),b.right&&b.isRightCollapse&&(b.rightCollapse.show(),b.rightDropHandle&&b.rightDropHandle.hide(),b.right.hide())},_addDropHandle:function(){var b=this,c=this.options;b.left&&c.allowLeftResize&&(b.leftDropHandle=a("<div class='l-layout-drophandle-left'></div>"),b.layout.append(b.leftDropHandle),b.leftDropHandle&&b.leftDropHandle.show(),b.leftDropHandle.mousedown(function(a){b._start("leftresize",a)})),b.right&&c.allowRightResize&&(b.rightDropHandle=a("<div class='l-layout-drophandle-right'></div>"),b.layout.append(b.rightDropHandle),b.rightDropHandle&&b.rightDropHandle.show(),b.rightDropHandle.mousedown(function(a){b._start("rightresize",a)})),b.top&&c.allowTopResize&&(b.topDropHandle=a("<div class='l-layout-drophandle-top'></div>"),b.layout.append(b.topDropHandle),b.topDropHandle.show(),b.topDropHandle.mousedown(function(a){b._start("topresize",a)})),b.bottom&&c.allowBottomResize&&(b.bottomDropHandle=a("<div class='l-layout-drophandle-bottom'></div>"),b.layout.append(b.bottomDropHandle),b.bottomDropHandle.show(),b.bottomDropHandle.mousedown(function(a){b._start("bottomresize",a)})),b.centerBottom&&c.allowCenterBottomResize&&(b.centerBottomDropHandle=a("<div class='l-layout-drophandle-centerbottom'></div>"),b.layout.append(b.centerBottomDropHandle),b.centerBottomDropHandle.show(),b.centerBottomDropHandle.mousedown(function(a){b._start("centerbottomresize",a)})),b.draggingxline=a("<div class='l-layout-dragging-xline'></div>"),b.draggingyline=a("<div class='l-layout-dragging-yline'></div>"),b.mask=a("<div class='l-dragging-mask'></div>"),b.layout.append(b.draggingxline).append(b.draggingyline).append(b.mask)},_setDropHandlePosition:function(){var a=this,b=this.options;a.leftDropHandle&&a.leftDropHandle.css({left:a.left.width()+parseInt(a.left.css("left")),height:a.middleHeight,top:a.middleTop}),a.rightDropHandle&&a.rightDropHandle.css({left:parseInt(a.right.css("left"))-b.space,height:a.middleHeight,top:a.middleTop}),a.topDropHandle&&a.topDropHandle.css({top:a.top.height()+parseInt(a.top.css("top")),width:a.top.width()}),a.bottomDropHandle&&a.bottomDropHandle.css({top:parseInt(a.bottom.css("top"))-b.space,width:a.bottom.width()}),a.centerBottomDropHandle&&a.centerBottomDropHandle.css({top:parseInt(a.centerBottom.css("top"))-b.space,left:parseInt(a.center.css("left")),width:a.center.width()})},_onResize:function(){var b=this,c=this.options,d=b.layout.height(),e=0,f=a(window).height(),g=null;if("string"==typeof c.height&&c.height.indexOf("%")>0){var h=b.layout.parent();c.inWindow||"body"==h[0].tagName.toLowerCase()?(g=f,g-=parseInt(a("body").css("paddingTop")),g-=parseInt(a("body").css("paddingBottom"))):g=h.height(),e=g*parseFloat(c.height)*.01,(c.inWindow||"body"==h[0].tagName.toLowerCase())&&(e-=b.layout.offset().top-parseInt(a("body").css("paddingTop")))}else e=parseInt(c.height);if(e+=c.heightDiff,b.layout.height(e),b.layoutHeight=b.layout.height(),b.middleWidth=b.layout.width(),b.middleHeight=b.layout.height(),b.top&&(b.middleHeight-=b.top.height(),b.middleHeight-=parseInt(b.top.css("borderTopWidth")),b.middleHeight-=parseInt(b.top.css("borderBottomWidth")),b.middleHeight-=c.space),b.bottom&&(b.middleHeight-=b.bottom.height(),b.middleHeight-=parseInt(b.bottom.css("borderTopWidth")),b.middleHeight-=parseInt(b.bottom.css("borderBottomWidth")),b.middleHeight-=c.space),b.middleHeight-=2,b.hasBind("heightChanged")&&b.layoutHeight!=d&&b.trigger("heightChanged",[{layoutHeight:b.layoutHeight,diff:b.layoutHeight-d,middleHeight:b.middleHeight}]),b.center){b.centerWidth=b.middleWidth,b.left&&(b.isLeftCollapse?(b.centerWidth-=b.leftCollapse.width(),b.centerWidth-=parseInt(b.leftCollapse.css("borderLeftWidth")),b.centerWidth-=parseInt(b.leftCollapse.css("borderRightWidth")),b.centerWidth-=parseInt(b.leftCollapse.css("left")),b.centerWidth-=c.space):(b.centerWidth-=b.leftWidth,b.centerWidth-=parseInt(b.left.css("borderLeftWidth")),b.centerWidth-=parseInt(b.left.css("borderRightWidth")),b.centerWidth-=parseInt(b.left.css("left")),b.centerWidth-=c.space)),b.right&&(b.isRightCollapse?(b.centerWidth-=b.rightCollapse.width(),b.centerWidth-=parseInt(b.rightCollapse.css("borderLeftWidth")),b.centerWidth-=parseInt(b.rightCollapse.css("borderRightWidth")),b.centerWidth-=parseInt(b.rightCollapse.css("right")),b.centerWidth-=c.space):(b.centerWidth-=b.rightWidth,b.centerWidth-=parseInt(b.right.css("borderLeftWidth")),b.centerWidth-=parseInt(b.right.css("borderRightWidth")),b.centerWidth-=c.space)),b.centerLeft=0,b.left&&(b.isLeftCollapse?(b.centerLeft+=b.leftCollapse.width(),b.centerLeft+=parseInt(b.leftCollapse.css("borderLeftWidth")),b.centerLeft+=parseInt(b.leftCollapse.css("borderRightWidth")),b.centerLeft+=parseInt(b.leftCollapse.css("left")),b.centerLeft+=c.space):(b.centerLeft+=b.left.width(),b.centerLeft+=parseInt(b.left.css("borderLeftWidth")),b.centerLeft+=parseInt(b.left.css("borderRightWidth")),b.centerLeft+=c.space)),b.center.css({left:b.centerLeft}),b.centerWidth>=0&&b.center.width(b.centerWidth),b.middleHeight>=0&&b.center.height(b.middleHeight);var i=b.middleHeight;b.center.header&&(i-=b.center.header.height()),i>=0&&b.center.content.height(i),b._updateCenterBottom(!0)}b.left&&(b.leftCollapse.height(b.middleHeight),b.left.height(b.middleHeight)),b.right&&(b.rightCollapse.height(b.middleHeight),b.right.height(b.middleHeight),b.rightLeft=0,b.left&&(b.isLeftCollapse?(b.rightLeft+=b.leftCollapse.width(),b.rightLeft+=parseInt(b.leftCollapse.css("borderLeftWidth")),b.rightLeft+=parseInt(b.leftCollapse.css("borderRightWidth")),b.rightLeft+=c.space):(b.rightLeft+=b.left.width(),b.rightLeft+=parseInt(b.left.css("borderLeftWidth")),b.rightLeft+=parseInt(b.left.css("borderRightWidth")),b.rightLeft+=parseInt(b.left.css("left")),b.rightLeft+=c.space)),b.center&&(b.rightLeft+=b.center.width(),b.rightLeft+=parseInt(b.center.css("borderLeftWidth")),b.rightLeft+=parseInt(b.center.css("borderRightWidth")),b.rightLeft+=c.space),b.right.css({left:b.rightLeft})),b.bottom&&(b.bottomTop=b.layoutHeight-b.bottom.height()-2,b.bottom.css({top:b.bottomTop})),b._setDropHandlePosition()},_updateCenterBottom:function(a){var b=this,c=this.options;if(b.centerBottom){if(a){var d=b.centerBottomHeight||c.centerBottomHeight;b.centerBottom.css({left:b.centerLeft}),b.centerWidth>=0&&b.centerBottom.width(b.centerWidth);var e=b.center.height(),f=parseInt(b.center.css("top"));b.centerBottom.height(d),b.centerBottom.css({top:f+e-d+2}),b.center.height(e-d-2)}var g=parseInt(b.center.css("left"));b.centerBottom.width(b.center.width()).css({left:g})}},_start:function(b,c){var d=this;this.options;if(d.dragtype=b,"leftresize"==b||"rightresize"==b)d.xresize={startX:c.pageX},d.draggingyline.css({left:c.pageX-d.layout.offset().left,height:d.middleHeight,top:d.middleTop}).show(),a("body").css("cursor","col-resize"),d.mask.height(d.layout.height()).removeClass("l-layout-ymask").addClass("l-layout-xmask").show();else if("topresize"==b||"bottomresize"==b)d.yresize={startY:c.pageY},d.draggingxline.css({top:c.pageY-d.layout.offset().top,width:d.layout.width()}).show(),a("body").css("cursor","row-resize"),d.mask.height(d.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show();else{if("centerbottomresize"!=b)return;d.yresize={startY:c.pageY},d.draggingxline.css({top:c.pageY-d.layout.offset().top,width:d.layout.width()}).show(),a("body").css("cursor","row-resize"),d.mask.height(d.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show()}d.layout.lock.width(d.layout.width()),d.layout.lock.height(d.layout.height()),d.layout.lock.show(),(a.browser.msie||a.browser.safari)&&a("body").bind("selectstart",function(){return!1}),a(document).bind("mouseup",function(){d._stop.apply(d,arguments)}),a(document).bind("mousemove",function(){d._drag.apply(d,arguments)})},_drag:function(b){var c=this;this.options;c.xresize?(c.xresize.diff=b.pageX-c.xresize.startX,c.draggingyline.css({left:b.pageX-c.layout.offset().left}),a("body").css("cursor","col-resize")):c.yresize&&(c.yresize.diff=b.pageY-c.yresize.startY,c.draggingxline.css({top:b.pageY-c.layout.offset().top}),a("body").css("cursor","row-resize"))},_stop:function(b){var c,d=this,e=this.options;if(d.xresize&&void 0!=d.xresize.diff){if(c=d.xresize.diff,"leftresize"==d.dragtype){if(e.minLeftWidth&&d.leftWidth+d.xresize.diff<e.minLeftWidth)return;d.leftWidth+=d.xresize.diff,d.left.width(d.leftWidth),d.center?d.center.width(d.center.width()-d.xresize.diff).css({left:parseInt(d.center.css("left"))+d.xresize.diff}):d.right&&d.right.width(d.left.width()-d.xresize.diff).css({left:parseInt(d.right.css("left"))+d.xresize.diff})}else if("rightresize"==d.dragtype){if(e.minRightWidth&&d.rightWidth-d.xresize.diff<e.minRightWidth)return;d.rightWidth-=d.xresize.diff,d.right.width(d.rightWidth).css({left:parseInt(d.right.css("left"))+d.xresize.diff}),d.center?d.center.width(d.center.width()+d.xresize.diff):d.left&&d.left.width(d.left.width()+d.xresize.diff)}d._updateCenterBottom()}else if(d.yresize&&void 0!=d.yresize.diff)if(c=d.yresize.diff,"topresize"==d.dragtype)d.top.height(d.top.height()+d.yresize.diff),d.middleTop+=d.yresize.diff,d.middleHeight-=d.yresize.diff,d.left&&(d.left.css({top:d.middleTop}).height(d.middleHeight),d.leftCollapse.css({top:d.middleTop}).height(d.middleHeight)),d.center&&d.center.css({top:d.middleTop}).height(d.middleHeight),d.right&&(d.right.css({top:d.middleTop}).height(d.middleHeight),d.rightCollapse.css({top:d.middleTop}).height(d.middleHeight)),d._updateCenterBottom(!0);else if("bottomresize"==d.dragtype)d.bottom.height(d.bottom.height()-d.yresize.diff),d.middleHeight+=d.yresize.diff,d.bottomTop+=d.yresize.diff,d.bottom.css({top:d.bottomTop}),d.left&&(d.left.height(d.middleHeight),d.leftCollapse.height(d.middleHeight)),d.center&&d.center.height(d.middleHeight),d.right&&(d.right.height(d.middleHeight),d.rightCollapse.height(d.middleHeight)),d._updateCenterBottom(!0);else if("centerbottomresize"==d.dragtype){d.centerBottomHeight=d.centerBottomHeight||e.centerBottomHeight,d.centerBottomHeight-=d.yresize.diff;var f=parseInt(d.centerBottom.css("top"));d.centerBottom.css("top",f+d.yresize.diff),d.centerBottom.height(d.centerBottom.height()-d.yresize.diff),d.center.height(d.center.height()+d.yresize.diff)}d.trigger("endResize",[{direction:d.dragtype?d.dragtype.replace(/resize/,""):"",diff:c},b]),d._setDropHandlePosition(),d.draggingxline.hide(),d.draggingyline.hide(),d.mask.hide(),d.xresize=d.yresize=d.dragtype=!1,d.layout.lock.hide(),(a.browser.msie||a.browser.safari)&&a("body").unbind("selectstart"),a(document).unbind("mousemove",d._drag),a(document).unbind("mouseup",d._stop),a("body").css("cursor","")}})}(jQuery),function(a){a.fn.zoeListBox=function(b){return a.zoeui.run.call(this,"zoeListBox",arguments)},a.fn.zoeGetListBoxManager=function(){return a.zoeui.run.call(this,"zoeGetListBoxManager",arguments)},a.zoeDefaults.ListBox={isMultiSelect:!1,isShowCheckBox:!1,columns:null,width:150,height:100,onSelect:!1,onSelected:null,valueField:"id",textField:"text",valueFieldID:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,render:null,css:null,value:null,valueFieldCssClass:null},a.zoeMethos.ListBox=a.zoeMethos.ListBox||{},a.zoeui.controls.ListBox=function(b,c){a.zoeui.controls.ListBox.base.constructor.call(this,b,c)},a.zoeui.controls.ListBox.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"ListBox"},_extendMethods:function(){return a.zoeMethos.ListBox},_init:function(){a.zoeui.controls.ListBox.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data,b.valueField=null,c.valueFieldID?(b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input"),0==b.valueField.length&&(b.valueField=a('<input type="hidden"/>')),b.valueField[0].id=b.valueField[0].name=c.valueFieldID):(b.valueField=a('<input type="hidden"/>'),b.valueField[0].id=b.valueField[0].name=b.id+"_val"),null==b.valueField[0].name&&(b.valueField[0].name=b.valueField[0].id),c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass),b.valueField.attr("data-zoeid",b.id),b.selectBox=a(this.element),b.selectBox.html('<div class="l-listbox-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-listbox-table"></table></div>').addClass("l-listbox").append(b.valueField),b.selectBox.table=a("table:first",b.selectBox),b.set(c),b._addClickEven()},destroy:function(){this.selectBox&&this.selectBox.remove(),this.options=null,a.zoeui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setIsShowCheckBox:function(b){b?a("table",this.selectBox).addClass("l-table-checkbox"):a("table",this.selectBox).addClass("l-table-nocheckbox");
},_setCss:function(a){a&&this.selectBox.addClass(a)},_setDisabled:function(a){a?this.selectBox.addClass("l-text-disabled"):this.selectBox.removeClass("l-text-disabled")},_setWidth:function(a){this.selectBox.width(a)},_setHeight:function(a){this.selectBox.height(a)},findTextByValue:function(b){var c=this,d=this.options;if(null==b)return"";var e="",f=function(a){for(var c=b.toString().split(d.split),e=0;e<c.length;e++)if(c[e]==a)return!0;return!1};return a(c.data).each(function(a,b){var c=b[d.valueField],g=b[d.textField];f(c)&&(e+=g+d.split)}),e.length>0&&(e=e.substr(0,e.length-1)),e},getDataByValue:function(a){for(var b=this,c=this.options,d=0,e=b.data.length;e>d;d++)if(b.data[d][c.valueField]==a)return b.data[d];return null},indexOf:function(a){var b=this,c=this.options;if(!b.data)return-1;for(var d="object"==typeof a,e=0,f=b.data.length;f>e;e++)if(d){if(b.data[e]==a)return e}else if(b.data[e][c.valueField]&&b.data[e][c.valueField].toString()==a.toString())return e;return-1},removeItems:function(b){var c=this;c.data&&(a(b).each(function(a,b){var d=c.indexOf(b);-1!=d&&c.data.splice(d,1)}),c.refresh())},removeItem:function(a){if(this.data){var b=this.indexOf(a);-1!=b&&(this.data.splice(b,1),this.refresh())}},insertItem:function(a,b){var c=this;c.data||(c.data=[]),c.data.splice(b,0,a),c.refresh()},addItems:function(b){var c=this;c.data||(c.data=[]),a(b).each(function(a,b){c.data.push(b)}),c.refresh()},addItem:function(a){var b=this;b.data||(b.data=[]),b.data.push(a),b.refresh()},getSelectedItems:function(){var b=this,c=this.options;if(!b.data)return null;var d=b.getValue();if(!d)return null;var e=[];return a(d.split(c.split)).each(function(){var a=b.indexOf(this.toString());-1!=a&&e.push(b.data[a])}),e},_setValue:function(a){var b=this.options;b.value=a,this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(b){if(b){var c=this,d=this.options;a.ajax({type:"post",url:b,data:d.parms,cache:!1,dataType:"json",success:function(a){c.setData(a),c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var c=this,d=c.get("parms");d||(d={}),d[a]=b,c.set("parms",d)}},clearContent:function(){var b=this;this.options;a("table",b.selectBox).html("")},_setColumns:function(a){var b=this,c=this.options;c.columns=a,b.refresh()},_setData:function(a){this.setData(a)},setData:function(a){var b=this;this.options;a&&a.length&&(b.data=a,b.refresh(),b.updateStyle())},refresh:function(){var b=this,c=this.options,d=this.data;if(this.clearContent(),d){if(c.columns){b.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px' class='l-checkboxrow'></td></tr>"),b.selectBox.table.append(b.selectBox.table.headrow),b.selectBox.table.addClass("l-listbox-grid");for(var e=0;e<c.columns.length;e++){var f=a("<td columnindex='"+e+"' columnname='"+c.columns[e].name+"'>"+c.columns[e].header+"</td>");c.columns[e].width&&f.width(c.columns[e].width),b.selectBox.table.headrow.append(f)}}for(var g=[],h=0;h<d.length;h++){var i=d[h][c.valueField],j=d[h][c.textField],k=" value='"+i+"' index='"+h+"'";if(c.columns){g.push("<tr "+k+"><td style='width:18px;' class='l-checkboxrow'><input type='checkbox' "+k+"/></td>");for(var e=0;e<c.columns.length;e++){var l=c.columns[e].name;g.push("<td>"+d[h][l]+"</td>")}g.push("</tr>")}else{g.push("<tr "+k+">"),g.push("<td style='width:18px;' class='l-checkboxrow'><input type='checkbox'"+k+"/></td>");var m=j;c.render&&(m=c.render({data:d[h],value:i,text:j})),g.push("<td align='left'>"+m+"</td></tr>")}}b.selectBox.table.append(g.join(""))}},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},selectAll:function(){var b=this,c=this.options,d=[];a("tr",b.selectBox).each(function(){var b=a(this);d.push(b.attr("value"))}),a("tr",b.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0}),b.valueField.val(d.join(c.split))},_dataInit:function(){var b=this,c=this.options,d=c.value;null!=d?b._changeValue(d):""!=b.valueField.val()&&(c.value=b.valueField.val());var e=(d||"").toString().split(c.split);a("tr.l-selected",b.selectBox).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1}),a(e).each(function(c,d){a("tr[value='"+d+"']",b.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0})})},_changeValue:function(a){var b=this;this.options;b.valueField.val(a),b.selectedValue=a},_updateValue:function(){var b=this,c=this.options,d=[];a("tr",b.selectBox).each(function(){var b=a(this);b.hasClass("l-selected")&&d.push(b.attr("value"))}),b._changeValue(d.join(c.split))},_addClickEven:function(){var b=this,c=this.options;b.selectBox.click(function(d){var e=d.target||d.srcElement,f=a(e).parents("tr:first");if(f.length){var g=f.attr("value"),h=b.findTextByValue(g),i=b.getDataByValue(g);if(b.hasBind("select")&&0==b.trigger("select",[g,h,i]))return!1;c.isMultiSelect||a("tr.l-selected",b.selectBox).not(f).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1}),f.hasClass("l-selected")?f.removeClass("l-selected"):f.addClass("l-selected"),f.find(":checkbox").each(function(){this.checked=f.hasClass("l-selected")}),b._updateValue(),b.trigger("selected",[g,h,i])}})}})}(jQuery),function(a){a.zoeMenu=function(b){return a.zoeui.run.call(null,"zoeMenu",arguments)},a.fn.zoeGetMenuManager=function(){return a.zoeui.run.call(this,"zoeGetMenuManager",arguments)},a.zoeDefaults.Menu={width:120,top:0,left:0,items:null,shadow:!0},a.zoeMethos.Menu={},a.zoeui.controls.Menu=function(b){a.zoeui.controls.Menu.base.constructor.call(this,null,b)},a.zoeui.controls.Menu.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return a.zoeMethos.Menu},_render:function(){var b=this,c=this.options;b.menuItemCount=0,b.menus={},b.menu=b.createMenu(),b.element=b.menu[0],b.menu.css({top:c.top,left:c.left,width:c.width}),c.items&&a(c.items).each(function(a,c){b.addItem(c)}),a(document).bind("click.menu",function(){for(var c in b.menus){var d=b.menus[c];if(!d)return;d.hide(),a(".l-menu-over").css({top:-24}),a(".l-menu-item").removeClass("l-menu-item-over"),d.shadow&&d.shadow.hide()}}),b.set(c)},show:function(a,b){var c=this;this.options;void 0==b&&(b=c.menu),a&&void 0!=a.left&&b.css({left:a.left}),a&&void 0!=a.top&&b.css({top:a.top}),b.show(),c.updateShadow(b)},updateShadow:function(a){var b=this.options;b.shadow&&(a.shadow.css({left:a.css("left"),top:a.css("top"),width:a.outerWidth(),height:a.outerHeight()}),a.is(":visible")?a.shadow.show():a.shadow.hide())},hide:function(a){var b=this;this.options;void 0==a&&(a=b.menu),b.hideAllSubMenu(a),a.hide(),b.updateShadow(a)},toggle:function(){var a=this;this.options;a.menu.toggle(),a.updateShadow(a.menu)},removeItem:function(b){var c=this;this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).remove()},setEnabled:function(b){var c=this;this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).removeClass("l-menu-item-disable")},setMenuText:function(b,c){var d=this;this.options;a("> .l-menu-item[menuitemid="+b+"] >.l-menu-item-text:first",d.menu.items).html(c)},setDisabled:function(b){var c=this;this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).addClass("l-menu-item-disable")},isEnable:function(b){var c=this;this.options;return!a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var b=this;this.options;return a("> .l-menu-item",b.menu.items).length},addItem:function(b,c){var d=this,e=this.options;if(b){if(void 0==c&&(c=d.menu),b.line)return void c.items.append('<div class="l-menu-item-line"></div>');var f=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>'),g=a("> .l-menu-item",c.items).length;if(c.items.append(f),f.attr("zoeuimenutemid",++d.menuItemCount),b.id&&f.attr("menuitemid",b.id),b.text&&a(">.l-menu-item-text:first",f).html(b.text),b.icon&&f.prepend('<div class="l-menu-item-icon l-icon-'+b.icon+'"></div>'),b.img&&f.prepend('<div class="l-menu-item-icon"><img style="width:16px;height:16px;margin:2px;" src="'+b.img+'" /></div>'),(b.disable||b.disabled)&&f.addClass("l-menu-item-disable"),b.children){f.append('<div class="l-menu-item-arrow"></div>');var h=d.createMenu(f.attr("zoeuimenutemid"));d.menus[f.attr("zoeuimenutemid")]=h,h.width(e.width),h.hover(null,function(){h.showedSubMenu||d.hide(h)}),a(b.children).each(function(){d.addItem(this,h)})}b.click&&f.click(function(){a(this).hasClass("l-menu-item-disable")||b.click(b,g)}),b.dblclick&&f.dblclick(function(){a(this).hasClass("l-menu-item-disable")||b.dblclick(b,g)});var i=a("> .l-menu-over:first",c);f.hover(function(){if(!a(this).hasClass("l-menu-item-disable")){var e=a(this).offset().top,f=e-c.offset().top;if(i.css({top:f}),a(this).siblings().removeClass("l-menu-item-over"),a(this).addClass("l-menu-item-over"),d.hideAllSubMenu(c),b.children){var g=a(this).attr("zoeuimenutemid");if(!g)return;d.menus[g]&&(d.show({top:e,left:a(this).offset().left+a(this).width()-5},d.menus[g]),c.showedSubMenu=!0)}}},function(){if(!a(this).hasClass("l-menu-item-disable")){var c=a(this).attr("zoeuimenutemid");if(b.children){var c=a(this).attr("zoeuimenutemid");if(!c)return}else a(this).removeClass("l-menu-item-over")}})}},hideAllSubMenu:function(b){var c=this;this.options;void 0==b&&(b=c.menu),a("> .l-menu-item",b.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var b=a(this).attr("zoeuimenutemid");if(!b)return;c.menus[b]&&c.hide(c.menus[b])}}),b.showedSubMenu=!1},createMenu:function(b){var c=this,d=this.options,e=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');return b&&e.attr("zoeuiparentmenuitemid",b),e.items=a("> .l-menu-inner:first",e),e.appendTo("body"),d.shadow&&(e.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(e),c.updateShadow(e)),e.hover(null,function(){e.showedSubMenu||a("> .l-menu-over:first",e).css({top:-24})}),b?c.menus[b]=e:c.menus[0]=e,e}}),a.zoeui.controls.Menu.prototype.setEnable=a.zoeui.controls.Menu.prototype.setEnabled,a.zoeui.controls.Menu.prototype.setDisable=a.zoeui.controls.Menu.prototype.setDisabled}(jQuery),function(a){a.fn.zoeMenuBar=function(b){return a.zoeui.run.call(this,"zoeMenuBar",arguments)},a.fn.zoeGetMenuBarManager=function(){return a.zoeui.run.call(this,"zoeGetMenuBarManager",arguments)},a.zoeDefaults.MenuBar={},a.zoeMethos.MenuBar={},a.zoeui.controls.MenuBar=function(b,c){a.zoeui.controls.MenuBar.base.constructor.call(this,b,c)},a.zoeui.controls.MenuBar.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return a.zoeMethos.MenuBar},_render:function(){var b=this,c=this.options;b.menubar=a(this.element),b.menubar.hasClass("l-menubar")||b.menubar.addClass("l-menubar"),c&&c.items&&a(c.items).each(function(a,c){b.addItem(c)}),a(document).click(function(){a(".l-panel-btn-selected",b.menubar).removeClass("l-panel-btn-selected")}),b.set(c)},addItem:function(b){var c=this,d=(this.options,a('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>'));if(c.menubar.append(d),b.id&&d.attr("menubarid",b.id),b.text&&a("span:first",d).html(b.text),b.disable&&d.addClass("l-menubar-item-disable"),b.click&&d.click(function(){b.click(b)}),b.menu){var e=a.zoeMenu(b.menu);d.hover(function(){c.actionMenu&&c.actionMenu.hide();var b=a(this).offset().left,d=a(this).offset().top+a(this).height();e.show({top:d,left:b}),c.actionMenu=e,a(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){a(this).removeClass("l-panel-btn-over")})}else d.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")}),a(".l-menubar-item-down",d).remove()}})}(jQuery),function(a){a.zoeMessageBox=function(b){return a.zoeui.run.call(null,"zoeMessageBox",arguments,{isStatic:!0})},a.zoeDefaults.MessageBox={isDrag:!0},a.zoeMethos.MessageBox={},a.zoeui.controls.MessageBox=function(b){a.zoeui.controls.MessageBox.base.constructor.call(this,null,b)},a.zoeui.controls.MessageBox.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return a.zoeMethos.MessageBox},_render:function(){var b=this,c=this.options,d="";d+='<div class="l-messagebox">',d+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>',d+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ',d+='        <div class="l-messagebox-image"></div>',d+='        <div class="l-messagebox-title">',d+='            <div class="l-messagebox-title-inner"></div>',d+='            <div class="l-messagebox-close"></div>',d+="        </div>",d+='        <div class="l-messagebox-content">',d+="        </div>",d+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">',d+="        </div></div>",d+="    </div>",b.messageBox=a(d),a("body").append(b.messageBox),b.messageBox.close=function(){b._removeWindowMask(),b.messageBox.remove()},c.width&&b.messageBox.width(c.width),c.title&&a(".l-messagebox-title-inner",b.messageBox).html(c.title),c.content&&a(".l-messagebox-content",b.messageBox).html(c.content),c.buttons&&(a(c.buttons).each(function(c,d){var e=a('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');a(".l-messagebox-btn-inner",e).html(d.text),a(".l-messagebox-buttons-inner",b.messageBox).prepend(e),d.width&&e.width(d.width),d.onclick&&e.click(function(){d.onclick(d,c,b.messageBox)})}),a(".l-messagebox-buttons-inner",b.messageBox).append("<div class='l-clear'></div>"));var e=b.messageBox.width(),f=0;a(".l-messagebox-buttons-inner .l-messagebox-btn",b.messageBox).each(function(){f+=a(this).width()}),a(".l-messagebox-buttons-inner",b.messageBox).css({marginLeft:parseInt(.5*(e-f))}),b._applyWindowMask(),b._applyDrag(),b._setImage();var g=0,h=0,i=c.width||b.messageBox.width();null!=c.left?g=c.left:c.left=g=.5*(a(window).width()-i),null!=c.top?h=c.top:c.top=h=.5*(a(window).height()-b.messageBox.height())+a(window).scrollTop()-10,0>g&&(c.left=g=0),0>h&&(c.top=h=0),b.messageBox.css({left:g,top:h}),a(".l-messagebox-btn",b.messageBox).hover(function(){a(this).addClass("l-messagebox-btn-over")},function(){a(this).removeClass("l-messagebox-btn-over")}),a(".l-messagebox-close",b.messageBox).hover(function(){a(this).addClass("l-messagebox-close-over")},function(){a(this).removeClass("l-messagebox-close-over")}).click(function(){b.messageBox.close()}),b.set(c)},close:function(){this.options;this.g._removeWindowMask(),this.messageBox.remove()},_applyWindowMask:function(){this.options;a(".l-window-mask").remove(),a("<div class='l-window-mask' style='display: block;'></div>").appendTo(a("body"))},_removeWindowMask:function(){this.options;a(".l-window-mask").remove()},_applyDrag:function(){var b=this,c=this.options;c.isDrag&&a.fn.zoeDrag&&b.messageBox.zoeDrag({handler:".l-messagebox-title-inner",animate:!1})},_setImage:function(){var b=this,c=this.options;c.type&&("success"==c.type||"donne"==c.type?a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-donne").show():"error"==c.type?a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-error").show():"warn"==c.type?a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-warn").show():"question"==c.type&&a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-question").show())}}),a.zoeMessageBox.show=function(b){return a.zoeMessageBox(b)},a.zoeMessageBox.alert=function(b,c,d,e){b=b||"",c=c||b;var f=function(a,b,c){c.close(),e&&e(a,b,c)};return p={title:b,content:c,buttons:[{text:"确定",onclick:f}]},d&&(p.type=d),a.zoeMessageBox(p)},a.zoeMessageBox.confirm=function(b,c,d){var e=function(a,b,c){c.close(),d&&d(0==b)};return p={type:"question",title:b,content:c,buttons:[{text:"确定",onclick:e},{text:"取消",onclick:e}]},a.zoeMessageBox(p)},a.zoeMessageBox.success=function(b,c,d){return a.zoeMessageBox.alert(b,c,"success",d)},a.zoeMessageBox.error=function(b,c,d){return a.zoeMessageBox.alert(b,c,"error",d)},a.zoeMessageBox.warn=function(b,c,d){return a.zoeMessageBox.alert(b,c,"warn",d)},a.zoeMessageBox.question=function(b,c){return a.zoeMessageBox.alert(b,c,"question")}}(jQuery),function(a){a.fn.zoePanel=function(b){return a.zoeui.run.call(this,"zoePanel",arguments)},a.fn.zoeGetPanelManager=function(){return a.zoeui.run.call(this,"zoeGetPanelManager",arguments)},a.zoeDefaults.Panel={width:400,height:300,title:"Panel",content:null,url:null,frameName:null,data:null,showClose:!1,showToggle:!0,icon:null,onClose:null,onClosed:null,onLoaded:null},a.zoeMethos.Panel={},a.zoeui.controls.Panel=function(b,c){a.zoeui.controls.Panel.base.constructor.call(this,b,c)},a.zoeui.controls.Panel.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return a.zoeMethos.Panel},_init:function(){var b=this,c=this.options;a.zoeui.controls.Panel.base._init.call(this),c.content=c.content||a(b.element).html()},_render:function(){var b=this,c=this.options;b.panel=a(b.element).addClass("l-panel").html(""),b.panel.append('<div class="l-panel-header"><span></span><div class="icons"></div></div><div class="l-panel-content"></div>'),b.set(c),b.panel.bind("click.panel",function(c){var d=c.target||c.srcElement,e=a(d);e.hasClass("l-panel-header-toggle")?b.toggle():e.hasClass("l-panel-header-close")&&b.close()})},_setChildren:function(b){var c=this,d=(this.options,{input:["textbox","combobox","select"]}),e={grid:"zoeGrid",tree:"zoeTree",menu:"zoeMenu",menubar:"zoeMenuBar",portal:"zoePortal",combobox:"zoeComboBox",textbox:"zoeTextBox",spinner:"zoeSpinner",listbox:"zoeListBox",checkbox:"zoeCheckBox",radio:"zoeRadio",checkboxlist:"zoeCheckBoxList",radiolist:"zoeRadioList",button:"zoeButton",dateeditor:"zoeDateEditor",dialog:"zoeDialog",panel:"zoePanel",layout:"zoeLayout",accordion:"zoeAccordion",tab:"zoeTab"};if(b&&b.length)for(var f=0;f<b.length;f++){var g=b[f],h=g.type,i=d[h]||"div",j=e[h];if(j){var k=document.createElement(i);c.panel.find(".l-panel-content").append(k);var l=a.extend({},g);l.type=null,a(k)[j](l)}}},collapse:function(){var a=this,b=(this.options,a.panel.find(".l-panel-header .l-panel-header-toggle:first"));b.hasClass("l-panel-header-toggle-hide")||a.toggle()},expand:function(){var a=this,b=(this.options,a.panel.find(".l-panel-header .l-panel-header-toggle:first"));b.hasClass("l-panel-header-toggle-hide")&&a.toggle()},toggle:function(){var a=this,b=(this.options,a.panel.find(".l-panel-header .l-panel-header-toggle:first"));b.hasClass("l-panel-header-toggle-hide")?b.removeClass("l-panel-header-toggle-hide"):b.addClass("l-panel-header-toggle-hide"),a.panel.find(".l-panel-content:first").toggle("normal")},_setShowToggle:function(b){var c=this,d=(this.options,c.panel.find(".l-panel-header:first"));if(b){var e=a("<div class='l-panel-header-toggle'></div>");e.appendTo(d.find(".icons"))}else d.find(".l-panel-header-toggle").remove()},_setContent:function(a){var b=this,c=(this.options,b.panel.find(".l-panel-content:first"));a&&c.html(a)},_setUrl:function(b){var c=this,d=this.options,e=c.panel.find(".l-panel-content:first");if(b){c.jiframe=a("<iframe frameborder='0'></iframe>");var f=d.frameName?d.frameName:"zoepanel"+(new Date).getTime();c.jiframe.attr("name",f),c.jiframe.attr("id",f),e.prepend(c.jiframe),setTimeout(function(){0==e.find(".l-panel-loading:first").length&&e.append("<div class='l-panel-loading' style='display:block;'></div>");var b=a(".l-panel-loading:first",e);c.jiframe[0].panel=c,c.jiframe.attr("src",d.url).bind("load.panel",function(){b.hide(),c.trigger("loaded")}),c.frame=window.frames[c.jiframe.attr("name")]},0)}},_setShowClose:function(b){var c=this,d=(this.options,c.panel.find(".l-panel-header:first"));if(b){var e=a("<div class='l-panel-header-close'></div>");e.appendTo(d.find(".icons"))}else d.find(".l-panel-header-close").remove()},close:function(){var a=this;this.options;0!=a.trigger("close")&&(a.panel.remove(),a.trigger("closed"))},show:function(){this.panel.show()},_setIcon:function(a){var b=this;a?(b.panel.addClass("l-panel-hasicon"),b.panel.append('<img src="'+a+'" />')):(b.panel.removeClass("l-panel-hasicon"),b.panel.find("img").remove())},_setWidth:function(a){a&&this.panel.width(a)},_setHeight:function(a){var b=this,c=(this.options,b.panel.find(".l-panel-header:first"));this.panel.find(".l-panel-content:first").height(a-c.height())},_setTitle:function(a){this.panel.find(".l-panel-header span:first").text(a)}})}(jQuery),function(a){a.fn.zoePortal=function(b){return a.zoeui.run.call(this,"zoePortal",arguments)},a.zoeDefaults.Portal={width:null,rows:null,columns:null,url:null,method:"get",parms:null,draggable:!1,onLoaded:null},a.zoeDefaults.Portal_rows={width:null,height:null},a.zoeDefaults.Portal_columns={width:null,height:null},a.zoeMethos.Portal={},a.zoeui.controls.Portal=function(b,c){a.zoeui.controls.Portal.base.constructor.call(this,b,c)},a.zoeui.controls.Portal.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Portal"},__idPrev:function(){return"Portal"},_extendMethods:function(){return a.zoeMethos.Portal},_init:function(){var b=this,c=this.options;a.zoeui.controls.Portal.base._init.call(this),a(">div",b.element).length&&(c.columns=[],a(">div",b.element).each(function(a,b){c.columns[a]={panels:[]}}),b.tempInitPanels=a("<div></div>"),a(">div",b.element).appendTo(b.tempInitPanels)),!c.rows&&c.columns&&(c.rows=[{columns:c.columns}])},_render:function(){var b=this,c=this.options;b.portal=a(b.element).addClass("l-portal").html(""),b.set(c)},_setRows:function(b){var c=this;this.options;if(c.rows=[],b&&b.length)for(var d=0;d<b.length;d++){var e=b[d],f=a('<div class="l-row"></div>').appendTo(c.portal);c.rows[d]=c._renderRow({row:e,rowIndex:d,jrow:f}),f.append('<div class="l-clear"></div>')}},_renderRow:function(b){var c=b.row,d=b.rowIndex,e=b.jrow,f=this,g=(this.options,{element:e[0]});if(c.width&&e.width(c.width),c.height&&e.height(c.height),c.columns&&(g.columns=[]),c.columns&&c.columns.length)for(var h=0;h<c.columns.length;h++){var i=c.columns[h],j=a('<div class="l-column"></div>').appendTo(e);g.columns[h]=f._renderColumn({column:i,columnIndex:h,jcolumn:j,rowIndex:d})}return g},remove:function(a){var b=this,c=(this.options,a.rowIndex),d=a.columnIndex,e=a.index;if(null==e&&(e=-1),e>=0&&b.rows[c]&&b.rows[c].columns&&b.rows[c].columns[d]&&b.rows[c].columns[d].panels){var f=b.rows[c].columns[d].panels[e];f&&f.close(),b._updatePortal()}},add:function(b){var c=this,d=this.options,e=b.rowIndex,f=b.columnIndex,g=b.index,h=b.panel;if(null==g&&(g=-1),c.rows[e]&&c.rows[e].columns&&c.rows[e].columns[f]){var i,j=c.rows[e].columns[f],k=d.rows[e].columns[f];a(j.element);if(k.panels=k.panels||[],j.panels=j.panels||[],k.panels.splice(g,0,h),0>g){var l=a("<div></div>").insertBefore(j.jplace);i=l.zoePanel(h)}else if(j.panels[g]){var l=a("<div></div>").insertBefore(j.panels[g].panel);i=l.zoePanel(h)}i&&(i.bind("closed",c._createPanelClosed()),c.setPanelEvent({panel:i}),j.panels.splice(g,0,i)),c._updatePortal()}},_createPanelClosed:function(){var b=this,c=this.options;return function(){var d,e,f,g=this,h=b.getPanels();a(h).each(function(){this.panel==g&&(d=this.rowIndex,e=this.columnIndex,f=this.index)}),c.rows[d].columns[e].panels.splice(f,1),b.rows[d].columns[e].panels.splice(f,1)}},_renderColumn:function(b){var c=b.column,d=b.columnIndex,e=b.jcolumn,f=(b.rowIndex,this),g=(this.options,{element:e[0]});if(c.width&&e.width(c.width),c.height&&e.height(c.height),c.panels&&(g.panels=[]),c.panels&&c.panels.length)for(var h=0;h<c.panels.length;h++){var i=c.panels[h],j=a("<div></div>").appendTo(e);g.panels[h]=j.zoePanel(i),g.panels[h].bind("closed",f._createPanelClosed()),f.setPanelEvent({panel:g.panels[h]})}else if(f.tempInitPanels){var k=f.tempInitPanels.find(">div:eq("+d+")");if(k.length){g.panels=[];var l={},m=k.clone();zoe.inject&&zoe.inject.getOptions&&(l=zoe.inject.getOptions({jelement:m,defaults:a.zoeDefaults.Panel,config:zoe.inject.config.Panel})),g.panels[0]=m.appendTo(e).zoePanel(l),g.panels[0].bind("closed",f._createPanelClosed()),f.setPanelEvent({panel:g.panels[0]})}}return g.jplace=a('<div class="l-column-place"></div>').appendTo(e),g},setPanelEvent:function(b){var c=b.panel,d=c.panel,e=this,f=this.options;a.fn.zoeDrag&&f.draggable&&d.addClass("l-panel-draggable").zoeDrag({proxy:!1,revert:!0,handler:".l-panel-header span:first",onRendered:function(){},onStartDrag:function(b,c){e.portal.find(">.l-row").addClass("l-row-dragging"),this.jplace=a('<div class="l-panel-place"></div>'),this.jplace.height(d.height()),d.width(d.width()),d.addClass("l-panel-dragging"),d.css("position","absolute"),d.after(this.jplace),e._updatePortal()},onDrag:function(a,b){function f(a,b,d,e){for(i=0,l=a.length;i<l;i++){var f=a[i];if(f.panel!=c){var h=g(f,null,d,e);if(h)return h}}for(i=0,l=b.length;i<l;i++){var j=b[i],h=g(null,j,d,e);if(h)return h}return null}function g(a,b,c,d){var e=a?a.jpanel:b.jplace;if(!e)return null;var f=e.height(),g=e.width(),h=e.offset().left,i=e.offset().top,j=3;if(c>h-j&&h+g+j>c){if(d>i-j&&i+f/2+j>d)return{panel:a,column:b,position:"top"};if(d>i+f/2-j&&i+f+j>d)return{panel:a,column:b,position:a?"bottom":"top"}}return null}var h=(b.pageX||b.screenX,b.pageY||b.screenY,d.height(),d.width()),j=d.offset(),k=j.left+h/2,m=j.top+10,n=e.getPanels(),o=e.getEmptyColumns(),p=f(n,o,k,m);if(p){if(this.placeStatus){if(this.placeStatus.panel&&p.panel&&this.placeStatus.panel.rowIndex==p.panel.rowIndex&&this.placeStatus.panel.columnIndex==p.panel.columnIndex&&this.placeStatus.panel.index==p.panel.index&&this.placeStatus.position==p.position)return;if(this.placeStatus.column&&p.column&&this.placeStatus.column.rowIndex==p.column.rowIndex&&this.placeStatus.column.columnIndex==p.column.columnIndex&&this.placeStatus.position==p.position)return}"top"==p.position?(this.jplace.insertBefore(p.panel?p.panel.jpanel:p.column.jplace),this.savedPosition=p.panel?p.panel:p.column,this.savedPosition.inTop=!0):"bottom"==p.position&&(this.jplace.insertAfter(p.panel.jpanel),this.savedPosition=p.panel,this.savedPosition.inTop=!1),this.placeStatus=p}else this.placeStatus=null},onStopDrag:function(b,g){if(e.portal.find(">.l-row").removeClass("l-row-dragging"),c.set("width",c.get("width")),d.removeClass("l-panel-dragging"),this.jplace&&(d.css({position:"relative",left:null,top:null}),d.insertAfter(this.jplace),e.portal.find(">.l-row > .l-column >.l-panel-place").remove(),this.savedPosition)){var h,i,j,k=e.getPanels();a(k).each(function(){this.panel==c&&(h=this.rowIndex,i=this.columnIndex,j=this.index)});var l=f.rows[h].columns[i].panels[j],m=e.rows[h].columns[i].panels[j];f.rows[h].columns[i].panels.splice(j,1),e.rows[h].columns[i].panels.splice(j,1),this.savedPosition.panel?(f.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,l),e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,m)):(f.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[l],e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[m])}return e._updatePortal(),!1}})},_updatePortal:function(){var b=this;this.options;a(b.rows).each(function(b){a(this.columns).each(function(b){this.panels&&this.panels.length?a(this.element).removeClass("l-column-empty"):a(this.element).addClass("l-column-empty")})})},getPanels:function(){var b=this,c=(this.options,[]);return a(b.rows).each(function(b){a(this.columns).each(function(d){a(this.panels).each(function(a){c.push({rowIndex:b,columnIndex:d,index:a,panel:this,jpanel:this.panel})})})}),c},getPanel:function(b){var c=this;this.options;b=a.extend({rowIndex:0,columnIndex:0,index:0},b);var d=null;return a(c.rows).each(function(c){a(this.columns).each(function(e){a(this.panels).each(function(a){d||c==b.rowIndex&&e==b.columnIndex&&a==b.index&&(d=this)})})}),d},getEmptyColumns:function(){var b=this,c=(this.options,[]);return a(b.rows).each(function(b){a(this.columns).each(function(a){this.panels&&this.panels.length||c.push({rowIndex:b,columnIndex:a,jplace:this.jplace})})}),c},_setUrl:function(b){var c=this,d=this.options;b&&a.ajax({url:b,data:d.parms,type:d.method,dataType:"json",success:function(a){c.set("rows",a)}})},_setWidth:function(a){a&&this.portal.width(a)},collapseAll:function(){var b=this,c=(this.options,b.getPanels());a(c).each(function(a,b){var c=b.panel;c.collapse()})},expandAll:function(){var b=this,c=(this.options,b.getPanels());a(c).each(function(a,b){var c=b.panel;c.expand()})}})}(jQuery),function(a){a.fn.zoeRadio=function(){return a.zoeui.run.call(this,"zoeRadio",arguments)},a.fn.zoeGetRadioManager=function(){return a.zoeui.run.call(this,"zoeGetRadioManager",arguments)},a.zoeDefaults.Radio={disabled:!1},a.zoeMethos.Radio={},a.zoeui.controls.Radio=function(b,c){a.zoeui.controls.Radio.base.constructor.call(this,b,c)},a.zoeui.controls.Radio.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return a.zoeMethos.Radio},_render:function(){var b=this,c=this.options;b.input=a(this.element),b.link=a('<a href="javascript:void(0)" class="l-radio"></a>'),b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent(),b.wrapper.prepend(b.link),b.input.change(function(){return this.checked?b.link.addClass("l-radio-checked"):b.link.removeClass("l-radio-checked"),!0}),b.link.click(function(){b._doclick()}),b.wrapper.hover(function(){c.disabled||a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),this.element.checked&&b.link.addClass("l-radio-checked"),this.element.id&&a("label[for="+this.element.id+"]").click(function(){b._doclick()}),b.set(c)},setValue:function(a){var b=this;this.options;a?(b.input[0].checked=!0,b.link.addClass("l-radio-checked")):(b.input[0].checked=!1,b.link.removeClass("l-radio-checked"))},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"),this.options.disabled=!1},setDisabled:function(){this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled"),this.options.disabled=!0},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")},_doclick:function(){var b=this;this.options;if(b.input.attr("disabled"))return!1;b.input.trigger("click").trigger("change");var c;return c=b.input[0].form?b.input[0].form:document,a("input:radio[name="+b.input[0].name+"]",c).not(b.input).trigger("change"),!1}})}(jQuery),function(a){a.fn.zoeRadioList=function(b){return a.zoeui.run.call(this,"zoeRadioList",arguments)},a.fn.zoeGetRadioListManager=function(){return a.zoeui.run.call(this,"zoeGetRadioListManager",arguments)},a.zoeDefaults.RadioList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,data:null,parms:null,url:null,onSuccess:null,onError:null,onSelect:null,css:null,value:null,valueFieldCssClass:null},a.zoeMethos.RadioList=a.zoeMethos.RadioList||{},a.zoeui.controls.RadioList=function(b,c){a.zoeui.controls.RadioList.base.constructor.call(this,b,c)},a.zoeui.controls.RadioList.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"RadioList"},_extendMethods:function(){
return a.zoeMethos.RadioList},_init:function(){a.zoeui.controls.RadioList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data,b.valueField=null,c.valueFieldID?(b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input"),0==b.valueField.length&&(b.valueField=a('<input type="hidden"/>')),b.valueField[0].id=b.valueField[0].name=c.valueFieldID):(b.valueField=a('<input type="hidden"/>'),b.valueField[0].id=b.valueField[0].name=b.id+"_val"),null==b.valueField[0].name&&(b.valueField[0].name=b.valueField[0].id),c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass),b.valueField.attr("data-zoeid",b.id),b.radioList=a(this.element),b.radioList.html('<div class="l-radiolist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-radiolist-table"></table></div>').addClass("l-radiolist").append(b.valueField),b.radioList.table=a("table:first",b.radioList),c.value=b.valueField.val()||c.value,b.set(c),b._addClickEven()},destroy:function(){this.radioList&&this.radioList.remove(),this.options=null,a.zoeui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setCss:function(a){a&&this.radioList.addClass(a)},_setDisabled:function(b){b?(this.radioList.addClass("l-radiolist-disabled"),a("input:radio",this.radioList).attr("disabled",!0)):(this.radioList.removeClass("l-radiolist-disabled"),a("input:radio",this.radioList).removeAttr("disabled"))},_setWidth:function(a){this.radioList.width(a)},_setHeight:function(a){this.radioList.height(a)},indexOf:function(a){var b=this,c=this.options;if(!b.data)return-1;for(var d=0,e=b.data.length;e>d;d++)if("object"==typeof a){if(b.data[d]==a)return d}else if(b.data[d][c.valueField].toString()==a.toString())return d;return-1},removeItems:function(b){var c=this;c.data&&(a(b).each(function(a,b){var d=c.indexOf(b);-1!=d&&c.data.splice(d,1)}),c.refresh())},removeItem:function(a){if(this.data){var b=this.indexOf(a);-1!=b&&(this.data.splice(b,1),this.refresh())}},insertItem:function(a,b){var c=this;c.data||(c.data=[]),c.data.splice(b,0,a),c.refresh()},addItems:function(b){var c=this;c.data||(c.data=[]),a(b).each(function(a,b){c.data.push(b)}),c.refresh()},addItem:function(a){var b=this;b.data||(b.data=[]),b.data.push(a),b.refresh()},_setValue:function(a){var b=this.options;b.value=a,this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(b){if(b){var c=this,d=this.options;a.ajax({type:"post",url:b,data:d.parms,cache:!1,dataType:"json",success:function(a){c.setData(a),c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var c=this,d=c.get("parms");d||(d={}),d[a]=b,c.set("parms",d)}},clearContent:function(){var b=this;this.options;a("table",b.radioList).html("")},_setData:function(a){this.setData(a)},setData:function(a){var b=this;this.options;a&&a.length&&(b.data=a,b.refresh(),b.updateStyle())},refresh:function(){var a=this,b=this.options,c=this.data;if(this.clearContent(),c){for(var d=[],e=b.rowSize,f=!1,g=b.name||a.id,h=0;h<c.length;h++){var i=c[h][b.valueField],j=c[h][b.textField],k=a.id+"-"+h,l=h%e==0;l&&(f&&d.push("</tr>"),d.push("<tr>"),f=!0),d.push("<td><input type='radio' name='"+g+"' value='"+i+"' id='"+k+"'/><label for='"+k+"'>"+j+"</label></td>")}f&&d.push("</tr>"),a.radioList.table.append(d.join(""))}},_getValue:function(){var b=this,c=this.options,d=c.name||b.id;return a('input:radio[name="'+d+'"]:checked').val()},getValue:function(){return this._getValue()},updateStyle:function(){var b=this;this.options;b._dataInit(),a(":radio",b.element).change(function(){var a=b.getValue();b.trigger("select",[{value:a}])})},_dataInit:function(){var a=this,b=this.options,c=a.valueField.val()||a._getValue()||b.value;a._changeValue(c)},_changeValue:function(b){var c=this,d=this.options,e=d.name||c.id;a("input:radio[name='"+e+"']",c.radioList).each(function(){this.checked=this.value==b}),c.valueField.val(b),c.selectedValue=b},_addClickEven:function(){var a=this;this.options;a.radioList.click(function(b){var c=a.getValue();c&&a.valueField.val(c)})}})}(jQuery),function(a){a.fn.zoeResizable=function(b){return a.zoeui.run.call(this,"zoeResizable",arguments,{idAttrName:"zoeuiresizableid",hasElement:!1,propertyToElemnt:"target"})},a.fn.zoeGetResizableManager=function(){return a.zoeui.run.call(this,"zoeGetResizableManager",arguments,{idAttrName:"zoeuiresizableid",hasElement:!1,propertyToElemnt:"target"})},a.zoeDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2e3,maxHeight:2e3,minWidth:20,minHeight:20,scope:3,animate:!1,onStartResize:function(a){},onResize:function(a){},onStopResize:function(a){},onEndResize:null},a.zoeui.controls.Resizable=function(b){a.zoeui.controls.Resizable.base.constructor.call(this,null,b)},a.zoeui.controls.Resizable.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var b=this,c=this.options;b.target=a(c.target),b.set(c),b.target.mousemove(function(d){if(!c.disabled&&(b.dir=b._getDir(d),b.dir?b.target.css("cursor",b.dir+"-resize"):b.target.css("cursor").indexOf("-resize")>0&&b.target.css("cursor","default"),c.target.zoeuidragid)){var e=a.zoeui.get(c.target.zoeuidragid);e&&b.dir?e.set("disabled",!0):e&&e.set("disabled",!1)}}).mousedown(function(a){c.disabled||b.dir&&b._start(a)})},_rendered:function(){this.options.target.zoeuiresizableid=this.id},_getDir:function(b){var c=this,d=this.options,e="",f=c.target.offset(),g=c.target.width(),h=c.target.height(),i=d.scope,j=b.pageX||b.screenX,k=b.pageY||b.screenY;return k>=f.top&&k<f.top+i?e+="n":k<=f.top+h&&k>f.top+h-i&&(e+="s"),j>=f.left&&j<f.left+i?e+="w":j<=f.left+g&&j>f.left+g-i&&(e+="e"),"all"==d.handles||""==e?e:-1!=a.inArray(e,c.handles)?e:""},_setHandles:function(a){a&&(this.handles=a.replace(/(\s*)/g,"").split(","))},_createProxy:function(){var b=this;b.proxy=a('<div class="l-resizable"></div>'),b.proxy.width(b.target.width()).height(b.target.height()),b.proxy.attr("resizableid",b.id).appendTo("body")},_removeProxy:function(){var a=this;a.proxy&&(a.proxy.remove(),a.proxy=null)},_start:function(b){var c=this;this.options;c._createProxy(),c.proxy.css({left:c.target.offset().left,top:c.target.offset().top,position:"absolute"}),c.current={dir:c.dir,left:c.target.offset().left,top:c.target.offset().top,startX:b.pageX||b.screenX,startY:b.pageY||b.clientY,width:c.target.width(),height:c.target.height()},a(document).bind("selectstart.resizable",function(){return!1}),a(document).bind("mouseup.resizable",function(){c._stop.apply(c,arguments)}),a(document).bind("mousemove.resizable",function(){c._drag.apply(c,arguments)}),c.proxy.show(),c.trigger("startResize",[c.current,b])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(a){var b=this;this.options;if(b.current&&b.proxy){b.proxy.css("cursor",""==b.current.dir?"default":b.current.dir+"-resize");var c=a.pageX||a.screenX,d=a.pageY||a.screenY;b.current.diffX=c-b.current.startX,b.current.diffY=d-b.current.startY,b._applyResize(b.proxy),b.trigger("resize",[b.current,a])}},_stop:function(b){var c=this;this.options;c.hasBind("stopResize")?0!=c.trigger("stopResize",[c.current,b])&&c._applyResize():c._applyResize(),c._removeProxy(),c.trigger("endResize",[c.current,b]),a(document).unbind("selectstart.resizable"),a(document).unbind("mousemove.resizable"),a(document).unbind("mouseup.resizable")},_applyResize:function(b){var c=this,d=this.options,e={left:c.current.left,top:c.current.top,width:c.current.width,height:c.current.height},f=!1;b||(b=c.target,f=!0,isNaN(parseInt(c.target.css("top")))?e.top=0:e.top=parseInt(c.target.css("top")),isNaN(parseInt(c.target.css("left")))?e.left=0:e.left=parseInt(c.target.css("left"))),a.inArray(c.current.dir,c.changeBy.l)>-1?(e.left+=c.current.diffX,c.current.diffLeft=c.current.diffX):f&&delete e.left,a.inArray(c.current.dir,c.changeBy.t)>-1?(e.top+=c.current.diffY,c.current.diffTop=c.current.diffY):f&&delete e.top,a.inArray(c.current.dir,c.changeBy.w)>-1?(e.width+=(-1==c.current.dir.indexOf("w")?1:-1)*c.current.diffX,c.current.newWidth=e.width):f&&delete e.width,a.inArray(c.current.dir,c.changeBy.h)>-1?(e.height+=(-1==c.current.dir.indexOf("n")?1:-1)*c.current.diffY,c.current.newHeight=e.height):f&&delete e.height,f&&d.animate?b.animate(e):b.css(e)}})}(jQuery),function(a){a.fn.zoeSpinner=function(){return a.zoeui.run.call(this,"zoeSpinner",arguments)},a.fn.zoeGetSpinnerManager=function(){return a.zoeui.run.call(this,"zoeGetSpinnerManager",arguments)},a.zoeDefaults.Spinner={type:"float",isNegative:!0,decimalplace:2,step:.1,interval:50,onChangeValue:!1,minValue:null,maxValue:null,disabled:!1,readonly:!1},a.zoeMethos.Spinner={},a.zoeui.controls.Spinner=function(b,c){a.zoeui.controls.Spinner.base.constructor.call(this,b,c)},a.zoeui.controls.Spinner.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return a.zoeMethos.Spinner},_init:function(){a.zoeui.controls.Spinner.base._init.call(this);var b=this.options;"float"==b.type?(b.step=.1,b.interval=50):"int"==b.type?(b.step=1,b.interval=100):"time"==b.type?(b.step=1,b.interval=100):(b.type="int",b.step=1,b.interval=100)},_render:function(){var b=this,c=this.options;b.interval=null,b.inputText=null,b.value=null,b.textFieldID="","input"==this.element.tagName.toLowerCase()&&this.element.type&&"text"==this.element.type?(b.inputText=a(this.element),this.element.id&&(b.textFieldID=this.element.id)):(b.inputText=a('<input type="text"/>'),b.inputText.appendTo(a(this.element))),""==b.textFieldID&&c.textFieldID&&(b.textFieldID=c.textFieldID),b.link=a('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>'),b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.wrapper.append(b.link).after(b.selectBox).after(b.valueField),b.link.up=a(".l-spinner-up",b.link),b.link.down=a(".l-spinner-down",b.link),b.inputText.addClass("l-text-field"),c.disabled&&b.wrapper.addClass("l-text-disabled"),b._isVerify(b.inputText.val())||(b.value=b._getDefaultValue(),b._showValue(b.value)),b.link.up.hover(function(){c.disabled||a(this).addClass("l-spinner-up-over")},function(){clearInterval(b.interval),a(document).unbind("selectstart.spinner"),a(this).removeClass("l-spinner-up-over")}).mousedown(function(){c.disabled||(b._uping.call(b),b.interval=setInterval(function(){b._uping.call(b)},c.interval),a(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(b.interval),b.inputText.trigger("change").focus(),a(document).unbind("selectstart.spinner")}),b.link.down.hover(function(){c.disabled||a(this).addClass("l-spinner-down-over")},function(){clearInterval(b.interval),a(document).unbind("selectstart.spinner"),a(this).removeClass("l-spinner-down-over")}).mousedown(function(){c.disabled||(b.interval=setInterval(function(){b._downing.call(b)},c.interval),a(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(b.interval),b.inputText.trigger("change").focus(),a(document).unbind("selectstart.spinner")}),b.inputText.change(function(){var a=b.inputText.val();b.value=b._getVerifyValue(a),b.trigger("changeValue",[b.value]),b._showValue(b.value)}).blur(function(){b.wrapper.removeClass("l-text-focus")}).focus(function(){b.wrapper.addClass("l-text-focus")}),b.wrapper.hover(function(){c.disabled||b.wrapper.addClass("l-text-over")},function(){b.wrapper.removeClass("l-text-over")}),b.set(c)},_setWidth:function(a){var b=this;a>20&&(b.wrapper.css({width:a}),b.inputText.css({width:a-20}))},_setHeight:function(a){var b=this;a>10&&(b.wrapper.height(a),b.inputText.height(a-2),b.link.height(a-4))},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_showValue:function(a){var b=this.options;a&&"NaN"!=a||(a=0),"float"==b.type&&(a=parseFloat(a).toFixed(b.decimalplace)),this.inputText.val(a)},_setValue:function(a){this._showValue(a)},setValue:function(a){this._showValue(a)},getValue:function(){return this.inputText.val()},_round:function(a,b){for(var c=(this.options,1);b>0;c*=10,b--);for(;0>b;c/=10,b++);return Math.round(a*c)/c},_isInt:function(a){var b=this.options,c=b.isNegative?/^-?\d+$/:/^\d+$/;return c.test(a)?parseFloat(a)!=a?!1:!0:!1},_isFloat:function(a){var b=this.options,c=b.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;return c.test(a)?parseFloat(a)!=a?!1:!0:!1},_isTime:function(a){var b=(this.options,a.match(/^(\d{1,2}):(\d{1,2})$/));return null==b?!1:b[1]>24||b[2]>60?!1:!0},_isVerify:function(a){var b=this,c=this.options;if("float"==c.type){if(!b._isFloat(a))return!1;var d=parseFloat(a);return void 0!=c.minValue&&c.minValue>d?!1:void 0!=c.maxValue&&c.maxValue<d?!1:!0}if("int"==c.type){if(!b._isInt(a))return!1;var d=parseInt(a);return void 0!=c.minValue&&c.minValue>d?!1:void 0!=c.maxValue&&c.maxValue<d?!1:!0}return"time"==c.type?b._isTime(a):!1},_getVerifyValue:function(a){var b=this,c=this.options,d=null;return"float"==c.type?d=b._round(a,c.decimalplace):"int"==c.type?d=parseInt(a):"time"==c.type&&(d=a),b._isVerify(d)?d:b.value},_isOverValue:function(a){var b=this.options;return null!=b.minValue&&b.minValue>a?!0:null!=b.maxValue&&b.maxValue<a?!0:!1},_getDefaultValue:function(){var a=this.options;return"float"==a.type||"int"==a.type?0:"time"==a.type?"00:00":void 0},_addValue:function(a){var b=this,c=(this.options,b.inputText.val());c=parseFloat(c)+a,b._isOverValue(c)||(b._showValue(c),b.inputText.trigger("change"))},_addTime:function(a){var b=this,c=(this.options,b.inputText.val()),d=c.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(d[2])+a,newminute<10&&(newminute="0"+newminute),c=d[1]+":"+newminute,b._isOverValue(c)||(b._showValue(c),b.inputText.trigger("change"))},_uping:function(){var a=this,b=this.options;"float"==b.type||"int"==b.type?a._addValue(b.step):"time"==b.type&&a._addTime(b.step)},_downing:function(){var a=this,b=this.options;"float"==b.type||"int"==b.type?a._addValue(-1*b.step):"time"==b.type&&a._addTime(-1*b.step)},_isDateTime:function(a){var b=(this.options,a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/));if(null==b)return!1;var c=new Date(b[1],b[3]-1,b[4]);return"NaN"==c?!1:c.getFullYear()==b[1]&&c.getMonth()+1==b[3]&&c.getDate()==b[4]},_isLongDateTime:function(a){var b=(this.options,/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/),c=a.match(b);if(null==c)return!1;var d=new Date(c[1],c[3]-1,c[4],c[5],c[6]);return"NaN"==d?!1:d.getFullYear()==c[1]&&d.getMonth()+1==c[3]&&d.getDate()==c[4]&&d.getHours()==c[5]&&d.getMinutes()==c[6]}})}(jQuery),function(a){a.fn.zoeTab=function(b){return a.zoeui.run.call(this,"zoeTab",arguments)},a.fn.zoeGetTabManager=function(){return a.zoeui.run.call(this,"zoeGetTabManager",arguments)},a.zoeDefaults.Tab={height:null,heightDiff:0,icon:null,changeHeightOnResize:!1,contextmenu:!0,dblClickToClose:!1,dragToMove:!1,showSwitch:!1,showSwitchInTab:!1,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null,onCloseOther:null,onCloseAll:null,onClose:null,onReload:null},a.zoeDefaults.TabString={closeMessage:"关闭当前页",closeOtherMessage:"关闭其他",closeAllMessage:"关闭所有",reloadMessage:"刷新"},a.zoeMethos.Tab={},a.zoeui.controls.Tab=function(b,c){a.zoeui.controls.Tab.base.constructor.call(this,b,c)},a.zoeui.controls.Tab.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return a.zoeMethos.Tab},_render:function(){var b=this,c=this.options;c.height&&(b.makeFullHeight=!0),b.tab=a(this.element),b.tab.addClass("l-tab"),c.contextmenu&&a.zoeMenu&&(b.tab.menu=a.zoeMenu({width:100,items:[{text:c.closeMessage,id:"close",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.closeOtherMessage,id:"closeother",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.closeAllMessage,id:"closeall",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.reloadMessage,id:"reload",click:function(){b._menuItemClick.apply(b,arguments)}}]})),b.tab.content=a('<div class="l-tab-content"></div>'),a("> div",b.tab).appendTo(b.tab.content),b.tab.content.appendTo(b.tab),b.tab.links=a('<div class="l-tab-links"><ul style="left: 0px; "></ul><div class="l-tab-switch"></div></div>'),b.tab.links.prependTo(b.tab),b.tab.links.ul=a("ul",b.tab.links);var d=a("> div[lselected=true]",b.tab.content),e=d.length>0;b.selectedTabId=d.attr("tabid"),a("> div",b.tab.content).each(function(c,d){var f=a('<li class=""><span></span><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>'),g=a(this);g.attr("title")&&(a("> span",f).attr("style",g.attr("bind-style")),a("> a",f).html(g.attr("title")),g.attr("title",""));var h=g.attr("tabid");void 0==h&&(h=b.getNewTabid(),g.attr("tabid",h),g.attr("lselected")&&(b.selectedTabId=h)),f.attr("tabid",h),e||0!=c||(b.selectedTabId=h);var i=g.attr("showClose");if(i&&f.append("<div class='l-tab-links-item-close'></div>"),a("> ul",b.tab.links).append(f),g.hasClass("l-tab-content-item")||g.addClass("l-tab-content-item"),g.find("iframe").length>0){var j=a("iframe:first",g);if("complete"!=j[0].readyState){0==g.find(".l-tab-loading:first").length&&g.prepend("<div class='l-tab-loading' style='display:block;'></div>");var k=a(".l-tab-loading:first",g);j.bind("load.tab",function(){k.hide()})}}}),b.selectTabItem(b.selectedTabId),c.height&&("string"==typeof c.height&&c.height.indexOf("%")>0?(b.onResize(),c.changeHeightOnResize&&a(window).resize(function(){b.onResize.call(b)})):b.setHeight(c.height)),b.makeFullHeight&&b.setContentHeight(),a("li",b.tab.links).each(function(){b._addTabItemEvent(a(this))}),b.tab.bind("dblclick.tab",function(d){if(c.dblClickToClose){b.dblclicking=!0;var e=d.target||d.srcElement,f=e.tagName.toLowerCase();if("a"==f){var g=a(e).parent().attr("tabid"),h=a(e).parent().find("div.l-tab-links-item-close").length?!0:!1;h&&b.removeTabItem(g)}b.dblclicking=!1}}),b.set(c)},_setShowSwitch:function(b){var c=this;this.options;b?(a(".l-tab-switch",c.tab.links).length||a("<div class='l-tab-switch'></div>").appendTo(c.tab.links),a(c.tab).addClass("l-tab-switchable"),a(".l-tab-switch",c.tab).click(function(){c.toggleSwitch(this)})):(a(c.tab).removeClass("l-tab-switchable"),a("body > .l-tab-windowsswitch").remove())},_setShowSwitchInTab:function(b){var c=this,d=this.options;if(d.showSwitch&&b){a(c.tab).removeClass("l-tab-switchable"),a(".l-tab-switch",c.tab).remove();var e=a("<li class='l-tab-itemswitch'><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div></li>");e.appendTo(c.tab.links.ul),e.click(function(){c.toggleSwitch(this)})}else a(".l-tab-itemswitch",c.tab.ul).remove()},toggleSwitch:function(b){var c=this;this.options;if(a("body > .l-tab-windowsswitch").length)return void a("body > .l-tab-windowsswitch").remove();if(null!=b){var d=a("<div class='l-tab-windowsswitch'></div>").appendTo("body"),e=c.tab.links.ul.find(">li"),f=c.getSelectedTabItemID();e.each(function(b,c){var e=a("<a href='javascript:void(0)'></a>");e.text(a(c).find("a").text());var g=a(c).attr("tabid");null!=g&&(g==f&&e.addClass("selected"),e.attr("tabid",g),d.append(e))}),d.css({top:a(b).offset().top+a(b).height(),left:a(b).offset().left-d.width()}),d.bind("click",function(b){var d=b.target||b.srcElement;if("a"==d.tagName.toLowerCase()){var e=a(d).attr("tabid");return c.selectTabItem(e),c.moveToTabItem(e),void a("body > .l-tab-windowsswitch").remove()}})}},_applyDrag:function(b){var c=this;this.options;c.droptip=c.droptip||a("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var d=a(b).zoeDrag({revert:!0,animate:!1,proxy:function(){var b=a(this).find("a").html();return c.dragproxy=a("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body"),c.dragproxy.append(b),c.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(c,d){if(!a(b).hasClass("l-selected"))return!1;if(2==d.button)return!1;var e=d.srcElement||d.target;return a(e).hasClass("l-tab-links-item-close")?!1:void 0},onDrag:function(b,d){null==c.dropIn&&(c.dropIn=-1);var e=c.tab.links.ul.find(">li"),f=e.index(b.target);e.each(function(b,e){if(f!=b){var g=b>f;if(-1==c.dropIn||c.dropIn==b){var h=a(this).offset(),i={top:h.top,bottom:h.top+a(this).height(),left:h.left-10,right:h.left+10};g&&(i.left+=a(this).width(),i.right+=a(this).width());var j=d.pageX||d.screenX,k=d.pageY||d.screenY;j>i.left&&j<i.right&&k>i.top&&k<i.bottom?(c.droptip.css({left:i.left+5,top:i.top-9}).show(),c.dropIn=b,c.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")):(c.dropIn=-1,c.droptip.hide(),c.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no"))}}})},onStopDrag:function(b,d){if(c.dropIn>-1){var e=c.tab.links.ul.find(">li:eq("+c.dropIn+")").attr("tabid"),f=a(b.target).attr("tabid");setTimeout(function(){c.moveTabItem(f,e)},0),c.dropIn=-1,c.dragproxy.remove()}c.droptip.hide(),this.set("cursor","default")}});return d},_setDragToMove:function(b){if(a.fn.zoeDrag){var c=this;this.options;if(b){if(c.drags)return;c.drags=c.drags||[],c.tab.links.ul.find(">li").each(function(){c.drags.push(c._applyDrag(this))})}}},moveTabItem:function(a,b){var c=this,d=c.tab.links.ul.find(">li[tabid="+a+"]"),e=c.tab.links.ul.find(">li[tabid="+b+"]"),f=c.tab.links.ul.find(">li").index(d),g=c.tab.links.ul.find(">li").index(e);g>f?e.after(d):e.before(d)},setTabButton:function(){var b=this,c=(this.options,0);a("li",b.tab.links.ul).each(function(){c+=a(this).width()+2});var d=b.tab.width();return c>d?(a(".l-tab-links-left",b.tab).length||(b.tab.links.append('<div class="l-tab-links-left"><span></span></div><div class="l-tab-links-right"><span></span></div>'),b.setTabButtonEven()),!0):(b.tab.links.ul.animate({left:0}),a(".l-tab-links-left,.l-tab-links-right",b.tab.links).remove(),!1)},setTabButtonEven:function(){var b=this;this.options;a(".l-tab-links-left",b.tab.links).hover(function(){a(this).addClass("l-tab-links-left-over")},function(){a(this).removeClass("l-tab-links-left-over")}).click(function(){b.moveToPrevTabItem()}),a(".l-tab-links-right",b.tab.links).hover(function(){a(this).addClass("l-tab-links-right-over")},function(){a(this).removeClass("l-tab-links-right-over")}).click(function(){b.moveToNextTabItem()})},moveToPrevTabItem:function(b){var c=this,d=(this.options,a("> li",c.tab.links.ul)),e=a(".l-tab-links-right",c.tab),f=a(".l-tab-links-left",c.tab);if(!e.length||!f.length)return!1;for(var g=(e.offset(),f.offset()),h=null,i=0,j=g.left+f.outerWidth(),k=0,l=d.length;l>k;k++){var m=a(d[k]),n=m.offset(),o=n.left,p=n.left+m.outerWidth();if(null!=b){if(j>o&&m.attr("tabid")==b){h=m;break}}else if(j>o&&p>=j){h=m;break}i+=m.outerWidth()+parseInt(m.css("marginLeft"))+parseInt(m.css("marginRight"))}if(null==h)return!1;var q=i-f.outerWidth();return c.tab.links.ul.animate({left:-1*q}),!0},moveToNextTabItem:function(b){var c=this,d=(this.options,a("> li",c.tab.links.ul)),e=a(".l-tab-links-right",c.tab),f=a(".l-tab-links-left",c.tab);if(!e.length||!f.length)return!1;for(var g=e.offset(),h=f.offset(),i=null,j=0,k=0,l=d.length;l>k;k++){var m=a(d[k]);j+=m.outerWidth()+parseInt(m.css("marginLeft"))+parseInt(m.css("marginRight"));var n=m.offset(),o=n.left,p=n.left+m.outerWidth();if(null!=b){if(p>g.left&&m.attr("tabid")==b){i=m;break}}else if(o<=g.left&&p>g.left){i=m;break}}if(null==i)return!1;var q=j-(g.left-h.left)+parseInt(i.css("marginLeft"))+parseInt(i.css("marginRight"));return c.tab.links.ul.animate({left:-1*q}),!0},moveToTabItem:function(a){var b=this;this.options;b.moveToPrevTabItem(a)||b.moveToNextTabItem(a)},getTabItemCount:function(){var b=this;this.options;return a("li",b.tab.links.ul).length},getSelectedTabItemID:function(){var b=this;this.options;return a("li.l-selected",b.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var a=this;this.options;a.removeTabItem(a.getSelectedTabItemID())},overrideSelectedTabItem:function(a){var b=this;this.options;b.overrideTabItem(b.getSelectedTabItemID(),a)},overrideTabItem:function(b,c){var d=this;this.options;if(0==d.trigger("beforeOverrideTabItem",[b]))return!1;var e=c.tabid;void 0==e&&(e=d.getNewTabid());var f=c.url,g=c.content,h=(c.target,c.text),i=c.showClose,j=c.height;if(!d.isTabItemExist(e)){var k=a("li[tabid="+b+"]",d.tab.links.ul),l=a(".l-tab-content-item[tabid="+b+"]",d.tab.content);k&&l&&(k.attr("tabid",e),l.attr("tabid",e),0==a("iframe",l).length&&f?l.html("<iframe frameborder='0'></iframe>"):g&&l.html(g),a("iframe",l).attr("name",e),void 0==i&&(i=!0),0==i?a(".l-tab-links-item-close",k).remove():0==a(".l-tab-links-item-close",k).length&&k.append("<div class='l-tab-links-item-close'></div>"),void 0==h&&(h=e),j&&l.height(j),a("a",k).text(h),a("iframe",l).attr("src",f),d.trigger("afterOverrideTabItem",[b]))}},setHeader:function(b,c){a("li[tabid="+b+"] a",this.tab.links.ul).text(c)},selectTabItem:function(b){var c=this;this.options;return 0==c.trigger("beforeSelectTabItem",[b])?!1:(c.selectedTabId=b,a("> .l-tab-content-item[tabid="+b+"]",c.tab.content).show().siblings().hide(),a("li[tabid="+b+"]",c.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected"),void c.trigger("afterSelectTabItem",[b]))},moveToLastTabItem:function(){var b=this,c=(this.options,0);a("li",b.tab.links.ul).each(function(){c+=a(this).width()+2});var d=b.tab.width();if(c>d){var e=a(".l-tab-links-right",b.tab.links).width();b.tab.links.ul.animate({left:-1*(c-d+e+2)})}},isTabItemExist:function(b){var c=this;this.options;return a("li[tabid="+b+"]",c.tab.links.ul).length>0},addTabItem:function(b){var c=this,d=this.options;if(0==c.trigger("beforeAddTabItem",[b]))return!1;var e=b.tabid;void 0==e&&(e=c.getNewTabid());var f=b.url,g=b.content,h=b.text,i=b.showClose,j=b.height,k=b.icon,k=b.icon;if(c.isTabItemExist(e))return void c.selectTabItem(e);var l="<span style='background-image:url("+k+");'></span>",m=a("<li>"+l+"<a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>"),n=a("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>"),o=a("div:first",n),p=a("iframe:first",n);if(c.makeFullHeight){var q=c.tab.height()-c.tab.links.height();n.height(q)}m.attr("tabid",e),n.attr("tabid",e),f?(p[0].tab=c,p.attr("name",e).attr("id",e).attr("src",f).bind("load.tab",function(){o.hide(),b.callback&&b.callback()})):(p.remove(),o.remove()),g?(n.html(g),b.callback&&b.callback()):b.target&&(n.append(b.target),b.callback&&b.callback()),void 0==i&&(i=!0),0==i&&a(".l-tab-links-item-close",m).remove(),void 0==h&&(h=e),j&&n.height(j),a("a",m).text(h),a(".l-tab-itemswitch",c.tab.links.ul).length?m.insertBefore(a(".l-tab-itemswitch",c.tab.links.ul)):c.tab.links.ul.append(m),c.tab.content.append(n),c.selectTabItem(e),c.setTabButton()&&c.moveToTabItem(e),c._addTabItemEvent(m),d.dragToMove&&a.fn.zoeDrag&&(c.drags=c.drags||[],m.each(function(){c.drags.push(c._applyDrag(this))})),c.toggleSwitch(),c.trigger("afterAddTabItem",[b])},_addTabItemEvent:function(b){var c=this;this.options;b.click(function(){var b=a(this).attr("tabid");c.selectTabItem(b)}),c.tab.menu&&c._addTabItemContextMenuEven(b),a(".l-tab-links-item-close",b).hover(function(){a(this).addClass("l-tab-links-item-close-over")},function(){a(this).removeClass("l-tab-links-item-close-over")}).click(function(){var b=a(this).parent().attr("tabid");c.removeTabItem(b)})},removeTabItem:function(b){var c=this;this.options;if(0==c.trigger("beforeRemoveTabItem",[b]))return!1;var d=a("li[tabid="+b+"]",c.tab.links.ul).hasClass("l-selected");d&&(a(".l-tab-content-item[tabid="+b+"]",c.tab.content).prev().show(),a("li[tabid="+b+"]",c.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected"));var e=a(".l-tab-content-item[tabid="+b+"]",c.tab.content),f=a("iframe",e);if(f.length){var g=f[0];g.src="about:blank";try{g.contentWindow.document.write("")}catch(h){}a.browser.msie&&CollectGarbage(),f.remove()}e.remove(),a("li[tabid="+b+"]",c.tab.links.ul).remove(),c.setTabButton(),c.trigger("afterRemoveTabItem",[b])},addHeight:function(a){var b=this,c=(this.options,b.tab.height()+a);b.setHeight(c)},setHeight:function(a){var b=this;this.options;b.tab.height(a),b.setContentHeight()},setContentHeight:function(){var b=this,c=(this.options,b.tab.height()-b.tab.links.height());b.tab.content.height(c),a("> .l-tab-content-item",b.tab.content).height(c)},getNewTabid:function(){var a=this;this.options;return a.getnewidcount=a.getnewidcount||0,"tabitem"+ ++a.getnewidcount},getTabidList:function(b,c){var d=this,e=(this.options,[]);return a("> li",d.tab.links.ul).each(function(){a(this).attr("tabid")&&a(this).attr("tabid")!=b&&(!c||a(".l-tab-links-item-close",this).length>0)&&e.push(a(this).attr("tabid"))}),e},removeOther:function(b,c){var d=this,e=(this.options,d.getTabidList(b,!0));a(e).each(function(){d.removeTabItem(this)})},reload:function(b){var c=(this.options,a(".l-tab-content-item[tabid="+b+"]")),d=a(".l-tab-loading:first",c),e=a("iframe:first",c),f=a(e).attr("src");d.show(),e.attr("src",f).unbind("load.tab").bind("load.tab",function(){d.hide()})},removeAll:function(b){var c=this,d=(this.options,c.getTabidList(null,!0));a(d).each(function(){c.removeTabItem(this)})},onResize:function(){var b=this,c=this.options;if(!c.height||"string"!=typeof c.height||-1==c.height.indexOf("%"))return!1;if("body"==b.tab.parent()[0].tagName.toLowerCase()){var d=a(window).height();d-=parseInt(b.tab.parent().css("paddingTop")),d-=parseInt(b.tab.parent().css("paddingBottom")),b.height=c.heightDiff+d*parseFloat(b.height)*.01}else b.height=c.heightDiff+b.tab.parent().height()*parseFloat(c.height)*.01;b.tab.height(b.height),b.setContentHeight()},_menuItemClick:function(a){var b=this;this.options;if(a.id&&b.actionTabid)switch(a.id){case"close":if(0==b.trigger("close"))return;b.removeTabItem(b.actionTabid),b.actionTabid=null;break;case"closeother":if(0==b.trigger("closeother"))return;b.removeOther(b.actionTabid);break;case"closeall":if(0==b.trigger("closeall"))return;b.removeAll(),b.actionTabid=null;break;case"reload":if(0==b.trigger("reload",[{tabid:b.actionTabid}]))return;b.selectTabItem(b.actionTabid),b.reload(b.actionTabid)}},_addTabItemContextMenuEven:function(b){var c=this;this.options;b.bind("contextmenu",function(d){return c.tab.menu?(c.actionTabid=b.attr("tabid"),c.tab.menu.show({top:d.pageY,left:d.pageX}),0==a(".l-tab-links-item-close",this).length?c.tab.menu.setDisabled("close"):c.tab.menu.setEnabled("close"),!1):void 0})}})}(jQuery),function(a){function b(a){if(!a)return"0.00";a=a.toString().replace(/\$|\,/g,""),isNaN(a)&&(a="0.00"),sign=a==(a=Math.abs(a)),a=Math.floor(100*a+.50000000001),cents=a%100,a=Math.floor(a/100).toString(),cents<10&&(cents="0"+cents);for(var b=0;b<Math.floor((a.length-(1+b))/3);b++)a=a.substring(0,a.length-(4*b+3))+","+a.substring(a.length-(4*b+3));return""+((sign?"":"-")+""+a+"."+cents)}a.fn.zoeTextBox=function(){return a.zoeui.run.call(this,"zoeTextBox",arguments)},a.fn.zoeGetTextBoxManager=function(){return a.zoeui.run.call(this,"zoeGetTextBoxManager",arguments)},a.zoeDefaults.TextBox={onChangeValue:null,onMouseOver:null,onMouseOut:null,onBlur:null,onFocus:null,width:null,disabled:!1,value:null,nullText:null,digits:!1,number:!1,currency:!1,readonly:!1},a.zoeui.controls.TextBox=function(b,c){a.zoeui.controls.TextBox.base.constructor.call(this,b,c)},a.zoeui.controls.TextBox.zoeExtend(a.zoeui.controls.Input,{
__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){a.zoeui.controls.TextBox.base._init.call(this);var b=this,c=this.options;c.width||(c.width=a(b.element).width()),a(this.element).attr("readonly")?c.readonly=!0:c.readonly&&a(this.element).attr("readonly",!0)},_render:function(){var b=this,c=this.options;b.inputText=a(this.element),b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.inputText.hasClass("l-text-field")||b.inputText.addClass("l-text-field"),this._setEvent(),(c.digits||c.number||c.currency)&&b.inputText.addClass("l-text-field-number"),b.set(c),b.checkValue()},destroy:function(){var a=this;a.wrapper&&a.wrapper.remove(),a.options=null,zoe.remove(this)},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var a=this,c=this.options,d=a.inputText.val()||"";c.currency&&(d=d.replace(/\$|\,/g,""));var e=c.number||c.currency,f=c.digits;return""!=d&&e&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(d)||f&&!/^\d+$/.test(d)?(null!=a.value?a.inputText.val(a.value):a.inputText.val(""),void(c.currency&&a.inputText.val(b(a.value)))):(a.value=d,void(c.currency&&a.inputText.val(b(a.value))))},checkNotNull:function(){var a=this,b=this.options;b.nullText&&!b.disabled&&(a.inputText.val()||a.inputText.addClass("l-text-field-null").val(b.nullText))},_setEvent:function(){var b=this,c=this.options;b.inputText.bind("blur.textBox",function(){b.trigger("blur"),b.checkNotNull(),b.checkValue(),b.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){b.trigger("focus"),c.nullText&&a(this).hasClass("l-text-field-null")&&a(this).removeClass("l-text-field-null").val(""),b.wrapper.addClass("l-text-focus")}).change(function(){b.trigger("changeValue",[this.value])}),b.wrapper.hover(function(){b.trigger("mouseOver"),b.wrapper.addClass("l-text-over")},function(){b.trigger("mouseOut"),b.wrapper.removeClass("l-text-over")})},_setDisabled:function(a){var b=this.options;a?(this.inputText.attr("readonly","readonly"),this.wrapper.addClass("l-text-disabled")):b.readonly||(this.inputText.removeAttr("readonly"),this.wrapper.removeClass("l-text-disabled"))},_setWidth:function(a){a>20&&(this.wrapper.css({width:a}),this.inputText.css({width:a-4}))},_setHeight:function(a){a>10&&(this.wrapper.height(a),this.inputText.height(a-2))},_setValue:function(a){null!=a&&this.inputText.val(a)},_setLabel:function(b){var c=this,d=this.options;if(c.labelwrapper)c.labelwrapper.find(".l-text-label").html(b+":&nbsp");else{c.labelwrapper=c.wrapper.wrap('<div class="l-labeltext"></div>').parent();var e=a('<div class="l-text-label" style="float:left;">'+b+":&nbsp</div>");c.labelwrapper.prepend(e),c.wrapper.css("float","left"),d.labelWidth?c._setLabelWidth(d.labelWidth):d.labelWidth=e.width(),e.height(c.wrapper.height()),d.labelAlign&&c._setLabelAlign(d.labelAlign),c.labelwrapper.append('<br style="clear:both;" />'),c.labelwrapper.width(d.labelWidth+d.width+2)}},_setLabelWidth:function(a){var b=this;this.options;b.labelwrapper&&b.labelwrapper.find(".l-text-label").width(a)},_setLabelAlign:function(a){var b=this;this.options;b.labelwrapper&&b.labelwrapper.find(".l-text-label").css("text-align",a)},updateStyle:function(){var a=this,b=this.options;a.inputText.attr("readonly")?(a.wrapper.addClass("l-text-readonly"),b.disabled=!0):(a.wrapper.removeClass("l-text-readonly"),b.disabled=!1),a.inputText.attr("disabled")?(a.wrapper.addClass("l-text-disabled"),b.disabled=!0):(a.wrapper.removeClass("l-text-disabled"),b.disabled=!1),a.inputText.hasClass("l-text-field-null")&&a.inputText.val()!=b.nullText&&a.inputText.removeClass("l-text-field-null"),a.checkValue()},setValue:function(a){this._setValue(a),this.trigger("changeValue",[a])}})}(jQuery),function(a){a.zoeTip=function(b){return a.zoeui.run.call(null,"zoeTip",arguments)},a.fn.zoeTip=function(b){return this.each(function(){var c=a.extend({},a.zoeDefaults.ElementTip,b||{});if(c.target=c.target||this,c.auto||void 0==b)c.content||(c.content=this.title,c.removeTitle&&a(this).removeAttr("title")),c.content=c.content||this.title,a(this).bind("mouseover.tip",function(){c.x=a(this).offset().left+a(this).width()+(c.distanceX||0),c.y=a(this).offset().top+(c.distanceY||0),a.zoeTip(c)}).bind("mouseout.tip",function(){var b=a.zoeui.managers[this.zoeuitipid];b&&b.remove()});else{if(c.target.zoeuitipid)return;c.x=a(this).offset().left+a(this).width()+(c.distanceX||0),c.y=a(this).offset().top+(c.distanceY||0),c.x=c.x||0,c.y=c.y||0,a.zoeTip(c)}}),a.zoeui.get(this,"zoeuitipid")},a.fn.zoeHideTip=function(b){return this.each(function(){var c=b||{};void 0==c.isLabel&&(c.isLabel="label"==this.tagName.toLowerCase()&&null!=a(this).attr("for"));var d=this;if(c.isLabel){var e=a("#"+a(this).attr("for"));if(0==e.length)return;d=e[0]}var f=a.zoeui.managers[d.zoeuitipid];f&&f.remove()}).unbind("mouseover.tip").unbind("mouseout.tip")},a.fn.zoeGetTipManager=function(){return a.zoeui.get(this)},a.zoeDefaults=a.zoeDefaults||{},a.zoeDefaults.HideTip={},a.zoeDefaults.Tip={content:null,callback:null,width:"auto",height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:!0},a.zoeDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:!0},a.zoeMethos.Tip={},a.zoeui.controls.Tip=function(b){a.zoeui.controls.Tip.base.constructor.call(this,null,b)},a.zoeui.controls.Tip.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return a.zoeMethos.Tip},_render:function(){var b=this,c=this.options,d=a('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');b.tip=d,b.tip.attr("id",b.id),c.content&&(a("> .l-verify-tip-content:first",d).html(c.content),d.appendTo("body"),d.css({left:c.x,top:c.y}).show(),c.width&&a("> .l-verify-tip-content:first",d).width(c.width-8),c.height&&a("> .l-verify-tip-content:first",d).width(c.height),eee=c.appendIdTo,c.appendIdTo&&c.appendIdTo.attr("zoeTipId",b.id),c.target&&(a(c.target).attr("zoeTipId",b.id),c.target.zoeuitipid=b.id),c.callback&&c.callback(d),b.set(c))},_setContent:function(b){a("> .l-verify-tip-content:first",this.tip).html(b)},remove:function(){this.options.appendIdTo&&this.options.appendIdTo.removeAttr("zoeTipId"),this.options.target&&(a(this.options.target).removeAttr("zoeTipId"),this.options.target.zoeuitipid=null),this.tip.remove()}})}(jQuery),function(a){function b(a){return a?a.replace(/(^\s*)|(\s*$)/g,""):a}a.fn.zoeTree=function(b){return a.zoeui.run.call(this,"zoeTree",arguments)},a.fn.zoeGetTreeManager=function(){return a.zoeui.run.call(this,"zoeGetTreeManager",arguments)},a.zoeDefaults.Tree={url:null,data:null,checkbox:!0,autoCheckboxEven:!0,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:!0,nodeWidth:90,statusName:"__status",isLeaf:null,single:!1,needCancel:!0,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:!0,iconFieldName:"icon",nodeDraggable:!1,nodeDraggingRender:null,btnClickToToggleOnly:!0,ajaxType:"post",render:null,selectable:null,parentsCheckbox:!0,isExpand:null,delay:null},a.zoeui.controls.Tree=function(b,c){a.zoeui.controls.Tree.base.constructor.call(this,b,c)},a.zoeui.controls.Tree.zoeExtend(a.zoeui.core.UIComponent,{_init:function(){a.zoeui.controls.Tree.base._init.call(this);var b=this.options;b.single&&(b.autoCheckboxEven=!1)},_render:function(){var b=this,c=this.options;b.set(c,!0),b.tree=a(b.element),b.tree.addClass("l-tree"),b.toggleNodeCallbacks=[],b.sysAttribute=["isexpand","ischecked","style","delay"],b.loading=a("<div class='l-tree-loading'></div>"),b.tree.after(b.loading),b.data=[],b.maxOutlineLevel=1,b.treedataindex=0,b._applyTree(),b._setTreeEven(),b.set(c,!1)},_setTreeLine:function(a){a?this.tree.removeClass("l-tree-noline"):this.tree.addClass("l-tree-noline")},_setParms:function(){var b=this.options;a.isFunction(b.parms)&&(b.parms=b.parms())},reload:function(a){var b=this,c=this.options;b.clear(),b.loadData(null,c.url,null,{success:a})},_setUrl:function(a){var b=this;this.options;a&&(b.clear(),b.loadData(null,a))},_setData:function(a){a&&(this.clear(),this.append(null,a))},setData:function(a){this.set("data",a)},getData:function(){return this.data},hasChildren:function(a){return this.options.isLeaf?!this.options.isLeaf(a):a.children?!0:!1},getParent:function(b,c){var d=this;b=d.getNodeDom(b);var e=d.getParentTreeItem(b,c);if(!e)return null;var f=a(e).attr("treedataindex");return d._getDataNodeByTreeDataIndex(f)},getParentTreeItem:function(b,c){var d=this;b=d.getNodeDom(b);var e=a(b);if(e.parent().hasClass("l-tree"))return null;if(void 0==c)return 0==e.parent().parent("li").length?null:e.parent().parent("li")[0];for(var f=parseInt(e.attr("outlinelevel")),g=e,h=f-1;h>=c;h--)g=g.parent().parent("li");return g[0]},getChecked:function(){var b=this;this.options;if(!this.options.checkbox)return null;var c=[];return a(".l-checkbox-checked",b.tree).parent().parent("li").each(function(){var d=parseInt(a(this).attr("treedataindex"));c.push({target:this,data:b._getDataNodeByTreeDataIndex(b.data,d)})}),c},refreshTree:function(){var b=this;this.options;a.each(this.getChecked(),function(c,d){b._setParentCheckboxStatus(a(d.target))})},getSelected:function(){var b=this,c=(this.options,{});if(c.target=a(".l-selected",b.tree).parent("li")[0],c.target){var d=parseInt(a(c.target).attr("treedataindex"));return c.data=b._getDataNodeByTreeDataIndex(b.data,d),c}return null},upgrade:function(b){var c=this;this.options;a(".l-note",b).each(function(){a(this).removeClass("l-note").addClass("l-expandable-open")}),a(".l-note-last",b).each(function(){a(this).removeClass("l-note-last").addClass("l-expandable-open")}),a("."+c._getChildNodeClassName(),b).each(function(){a(this).removeClass(c._getChildNodeClassName()).addClass(c._getParentNodeClassName(!0))})},demotion:function(b){var c=this;this.options;if(b||"li"==b[0].tagName.toLowerCase()){var d=a(b).hasClass("l-last");a(".l-expandable-open",b).each(function(){a(this).removeClass("l-expandable-open").addClass(d?"l-note-last":"l-note")}),a(".l-expandable-close",b).each(function(){a(this).removeClass("l-expandable-close").addClass(d?"l-note-last":"l-note")}),a("."+c._getParentNodeClassName(!0),b).each(function(){a(this).removeClass(c._getParentNodeClassName(!0)).addClass(c._getChildNodeClassName())})}},collapseAll:function(){var b=this;this.options;a(".l-expandable-open",b.tree).click()},expandAll:function(){var b=this;this.options;a(".l-expandable-close",b.tree).click()},loadData:function(b,c,d,e){var f=this,g=this.options;e=a.extend({showLoading:function(){f.loading.show()},success:function(){},error:function(){},hideLoading:function(){f.loading.hide()}},e||{});var h=g.ajaxType;d=a.extend(a.isFunction(g.parms)?g.parms():g.parms,d),a.ajax({type:h,url:c,data:d,dataType:"json",beforeSend:function(){e.showLoading()},success:function(a){a&&(e.hideLoading(),f.append(b,a),f.trigger("success",[a]),e.success(a))},error:function(a,b,c){try{d.hideLoading(),f.trigger("error",[a,b,c]),d.error(a,b,c)}catch(d){}}})},clear:function(){var a=this;this.options;a.toggleNodeCallbacks=[],a.data=null,a.data=[],a.nodes=null,a.tree.html("")},getNodeDom:function(b){var c=this;this.options;return null==b?b:"string"==typeof b||"number"==typeof b?a("li[treedataindex="+b+"]",c.tree).get(0):"object"==typeof b&&"treedataindex"in b?c.getNodeDom(b.treedataindex):b},hide:function(b){var c=this;this.options;b=c.getNodeDom(b),b&&a(b).hide()},show:function(b){var c=this;this.options;b=c.getNodeDom(b),b&&a(b).show()},remove:function(b){var c=this,d=this.options;b=c.getNodeDom(b);var e=parseInt(a(b).attr("treedataindex")),f=c._getDataNodeByTreeDataIndex(c.data,e);f&&c._setTreeDataStatus([f],"delete");var g=c.getParentTreeItem(b);d.checkbox&&c._setParentCheckboxStatus(a(b)),a(b).remove(),c._updateStyle(g?a("ul:first",g):c.tree)},_updateStyle:function(b){var c=this,d=(this.options,a(" > li",b)),e=d.length;e&&d.each(function(b,d){0!=b||a(this).hasClass("l-first")||a(this).addClass("l-first"),b!=e-1||a(this).hasClass("l-last")||a(this).addClass("l-last"),0==b&&b==e-1&&a(this).addClass("l-onlychild"),a("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(b==e-1?"l-note-last":"l-note"),c._setTreeItem(this,{isLast:b==e-1})})},update:function(b,c){var d=this,e=this.options;b=d.getNodeDom(b);var f=parseInt(a(b).attr("treedataindex"));nodedata=d._getDataNodeByTreeDataIndex(d.data,f);for(var g in c)nodedata[g]=c[g],g==e.textFieldName&&a("> .l-body > span",b).text(c[g])},append:function(b,c,d,e){var f=this,g=this.options;if(b=f.getNodeDom(b),0==f.trigger("beforeAppend",[b,c]))return!1;if(!c||!c.length)return!1;if(g.idFieldName&&g.parentIDFieldName&&(c=f.arrayToTree(c,g.idFieldName,g.parentIDFieldName)),f._addTreeDataIndexToData(c),f._setTreeDataStatus(c,"add"),null!=d&&(d=f.getNodeDom(d)),f.trigger("append",[b,c]),f._appendData(b,c),null==b){var h=f._getTreeHTMLByData(c,1,[],!0);return h[h.length-1]=h[0]="",null!=d?(a(d)[e?"after":"before"](h.join("")),f._updateStyle(b?a("ul:first",b):f.tree)):(a("> li:last",f.tree).length>0&&f._setTreeItem(a("> li:last",f.tree)[0],{isLast:!1}),f.tree.append(h.join(""))),a(".l-body",f.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f._upadteTreeWidth(),void f.trigger("afterAppend",[b,c])}var i=a(b),j=parseInt(i.attr("outlinelevel")),k=a("> ul",i).length>0;k||(i.append("<ul class='l-children'></ul>"),f.upgrade(b));for(var l=[],m=1;j-1>=m;m++){var n=a(f.getParentTreeItem(b,m));l.push(n.hasClass("l-last"))}l.push(i.hasClass("l-last"));var h=f._getTreeHTMLByData(c,j+1,l,!0);h[h.length-1]=h[0]="",null!=d?(a(d)[e?"after":"before"](h.join("")),f._updateStyle(b?a("ul:first",b):f.tree)):(a("> .l-children > li:last",i).length>0&&f._setTreeItem(a("> .l-children > li:last",i)[0],{isLast:!1}),a(">.l-children",b).append(h.join(""))),f._upadteTreeWidth(),a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f.trigger("afterAppend",[b,c])},cancelSelect:function(b){var c=this,d=this.options,e=c.getNodeDom(b),f=a(e),g=parseInt(f.attr("treedataindex")),h=c._getDataNodeByTreeDataIndex(c.data,g),i=a(">div:first",f);d.checkbox?a(".l-checkbox",i).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"):i.removeClass("l-selected"),c.trigger("cancelSelect",[{data:h,target:f[0]}])},selectNode:function(c){var d=this,e=this.options,f=null;if("function"==typeof c)f=c;else{if("object"==typeof c){var g=a(c),h=parseInt(g.attr("treedataindex")),i=d._getDataNodeByTreeDataIndex(d.data,h),j=a(">div:first",g);return j.length||(j=a("li[treedataindex="+h+"] >div:first",d.tree)),e.checkbox?a(".l-checkbox",j).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"):(a("div.l-selected",d.tree).removeClass("l-selected"),j.addClass("l-selected")),void d.trigger("select",[{data:i,target:j.parent().get(0)}])}f=function(a){return a[e.idFieldName]?b(a[e.idFieldName].toString())==b(c.toString()):!1}}a("li",d.tree).each(function(){var b=a(this),c=parseInt(b.attr("treedataindex")),e=d._getDataNodeByTreeDataIndex(d.data,c);f(e,c)?d.selectNode(this):d.options.checkbox||d.cancelSelect(this)})},getTextByID:function(a){var b=this,c=this.options,d=b.getDataByID(a);return d?d[c.textFieldName]:null},getDataByID:function(b){var c=this,d=this.options,e=null;return a("li",c.tree).each(function(){if(!e){var f=a(this),g=parseInt(f.attr("treedataindex")),h=c._getDataNodeByTreeDataIndex(c.data,g);h[d.idFieldName].toString()==b.toString()&&(e=h)}}),e},arrayToTree:function(a,b,c){if(!a||!a.length)return[];for(var d=[],e={},f=a.length,g=0;f>g;g++){var h=a[g];e[h[b]]=h}for(var g=0;f>g;g++){var i=a[g],j=e[i[c]];j?(j.children=j.children||[],j.children.push(i)):d.push(i)}return d},_getDataNodeByTreeDataIndex:function(a,b){for(var c=this,d=(this.options,0);d<a.length;d++){if(a[d].treedataindex==b)return a[d];if(a[d].children){var e=c._getDataNodeByTreeDataIndex(a[d].children,b);if(e)return e}}return null},_setTreeDataStatus:function(b,c){var d=this,e=this.options;a(b).each(function(){this[e.statusName]=c,this.children&&d._setTreeDataStatus(this.children,c)})},_addTreeDataIndexToData:function(b){var c=this;this.options;a(b).each(function(){void 0==this.treedataindex&&(this.treedataindex=c.treedataindex++,this.children&&c._addTreeDataIndexToData(this.children))})},_addToNodes:function(b){var c=this;this.options;c.nodes=c.nodes||[],c.nodes.push(b),b.children&&a(b.children).each(function(a,b){c._addToNodes(b)})},_appendData:function(b,c){var d=this,e=(this.options,parseInt(a(b).attr("treedataindex"))),f=d._getDataNodeByTreeDataIndex(d.data,e);void 0==d.treedataindex&&(d.treedataindex=0),f&&void 0==f.children&&(f.children=[]),a(c).each(function(a,b){f?f.children[f.children.length]=b:d.data[d.data.length]=b,d._addToNodes(b)})},_setTreeItem:function(b,c){var d=this;this.options;if(c){b=d.getNodeDom(b);var e=a(b),f=parseInt(e.attr("outlinelevel"));void 0!=c.isLast&&(1==c.isLast?(e.removeClass("l-last").addClass("l-last"),a("> div .l-note",e).removeClass("l-note").addClass("l-note-last"),a(".l-children li",e).find(".l-box:eq("+(f-1)+")").removeClass("l-line")):0==c.isLast&&(e.removeClass("l-last"),a("> div .l-note-last",e).removeClass("l-note-last").addClass("l-note"),a(".l-children li",e).find(".l-box:eq("+(f-1)+")").removeClass("l-line").addClass("l-line")))}},_upadteTreeWidth:function(){var a=this,b=this.options,c=22*a.maxOutlineLevel;b.checkbox&&(c+=22),(b.parentIcon||b.childIcon)&&(c+=22),c+=b.nodeWidth,a.tree.width(c)},_getChildNodeClassName:function(){var a=this.options;return"l-tree-icon-"+a.childIcon},_getParentNodeClassName:function(a){var b=this.options,c="l-tree-icon-"+b.parentIcon;return a&&(c+="-open"),c},_isExpand:function(a,b){var c=this.options,d=null!=a.isExpand?a.isExpand:null!=a.isexpand?a.isexpand:c.isExpand;return null==d?!0:("function"==typeof d&&(d=c.isExpand({data:a,level:b})),"boolean"==typeof d?d:"string"==typeof d?"true"==d:"number"==typeof d?d>b:!0)},_getDelay:function(b,c){var d=this.options,e=null!=b.delay?b.delay:d.delay;return null==e?!1:("function"==typeof e&&(e=e({data:b,level:c})),"boolean"==typeof e?e:"string"==typeof e?{url:e}:("number"==typeof e&&(e=[e]),a.isArray(e)?-1!=a.inArray(c,e):"object"==typeof e&&e.url?e:!1))},_getTreeHTMLByData:function(b,c,d,e){var f=this,g=this.options;f.maxOutlineLevel<c&&(f.maxOutlineLevel=c),d=d||[],c=c||1;var h=[];e?h.push("<ul class='l-children'>"):h.push('<ul class="l-children" style="display:none">');for(var i=0;i<b.length;i++){var j=b[i],k=0==i,l=i==b.length-1,m=f._getDelay(j,c),n=m?!1:f._isExpand(j,c);h.push("<li "),void 0!=j.treedataindex&&h.push('treedataindex="'+j.treedataindex+'" '),n&&h.push("isexpand="+j.isexpand+" "),h.push("outlinelevel="+c+" ");for(var o=0;o<f.sysAttribute.length;o++)a(this).attr(f.sysAttribute[o])&&(b[dataindex][f.sysAttribute[o]]=a(this).attr(f.sysAttribute[o]));for(var o=0;o<g.attribute.length;o++)j[g.attribute[o]]&&h.push(g.attribute[o]+'="'+j[g.attribute[o]]+'" ');h.push('class="'),k&&h.push("l-first "),l&&h.push("l-last "),k&&l&&h.push("l-onlychild "),h.push('"'),h.push(">"),h.push('<div class="l-body '),j.cls&&h.push(j.cls),g.selectable&&0==g.selectable(j)&&h.push(" l-unselectable"),h.push('">');for(var p=0;c-2>=p;p++)d[p]?h.push('<div class="l-box"></div>'):h.push('<div class="l-box l-line"></div>');if(f.hasChildren(j)?(n?h.push('<div class="l-box l-expandable-open"></div>'):h.push('<div class="l-box l-expandable-close"></div>'),g.checkbox&&g.parentsCheckbox&&(j.ischecked?h.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):h.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),g.parentIcon&&(h.push('<div class="l-box l-tree-icon '),h.push(f._getParentNodeClassName(n?!0:!1)+" "),g.iconFieldName&&j[g.iconFieldName]&&h.push("l-tree-icon-none"),h.push('">'),g.iconFieldName&&j[g.iconFieldName]&&h.push('<img src="'+j[g.iconFieldName]+'" />'),h.push("</div>"))):(l?h.push('<div class="l-box l-note-last"></div>'):h.push('<div class="l-box l-note"></div>'),g.checkbox&&(j.ischecked?h.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):h.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),g.childIcon&&(h.push('<div class="l-box l-tree-icon '),h.push(f._getChildNodeClassName()+" "),g.iconFieldName&&j[g.iconFieldName]&&h.push("l-tree-icon-none"),h.push('">'),g.iconFieldName&&j[g.iconFieldName]&&h.push('<img src="'+j[g.iconFieldName]+'" />'),h.push("</div>"))),g.render?h.push("<span>"+g.render(j,j[g.textFieldName])+"</span>"):h.push("<span>"+j[g.textFieldName]+"</span>"),h.push("</div>"),f.hasChildren(j)){for(var q=[],p=0;p<d.length;p++)q.push(d[p]);q.push(l),m?1==m?f.toggleNodeCallbacks.push({data:j,callback:function(b,d){var e=f._getTreeHTMLByData(d.children,c+1,q,n).join("");a(b).append(e),a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f._removeToggleNodeCallback(d)}}):m.url&&!function(b,c,d){f.toggleNodeCallbacks.push({data:b,callback:function(b,e){f.loadData(b,c,d,{showLoading:function(){a("div.l-expandable-close:first",b).addClass("l-box-loading")},hideLoading:function(){a("div.l-box-loading:first",b).removeClass("l-box-loading")}}),f._removeToggleNodeCallback(e)}})}(j,m.url,m.parms):h.push(f._getTreeHTMLByData(j.children,c+1,q,n).join(""))}h.push("</li>")}return h.push("</ul>"),h},_removeToggleNodeCallback:function(a){for(var b=this,c=(this.options,0);c<=b.toggleNodeCallbacks.length;c++)if(b.toggleNodeCallbacks[c]&&b.toggleNodeCallbacks[c].data==a){b.toggleNodeCallbacks.splice(c,1);break}},_getDataByTreeHTML:function(b){var c=this,d=this.options,e=[];return a("> li",b).each(function(b,f){var g=e.length;e[g]={treedataindex:c.treedataindex++},e[g][d.textFieldName]=a("> span,> a",this).html();for(var h=0;h<c.sysAttribute.length;h++)a(this).attr(c.sysAttribute[h])&&(e[g][c.sysAttribute[h]]=a(this).attr(c.sysAttribute[h]));for(var h=0;h<d.attribute.length;h++)a(this).attr(d.attribute[h])&&(e[g][d.attribute[h]]=a(this).attr(d.attribute[h]));a("> ul",this).length>0&&(e[g].children=c._getDataByTreeHTML(a("> ul",this)))}),e},_applyTree:function(){var b=this;this.options;b.data=b._getDataByTreeHTML(b.tree);var c=b._getTreeHTMLByData(b.data,1,[],!0);c[c.length-1]=c[0]="",b.tree.html(c.join("")),b._upadteTreeWidth(),a(".l-body",b.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(b){var c=this,d=b.target||b.srcElement,e=d.tagName.toLowerCase(),f=a(d).parents().add(d),g=function(b){for(var c=f.length-1;c>=0;c--)if(a(f[c]).hasClass(b))return f[c];return null};if(-1==f.index(this.element))return{out:!0};var h={tree:g("l-tree"),node:g("l-body"),checkbox:g("l-checkbox"),icon:g("l-tree-icon"),text:"span"==e,cls:null};if(h.node){var i=parseInt(a(h.node).parent().attr("treedataindex"));h.data=c._getDataNodeByTreeDataIndex(c.data,i)}return h},_setTreeEven:function(){var b=this,c=this.options;b.hasBind("contextmenu")&&b.tree.bind("contextmenu",function(c){var d=c.target||c.srcElement,e=null;if("a"==d.tagName.toLowerCase()||"span"==d.tagName.toLowerCase()||a(d).hasClass("l-box")?e=a(d).parent().parent():a(d).hasClass("l-body")?e=a(d).parent():"li"==d.tagName.toLowerCase()&&(e=a(d)),e){var f=parseInt(e.attr("treedataindex")),g=b._getDataNodeByTreeDataIndex(b.data,f);return b.trigger("contextmenu",[{data:g,target:e[0]},c])}}),b.tree.click(function(d){var e=d.target||d.srcElement,f=null;if(f="a"==e.tagName.toLowerCase()||"span"==e.tagName.toLowerCase()||a(e).hasClass("l-box")?a(e).parent().parent():a(e).hasClass("l-body")?a(e).parent():a(e)){var g=parseInt(f.attr("treedataindex")),h=b._getDataNodeByTreeDataIndex(b.data,g),i=a("div.l-body:first",f).find("div.l-expandable-open:first,div.l-expandable-close:first"),j=a(e).hasClass("l-expandable-open")||a(e).hasClass("l-expandable-close");if(!a(e).hasClass("l-checkbox")&&!j&&!f.hasClass("l-unselectable"))if(a(">div:first",f).hasClass("l-selected")&&c.needCancel){if(0==b.trigger("beforeCancelSelect",[{data:h,target:f[0]}]))return!1;a(">div:first",f).removeClass("l-selected"),b.trigger("cancelSelect",[{data:h,target:f[0]}])}else{if(0==b.trigger("beforeSelect",[{data:h,target:f[0]}]))return!1;a(".l-body",b.tree).removeClass("l-selected"),a(">div:first",f).addClass("l-selected"),b.trigger("select",[{data:h,target:f[0]}])}if(a(e).hasClass("l-checkbox"))c.autoCheckboxEven?(a(e).hasClass("l-checkbox-unchecked")?(a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:h,target:f[0]},!0])):a(e).hasClass("l-checkbox-checked")?(a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!1])):a(e).hasClass("l-checkbox-incomplete")&&(a(e).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:h,target:f[0]},!0])),b._setParentCheckboxStatus(f)):a(e).hasClass("l-checkbox-unchecked")?(a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),c.single&&a(".l-checkbox",b.tree).not(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!0])):a(e).hasClass("l-checkbox-checked")&&(a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!1]));else if(!i.hasClass("l-expandable-open")||c.btnClickToToggleOnly&&!j){if(i.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||j)){if(0==b.trigger("beforeExpand",[{data:h,target:f[0]}]))return!1;a(b.toggleNodeCallbacks).each(function(){this.data==h&&this.callback(f[0],h)}),i.removeClass("l-expandable-close").addClass("l-expandable-open");var k=function(){b.trigger("expand",[{data:h,target:f[0]}])};c.slide?a("> .l-children",f).slideToggle("fast",k):(a("> .l-children",f).show(),k()),a("> div ."+b._getParentNodeClassName(),f).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(!0))}}else{if(0==b.trigger("beforeCollapse",[{data:h,target:f[0]}]))return!1;i.removeClass("l-expandable-open").addClass("l-expandable-close"),c.slide?a("> .l-children",f).slideToggle("fast"):a("> .l-children",f).hide(),a("> div ."+b._getParentNodeClassName(!0),f).removeClass(b._getParentNodeClassName(!0)).addClass(b._getParentNodeClassName()),b.trigger("collapse",[{data:h,target:f[0]}])}b.trigger("click",[{data:h,target:f[0]}])}}),a.fn.zoeDrag&&c.nodeDraggable&&(b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body"),b.tree.zoeDrag({revert:!0,animate:!1,proxyX:20,proxyY:20,proxy:function(d,e){var f=b._getSrcElementByEvent(e);if(f.node){var g="dragging";if(c.nodeDraggingRender)g=c.nodeDraggingRender(d.draggingNodes,d,b);else{g="";var h=!1;for(var i in d.draggingNodes){var j=d.draggingNodes[i];h&&(g+=","),g+=j.text,h=!0}}var k=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+g+"</div>").appendTo("body");return k}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),b.children[this.id]=this},onStartDrag:function(a,d){if(2==d.button)return!1;this.set("cursor","default");var e=b._getSrcElementByEvent(d);if(e.checkbox)return!1;if(c.checkbox){var f=b.getChecked();this.draggingNodes=[];for(var g in f)this.draggingNodes.push(f[g].data);if(!this.draggingNodes||!this.draggingNodes.length)return!1}else this.draggingNodes=[e.data];this.draggingNode=e.data,this.set("cursor","move"),b.nodedragging=!0,this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(c,d){var e=this.draggingNode;if(!e)return!1;var f=this.draggingNodes?this.draggingNodes:[e];null==b.nodeDropIn&&(b.nodeDropIn=-1);var g=d.pageX,h=d.pageY,i=!1,j=this.validRange;if(g<j.left||g>j.right||h>j.bottom||h<j.top)return b.nodeDropIn=-1,b.nodeDroptip.hide(),void this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");for(var k=0,l=b.nodes.length;l>k;k++){var m=b.nodes[k],n=m.treedataindex;if(e.treedataindex==n&&(i=!0),-1==a.inArray(m,f)){var o=i?!0:!1;if(-1==b.nodeDropIn||b.nodeDropIn==n){var p=a("li[treedataindex="+n+"] div:first",b.tree),q=p.offset(),r={top:q.top,bottom:q.top+p.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()};if(g>r.left&&g<r.right&&h>r.top&&h<r.bottom){var s=q.top;o&&(s+=p.height()),b.nodeDroptip.css({left:r.left,top:s,width:r.right-r.left}).show(),b.nodeDropIn=n,b.nodeDropDir=o?"bottom":"top",h>r.top+7&&h<r.bottom-7?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),b.nodeDroptip.hide(),b.nodeDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),b.nodeDroptip.show(),b.nodeDropInParent=!1);break}-1!=b.nodeDropIn&&(b.nodeDropIn=-1,b.nodeDropInParent=!1,b.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}}},onStopDrag:function(c,d){var e=this.draggingNodes;if(b.nodedragging=!1,-1!=b.nodeDropIn){for(var f=0;f<e.length;f++){var g=e[f].children;g&&(e=a.grep(e,function(b,c){var d=-1==a.inArray(b,g);return d}))}for(var f in e){var h=e[f];b.nodeDropInParent?(b.remove(h),b.append(b.nodeDropIn,[h])):(b.remove(h),b.append(b.getParent(b.nodeDropIn),[h],b.nodeDropIn,"bottom"==b.nodeDropDir))}b.nodeDropIn=-1}b.nodeDroptip.hide(),this.set("cursor","default")}}))},_setParentCheckboxStatus:function(b){var c=this,d=(this.options,0==a(".l-checkbox-unchecked",b.parent()).length),e=0==a(".l-checkbox-checked",b.parent()).length;d?b.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked"):e?b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked"):b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete"),b.parent().parent("li").length>0&&c._setParentCheckboxStatus(b.parent().parent("li"))}})}(jQuery),function(a){function b(b){var c=[];return a(b).each(function(b,d){var e=a(d.element).parents("li:first").prev("li:first").html(),f=d.message;c.push("<div>"+e+" "+f+"</div>")}),c.join("")}a.fn.zoeForm=function(){return a.zoeui.run.call(this,"zoeForm",arguments)},a.zoeui.getConditions=function(b,c){return b?(b=zoe.get(a(b)),b&&b.toConditions?b.toConditions():void 0):null},a.zoeDefaults=a.zoeDefaults||{},a.zoeDefaults.Form={width:null,inputWidth:180,labelWidth:90,space:40,rightToken:"：",labelAlign:"right",align:"left",fields:[],appendID:!0,prefixID:null,toJSON:a.zoeui.toJSON,labelCss:null,fieldCss:null,spaceCss:null,onAfterSetFields:null,buttons:null,readonly:!1,editors:{},validate:null,unSetValidateAttr:!1,tab:null},a.zoeDefaults.FormString={invalidMessage:"存在{errorCount}个字段验证不通过，请检查!",detailMessage:"详细",okMessage:"确定"},a.zoeDefaults.Form.editors.textarea={create:function(b,c,d){var e=a('<textarea class="l-textarea" />'),f=(d.prefixID||"")+c.field.name;
return a("#"+f).length&&(e=a("#"+f)),e.attr({id:f,name:f}),d.readonly&&e.attr("readonly",!0),b.append(e),e},getValue:function(a,b){return a.val()},setValue:function(a,b,c){a.val(b)},resize:function(a,b,c,d){a.css({width:b-2}).parent().css("width","auto")}},a.zoeDefaults.Form.editors.hidden={create:function(b,c,d){var e=a('<input type = "hidden"  />'),f=(d.prefixID||"")+c.field.name;return e.attr(a.extend({id:f,name:f},c.field.attr)),c.field.options&&c.field.options.value&&e.val(c.field.options.value),b.append(e),e},getValue:function(a,b){return a.val()},setValue:function(a,b,c){a.val(b)}},a.zoeDefaults.Form_fields={name:null,textField:null,type:null,editor:null,label:null,hideSpace:!1,hideLabel:!1,rightToken:null,newline:!0,op:null,vt:null,attr:null,validate:null},a.zoeDefaults.Form_editor={},a.zoeDefaults.Form.editorBulider=function(b){var c=this.options,d={},e=b.attr("ltype"),f={};if(c.readonly&&(d.readonly=!0),d=a.extend({width:(f.width||c.inputWidth)-2},f.options,f.editor,d),"autocomplete"==e&&(d.autocomplete=!0),b.is("select"))b.zoeComboBox(d);else if(b.is(":password"))b.zoeTextBox(d);else if(b.is(":text"))switch(e){case"select":case"combobox":case"autocomplete":b.zoeComboBox(d);break;case"spinner":b.zoeSpinner(d);break;case"date":b.zoeDateEditor(d);break;case"popup":b.zoePopupEdit(d);break;case"currency":d.currency=!0;case"float":case"number":d.number=!0,b.zoeTextBox(d);break;case"int":case"digits":d.digits=!0;default:b.zoeTextBox(d)}else b.is(":radio")?b.zoeRadio(d):b.is(":checkbox")?b.zoeCheckBox(d):b.is("textarea")&&b.addClass("l-textarea")},a.zoeui.controls.Form=function(b,c){a.zoeui.controls.Form.base.constructor.call(this,b,c)},a.zoeui.controls.Form.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){var b=this,c=this.options;a.zoeui.controls.Form.base._init.call(this);for(var d in zoe.editors){var e=zoe.editors[d];!e||d in c.editors||(c.editors[d]=zoe.getEditor(a.extend({type:d,master:b},e)))}},_render:function(){var b=this,c=this.options,d=a(this.element);if(b.form=d.is("form")?d:d.parents("form:first"),a("input,select,textarea",d).each(function(){c.editorBulider.call(b,a(this))}),b.set(c),b.initValidate(),c.buttons){var e=a('<ul class="l-form-buttons"></ul>').appendTo(d);a(c.buttons).each(function(){var b=a("<li><div></div></li>").appendTo(e);a("div:first",b).zoeButton(this)})}b.element.id||(b.element.id=b.id)},_setWidth:function(a){var b=this;this.options;a&&b.form.width(a)},getEditor:function(a){function b(b,e){for(var f=null==b?d.fields:b.fields,g=0,h=f.length;h>g;g++){var i=f[g],j=null==e?g:"tab"+e+"_"+g;if(i.name==a&&c.editors[j])return c.editors[j].control}}var c=this,d=this.options;if(c.editors){var e=b(null);if(e)return e;if(d.tab&&d.tab.items)for(var f=0;f<d.tab.items.length;f++){var g=d.tab.items[f],e=b(g,f);if(e)return e}return null}},getField:function(a){var b=this.options;return b.fields?b.fields[a]:null},toConditions:function(){var b=this,c=this.options,d=[];return a(c.fields).each(function(a,c){var e=c.name,f=(c.textField,b.editors[a]);if(f&&e){var g=f.editor.getValue(f.control,{field:c});null!=g&&""!==g&&d.push({op:c.operator||"like",field:e,value:g,type:c.type||"string"})}}),d},_preSetFields:function(b){var c=this.options,d=null,e=null;a(c.fields).each(function(a,b){(c.readonly||b.readonly||b.editor&&b.editor.readonly)&&delete b.validate,"hidden"!=b.type&&(b.type=b.type||"text",null==b.newline&&(b.newline=!0),d&&!b.group&&(b.group=d,b.groupicon=e),b.group&&(b.group=b.group.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,""),d=b.group,e=b.groupicon))})},_setReadonly:function(a){var b=this;this.options;if(a&&b.editors)for(var c in b.editors){var d=b.editors[c].control;d&&d._setReadonly&&d._setReadonly(!0)}},_setFields:function(b){var c=this,d=this.options;a.isFunction(d.prefixID)&&(d.prefixID=d.prefixID(c));var e=a(c.element).addClass("l-form");c._initFieldsValidate({fields:b}),c._initFieldsHtml({panel:e,fields:b}),c._createEditors({fields:b}),c.trigger("afterSetFields")},_initFieldsValidate:function(b){var c=this,d=this.options,e=b.fields;c.validate=c.validate||{},e&&e.length&&a(e).each(function(a,b){var e=(b.name,b.readonly||b.editor&&b.editor.readonly?!0:!1),f=(d.prefixID||"")+(b.textField||b.id||b.name);b.validate&&!e&&(c.validate.rules=c.validate.rules||{},c.validate.rules[f]=b.validate,b.validateMessage&&(c.validate.messages=c.validate.messages||{},c.validate.messages[f]=b.validateMessage))})},_initFieldsHtml:function(b){var c=this,d=this.options,e=b.panel,f=b.fields,g=b.idPrev||c.id;a(">.l-form-container",e).remove();var h=0,i=0;if(f&&f.length){c._preSetFields(f);var j=['<div class="l-form-container">'],k=!1,l=null,m=[];a(f).each(function(b,c){-1==a.inArray(c.group,m)&&m.push(c.group)}),a(m).each(function(e,m){a(f).each(function(e,n){if(n.group==m){var o=a.inArray(n,f),p=n.id||n.name,q=n.newline;(d.prefixID||"")+(n.id||n.name);if(p){if("hidden"==n.type)return void j.push('<div style="display:none" id="'+(g+"|"+e)+'"></div>');var r=n.group&&n.group!=l;if((0==o||r)&&(q=!0),q&&(h=0,k&&(j.push("</ul>"),k=!1),r&&(j.push('<div class="l-group'),n.groupicon&&j.push(" l-group-hasicon"),j.push('">'),n.groupicon&&j.push('<img src="'+n.groupicon+'" />'),j.push("<span>"+n.group+"</span></div>"),l=n.group),j.push("<ul>"),k=!0),j.push('<li class="l-fieldcontainer'),q&&j.push(" l-fieldcontainer-first"),j.push('"'),j.push(" fieldindex="+o),j.push("><ul>"),n.hideLabel||j.push(c._buliderLabelContainer(n,o)),j.push(c._buliderControlContainer(n,o,b.idPrev)),n.afterContent){var s=a.isFunction(n.afterContent)?n.afterContent(n):n.afterContent;s&&j.push(s)}n.hideSpace||j.push(c._buliderSpaceContainer(n,o)),j.push("</ul></li>"),h+=n.width||d.inputWidth||0,h+=n.space||d.space||0,h+=n.labelWidth||d.labelWidth||0,h>i&&(i=h)}}})}),k&&(j.push("</ul>"),k=!1),j.push("</div>"),e.append(j.join("")),!d.width||i>d.width,a(".l-group .togglebtn",e).remove(),a(".l-group",e).width(.95*e.width()).append("<div class='togglebtn'></div>")}},_createEditors:function(b){var c=this,d=this.options,e=b.fields,f=b.idPrev||c.id,g=b.editPrev||"";c.editors=c.editors||{},a(e).each(function(b,e){var h=a("#"+f+"\\|"+b,c.element).get(0),i=d.editors[e.type],j=g+b;if(h){h=a(h);var k=c._createEditor(i,h,{field:e},h.width(),h.height());k&&(c.editors[j]&&c.editors[j].control&&c.editors[j].control.destroy&&c.editors[j].control.destroy(),c.editors[j]={control:k,editor:i})}})},getChanges:function(){var a=this,b=(this.options,a.data),c=a.getData();a.data=b;var d={};for(var e in b)c[e]!=b[e]&&(d[e]=c[e]);return d},setEnabled:function(b,c){function d(b,d){a(b).each(function(b,g){var h=g.name,i=(g.textField,null==d?"":"tab"+d+"_"),j=f.editors[i+b];j&&h&&j.editor&&j.editor.setEnabled&&-1!=a.inArray(h,e)&&j.editor.setEnabled(j.control,c)})}var e=[];a.isArray(b)&&(e=b),"string"==typeof b&&e.push(b);var f=this,g=this.options;if(d(g.fields),g.tab&&g.tab.items)for(var h=0;h<g.tab.items.length;h++){var i=g.tab.items[h];d(i.fields,h)}},setVisible:function(b,c){function d(b,d){a(b).each(function(b,g){var h=g.name;-1!=a.inArray(h,e)&&f._setFieldPanelVisible(d,b,c)})}var e=[];a.isArray(b)&&(e=b),"string"==typeof b&&e.push(b);var f=this,g=this.options;if(d(g.fields),g.tab&&g.tab.items)for(var h=0;h<g.tab.items.length;h++){var i=g.tab.items[h];d(i.fields,h)}},_setFieldPanelVisible:function(b,c,d){var e=this;this.options;null==b?a("li.l-fieldcontainer[fieldindex="+c+"]",e.element)[d?"show":"hide"]():a("div.ui-tabs-panel[data-index="+b+"] li.l-fieldcontainer[fieldindex="+c+"]",e.element)[d?"show":"hide"]()},getData:function(){function b(b,d){a(b).each(function(a,b){var e=b.name,f=b.textField,g=null==d?"":"tab"+d+"_",h=c.editors[g+a];if(h){if(e){var i=h.editor.getValue(h.control,{field:b});c._setValueByName(c.data,e,i)}if(f){var i=h.editor.getText(h.control,{field:b});c._setValueByName(c.data,f,i)}}})}var c=this,d=this.options;if(c.data={},b(d.fields),d.tab&&d.tab.items)for(var e=0;e<d.tab.items.length;e++){var f=d.tab.items[e];b(f.fields,e)}return c.data},_setData:function(a){this.setData(a)},setData:function(b){function c(b,c){a(b).each(function(a,b){var e=b.name,f=b.textField,g=null==c?"":"tab"+c+"_",h=d.editors[g+a];if(h){if(e&&e in d.data){var i=d._getValueByName(d.data,e);h.editor.setValue(h.control,i,{field:b})}if(f&&f in d.data){var j=d._getValueByName(d.data,f);h.editor.setText(h.control,j,{field:b})}}})}var d=this,e=this.options;if(d.data=b||{},c(e.fields),e.tab&&e.tab.items)for(var f=0;f<e.tab.items.length;f++){var g=e.tab.items[f];c(g.fields,f)}},_setValueByName:function(a,b,c){if(!a||!b)return null;if(-1==b.indexOf("."))a[b]=c;else try{new Function("data,value","data."+b+"=value;")(a,c)}catch(d){}},_getValueByName:function(a,b){if(!a||!b)return null;if(-1==b.indexOf("."))return a[b];try{return new Function("data","return data."+b+";")(a)}catch(c){return null}},hideTip:function(){for(var b=this.options,c=b.fields,d=0;d<c.length;d++){var e=c[d].name;null!=c[d].comboboxName&&(e=c[d].comboboxName);var f=a("[name="+e+"]",this.element);f.zoeHideTip()}},valid:function(){var a=this;this.options;return a.form&&a.validator?a.form.valid():!0},showFieldError:function(b,c){var d=a("[name="+b+"]",this.element);d.hasClass("l-textarea")?d.addClass("l-textarea-invalid"):d.hasClass("l-text-field")&&d.parent().addClass("l-text-invalid"),a(d).removeAttr("title").zoeHideTip(),a(d).attr("title",c).zoeTip({distanceX:5,distanceY:-3,auto:!0})},hideFieldError:function(b){var c=a("[name="+b+"]",this.element);c.hasClass("l-textarea")?c.removeClass("l-textarea-invalid"):c.parent().removeClass("l-text-invalid"),a(c).removeAttr("title").zoeHideTip()},initValidate:function(){var b=this,c=this.options;if(!b.form||!c.validate||!b.form.validate)return void(b.validator=null);var d=1==c.validate?{}:c.validate,e=a.extend({errorPlacement:function(b,c){if(a(b).html()){if(!c.attr("id")){var d=(new Date).getTime();c.attr("id",d),b.attr("for",d)}c.hasClass("l-textarea")?c.addClass("l-textarea-invalid"):c.hasClass("l-text-field")&&c.parent().addClass("l-text-invalid"),a(c).removeAttr("title").zoeHideTip(),a(c).attr("title",a(b).html()).zoeTip({distanceX:5,distanceY:-3,auto:!0})}},success:function(b){var c=b.attr("for");if(c){var d=a("#"+c);d.hasClass("l-textarea")?d.removeClass("l-textarea-invalid"):d.parent().removeClass("l-text-invalid"),a(d).removeAttr("title").zoeHideTip()}}},d,{rules:b.validate.rules,messages:b.validate.messages});b.validator=b.form.validate(e)},setFieldValidate:function(b,c,d){var e=a("[name="+b+"]");if(e.length&&e.rules){var f=e.rules("remove");if(f&&(e.hasClass("l-text-field")&&e.parent().removeClass("l-text-invalid"),e.removeAttr("title").zoeHideTip(),f.required&&e.parents("li:first").next("li:first").find(".l-star").remove()),c){var g=a.extend({},c,{messages:d});e.rules("add",g),c.required&&e.parents("li:first").next("li:first").append('<span class="l-star">*</span>')}}},showInvalid:function(){var c=this,d=this.options;if(c.validator){var e=a('<div><div class="invalid">'+d.invalidMessage.replace("{errorCount}",c.validator.errorList.length)+'<a class="viewInvalidDetail" href="javascript:void(0)">'+d.detailMessage+'</a></div><div class="invalidDetail" style="display:none;">'+b(c.validator.errorList)+"</div></div>");e.find("a.viewInvalidDetail:first").bind("click",function(){a(this).parent().next("div.invalidDetail").toggle()}),a.zoeDialog.open({type:"error",width:350,showMax:!1,showToggle:!1,showMin:!1,target:e,buttons:[{text:d.okMessage,onclick:function(a,b){b.close()}}]})}},_createEditor:function(a,b,c,d,e){var f=this.options;try{var g=a.create.call(this,b,c,f);return g&&a.resize&&a.resize.call(this,g,d,e,c),g}catch(h){return null}},_buliderLabelContainer:function(a){var b=this.options,c=a.label||a.display,d=a.labelWidth||a.labelwidth||b.labelWidth,e=a.labelAlign||b.labelAlign;c&&(c+=a.rightToken||b.rightToken);var f=[];return f.push("<li"),b.labelCss&&f.push(' class="'+b.labelCss+'"'),f.push(' style="'),/px$/i.test(d)||/auto/i.test(d)||/%$/i.test(d)?f.push("width:"+d+";"):d&&f.push("width:"+d+"px;"),e&&f.push("text-align:"+e+";"),f.push('">'),c&&f.push(c),f.push("</li>"),f.join("")},_buliderControlContainer:function(a,b,c){var d=this,e=this.options,f=a.width||e.inputWidth,g=a.align||a.textAlign||a.textalign||e.align,h=[],c=c||d.id;return h.push("<li"),h.push(' id="'+(c+"|"+b)+'"'),e.fieldCss&&h.push(' class="'+e.fieldCss+'"'),h.push(' style="'),f&&h.push("width:"+f+"px;"),g&&h.push("text-align:"+g+";"),h.push('">'),h.push("</li>"),h.join("")},_buliderSpaceContainer:function(a){var b=this.options,c=a.space||a.spaceWidth||b.space;(0===a.space||0===a.spaceWidth)&&(c=0);var d=[];return d.push("<li"),b.spaceCss&&d.push(' class="'+b.spaceCss+'"'),d.push(' style="'),(/px$/i.test(c)||/auto/i.test(c)||/%$/i.test(c))&&d.push("width:"+c+";"),c&&d.push("width:"+c+"px;"),d.push('">'),a.validate&&a.validate.required&&d.push("<span class='l-star'>*</span>"),d.push("</li>"),d.join("")},_getInputAttrHtml:function(a){var b=[],c=(a.type||"text").toLowerCase();if("textarea"==c&&(a.cols&&b.push('cols="'+a.cols+'" '),a.rows&&b.push('rows="'+a.rows+'" ')),b.push('ltype="'+c+'" '),a.op&&b.push('op="'+a.op+'" '),a.vt&&b.push('vt="'+a.vt+'" '),a.attr)for(var d in a.attr)b.push(d+'="'+a.attr[d]+'" ');return b.join("")},_setTab:function(b){var c=this;this.options;if(b&&b.items){for(var d=a('<div class="l-form-tabs"></div>').appendTo(c.element),e=a('<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" original-title="">').appendTo(d),f=0;f<b.items.length;f++){var g=b.items[f],h=a('<li class="ui-state-default ui-corner-top"><a href="javascript:void(0)"></a></li>').appendTo(e),i=a('<div class="ui-tabs-panel ui-widget-content ui-corner-bottom">').appendTo(d),j=c.id+"|tdb"+f;h.add(i).attr("data-index",f),h.find("a:first").text(g.title),c._initFieldsValidate({fields:g.fields}),c._initFieldsHtml({panel:i,fields:g.fields,idPrev:j}),c._createEditors({fields:g.fields,idPrev:j,editPrev:"tab"+f+"_"})}e.find("li").hover(function(){a(this).addClass("ui-state-active")},function(){a(this).removeClass("ui-state-active")}).click(function(){var b=a(this).attr("data-index");c.selectTab(b)}),c.selectTab(0)}},selectTab:function(b){var c=this,d=(this.options,a(c.element).find(".l-form-tabs:first")),e=d.find(".ui-tabs-nav li"),f=d.find(".ui-tabs-panel");e.filter("[data-index="+b+"]").addClass("ui-tabs-selected ui-state-active ui-state-hover"),e.filter("[data-index!="+b+"]").removeClass("ui-tabs-selected ui-state-active ui-state-hover"),f.filter("[data-index="+b+"]").show(),f.filter("[data-index!="+b+"]").hide()}})}(jQuery),function(a){a.fn.zoePopupEdit=function(b){return a.zoeui.run.call(this,"zoePopupEdit",arguments)},a.fn.zoeGetPopupEditManager=function(){return a.zoeui.run.call(this,"zoeGetPopupEditManager",arguments)},a.zoeDefaults.PopupEdit={valueFieldID:null,css:null,onButtonClick:null,nullText:null,disabled:!1,cancelable:!0,width:200,heigth:null,render:null,split:";",grid:null,condition:null,valueField:"id",textField:"text",parms:null,onSelect:null,onSelected:null,valueFieldCssClass:null},a.zoeMethos.PopupEdit=a.zoeMethos.PopupEdit||{},a.zoeui.controls.PopupEdit=function(b,c){a.zoeui.controls.PopupEdit.base.constructor.call(this,b,c)},a.zoeui.controls.PopupEdit.zoeExtend(a.zoeui.controls.Input,{__getType:function(){return"PopupEdit"},_extendMethods:function(){return a.zoeMethos.PopupEdit},_init:function(){a.zoeui.controls.PopupEdit.base._init.call(this)},_render:function(){var b=this,c=this.options;b.inputText=null,"input"==this.element.tagName.toLowerCase()&&(this.element.readOnly=!0,b.inputText=a(this.element),b.textFieldID=this.element.id),void 0==b.inputText[0].name&&(b.inputText[0].name=b.textFieldID),b.valueField=null,c.valueFieldID?(b.valueField=a("#"+c.valueFieldID+":input"),0==b.valueField.length&&(b.valueField=a('<input type="hidden"/>')),b.valueField[0].id=b.valueField[0].name=c.valueFieldID):(b.valueField=a('<input type="hidden"/>'),b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"),void 0==b.valueField[0].name&&(b.valueField[0].name=b.valueField[0].id),c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass),b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),b.wrapper=b.inputText.wrap('<div class="l-text l-text-popup"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.wrapper.append(b.link),b.wrapper.append(b.valueField),b.valueField.attr("data-zoeid",b.id),b.inputText.addClass("l-text-field"),b.link.hover(function(){c.disabled||(this.className="l-trigger-hover")},function(){c.disabled||(this.className="l-trigger")}).mousedown(function(){c.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||(this.className="l-trigger-hover")}).click(function(){return c.disabled?void 0:0==b.trigger("buttonClick")?!1:void 0}),b.inputText.click(function(){c.disabled}).blur(function(){c.disabled||b.wrapper.removeClass("l-text-focus")}).focus(function(){c.disabled||b.wrapper.addClass("l-text-focus")}),b.wrapper.hover(function(){c.disabled||b.wrapper.addClass("l-text-over")},function(){c.disabled||b.wrapper.removeClass("l-text-over")}),b.set(c)},destroy:function(){this.wrapper&&this.wrapper.remove(),this.options=null,a.zoeui.remove(this)},clear:function(){var a=this;this.options;a.inputText.val(""),a.valueField.val("")},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(b){var c=this,d=this.options;!b&&c.unselect&&(c.unselect.remove(),c.unselect=null),(b||c.unselect)&&(c.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide(),c.wrapper.hover(function(){c.unselect.show()},function(){c.unselect.hide()}),!d.disabled&&d.cancelable&&c.wrapper.append(c.unselect),c.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){c.clear()}))},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setWidth:function(a){var b=this;a>20&&(b.wrapper.css({width:a}),b.inputText.css({width:a-20}))},_setHeight:function(a){var b=this;a>10&&(b.wrapper.height(a),b.inputText.height(a-2))},getData:function(){var b=this,c=this.options,d=[],e=a(b.valueField).val(),f=a(b.inputText).val(),g=e?e.split(c.split):null,h=f?f.split(c.split):null;return a(g).each(function(a){var b={};b[c.textField]=h[a],b[c.valueField]=g[a],d.push(b)}),d},_getText:function(){return a(this.inputText).val()},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},getText:function(){return this._getText()},setValue:function(a,b){var c=this;this.options;return arguments.length>=2?(c.setValue(a),void c.setText(b)):void c.valueField.val(a)},setText:function(a){var b=this,c=this.options;c.render?b.inputText.val(c.render(a)):b.inputText.val(a)},addValue:function(b,c){var d=this,e=this.options;if(b){var f=d.getValue(),g=d.getText();if(f){for(var h=[],i=[],j=f.split(e.split),b=b.split(e.split),c=c.split(e.split),k=0,l=b.length;l>k;k++)-1==a.inArray(b[k],j)&&(h.push(b[k]),i.push(c[k]));h.length&&(d.setValue(f+e.split+h.join(e.split)),d.setText(g+e.split+i.join(e.split)))}else d.setValue(b),d.setText(c)}},removeValue:function(b,c){var d=this,e=this.options;if(b){var f=d.getValue(),g=d.getText();if(f){for(var h=f.split(e.split),i=g.split(e.split),b=b.split(e.split),j=0,k=-1,l=b.length;l>j;j++)-1!=(k=a.inArray(b[j],h))&&(h.splice(k,1),i.splice(k,1));d.setValue(h.join(e.split)),d.setText(i.join(e.split))}}},_setGrid:function(b){if(b){var c=this,d=this.options,e=a.extend({parms:d.parms},d.grid);this.bind("buttonClick",function(){function b(){try{return c.getData()}catch(a){return null}}if(!c.popupFn){var f={grid:e,condition:d.condition,valueField:d.valueField,textField:d.textField,split:d.split,lastSelected:b(),onSelect:function(a){0!=c.trigger("select",a)&&(d.grid.checkbox?(c.addValue(a.value,a.text),c.removeValue(a.remvoeValue,a.remvoeText)):(c.setValue(a.value),c.setText(a.text)),c.trigger("selected",a))},selectInit:function(b){var e=c.getValue();return e&&d.valueField&&b[d.valueField]?-1!=a.inArray(b[d.valueField].toString(),e.split(d.split)):!1}};c.popupFn=a.zoeui.getPopupFn(f)}c.popupFn()})}}}),a.zoeui.getPopupFn=function(b){function c(){function c(a){return a=a||b.height,a-=j.height()}if(f)return g._showData(),f.show(),g.refreshSize(),void(i=g.selected.concat());var d=a("<div></div>"),j=a("<div></div>"),k=a("<div></div>");if(d.append(j).append(k),b.condition){var l=a.extend({labelWidth:60,space:20},b.condition);h=j.zoeForm(l)}else j.remove();var m=a.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0},b.grid,{width:"100%",height:c(),isChecked:b.selectInit,isSelected:b.selectInit,inWindow:!1});if(g=k.zoeGrid(m),b.condition){var n=a('<li style="margin-right:9px"><div></div></li>');a("ul:first",j).append(n).after('<div class="l-clear"></div>'),a("div",n).zoeButton({text:"搜索",click:function(){var b=a.zoeui.getConditions(j);g.setParm("condition",a.zoeui.toJSON(b)),g.reload()}})}f=a.zoeDialog.open({title:b.title,width:b.width,height:"auto",top:b.top,left:b.left,popupType:!0,target:d,isResize:!0,cls:"l-selectorwin",onContentHeightChange:function(a){return g.set("height",c(a)),!1},onStopResize:function(){g.refreshSize()},buttons:[{text:"选择",onclick:function(a,b){e(),b.hide()}},{text:"取消",onclick:function(a,b){b.hide()}}]}),g.refreshSize();try{var o=.5*(a(window).height()-a(f.element).height())+a(window).scrollTop()-10;a(f.element).css("top",o)}catch(p){return}}function d(a,c){for(var d=0;c&&c[d];d++){var e=c[d];if(e[b.valueField]==a)return!0}return!1}function e(){var c=g.selected||[],e=[],f=[],h=[];a(c).each(function(c,d){b.valueField&&e.push(d[b.valueField]),b.textField&&f.push(d[b.textField]);var i=a.extend(!0,{},this);g.formatRecord(i,!0),h.push(i)});var j=[];a(i).each(function(a,e){!d(e[b.valueField],c)&&d(e[b.valueField],g.rows)&&j.push(e)});var k=[],l=[],m=[];a(j).each(function(c,d){b.valueField&&k.push(d[b.valueField]),b.textField&&l.push(d[b.textField]);var e=a.extend(!0,{},this);g.formatRecord(e,!0),m.push(e)}),b.onSelect({value:e.join(b.split),text:f.join(b.split),data:h,remvoeValue:k.join(b.split),remvoeText:l.join(b.split),removeData:m})}if(b=a.extend({title:"选择数据",width:700,height:320,top:null,left:null,split:";",valueField:null,textField:null,grid:null,condition:null,onSelect:function(a){},selectInit:function(a){return!1}},b),b.grid){var f,g,h,i=b.lastSelected||[];return function(){return c(),!1}}}}(jQuery),function(a){a.fn.zoeToolBar=function(b){return a.zoeui.run.call(this,"zoeToolBar",arguments)},a.fn.zoeGetToolBarManager=function(){return a.zoeui.run.call(this,"zoeGetToolBarManager",arguments)},a.zoeDefaults.ToolBar={},a.zoeMethos.ToolBar={},a.zoeui.controls.ToolBar=function(b,c){a.zoeui.controls.ToolBar.base.constructor.call(this,b,c)},a.zoeui.controls.ToolBar.zoeExtend(a.zoeui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return a.zoeMethos.ToolBar},_render:function(){var b=this,c=this.options;b.toolbarItemCount=0,b.toolBar=a(this.element),b.toolBar.addClass("l-toolbar"),b.set(c)},_setItems:function(b){var c=this;c.toolBar.html(""),a(b).each(function(a,b){c.addItem(b)})},removeItem:function(b){var c=this;this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).remove()},setEnabled:function(b){var c=this;this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).removeClass("l-toolbar-item-disable")},setDisabled:function(b){var c=this;this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).addClass("l-toolbar-item-disable")},isEnable:function(b){var c=this;this.options;return!a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).hasClass("l-toolbar-item-disable")},addItem:function(b){var c=this;this.options;if(b.line||"line"==b.type)return void c.toolBar.append('<div class="l-bar-separator"></div>');if("text"==b.type)return void c.toolBar.append('<div class="l-toolbar-item l-toolbar-text"><span>'+b.text||"</span></div>");var d=a('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');c.toolBar.append(d),b.id||(b.id="item-"+ ++c.toolbarItemCount),d.attr("toolbarid",b.id),b.img?(d.append("<img src='"+b.img+"' />"),d.addClass("l-toolbar-item-hasicon")):b.icon?(d.append("<div class='l-icon l-icon-"+b.icon+"'></div>"),d.addClass("l-toolbar-item-hasicon")):b.color&&(d.append("<div class='l-toolbar-item-color' style='background:"+b.color+"'></div>"),d.addClass("l-toolbar-item-hasicon")),b.text&&a("span:first",d).html(b.text),b.disable&&d.addClass("l-toolbar-item-disable"),b.click&&d.click(function(){a(this).hasClass("l-toolbar-item-disable")||b.click(b)}),b.menu?(b.menu=a.zoeMenu(b.menu),d.hover(function(){if(!a(this).hasClass("l-toolbar-item-disable")){c.actionMenu&&c.actionMenu.hide();var d=a(this).offset().left,e=a(this).offset().top+a(this).height();b.menu.show({top:e,left:d}),c.actionMenu=b.menu,a(this).addClass("l-panel-btn-over")}},function(){a(this).hasClass("l-toolbar-item-disable")||a(this).removeClass("l-panel-btn-over")})):d.hover(function(){a(this).hasClass("l-toolbar-item-disable")||a(this).addClass("l-panel-btn-over")},function(){a(this).hasClass("l-toolbar-item-disable")||a(this).removeClass("l-panel-btn-over")})}}),a.zoeui.controls.ToolBar.prototype.setEnable=a.zoeui.controls.ToolBar.prototype.setEnabled,a.zoeui.controls.ToolBar.prototype.setDisable=a.zoeui.controls.ToolBar.prototype.setDisabled}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b=!1,c=!1,d=0,e=2e3,f=0,g=["webkit","ms","moz","o"],h=window.requestAnimationFrame||!1,i=window.cancelAnimationFrame||!1;if(!h)for(var j in g){var k=g[j];h||(h=window[k+"RequestAnimationFrame"]),i||(i=window[k+"CancelAnimationFrame"]||window[k+"CancelRequestAnimationFrame"])}var l=window.MutationObserver||window.WebKitMutationObserver||!1,m={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,railhoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:"auto",cursordragontouch:!1,oneaxismousemode:"auto",scriptpath:function(){var a=document.getElementsByTagName("script"),a=a.length?a[a.length-1].src.split("?")[0]:"";return 0<a.split("/").length?a.split("/").slice(0,-1).join("/")+"/":""}(),preventmultitouchscrolling:!0},n=!1,o=function(){if(n)return n;var a=document.createElement("DIV"),b=a.style,c=navigator.userAgent,d=navigator.platform,e={haspointerlock:"pointerLockElement"in document||"webkitPointerLockElement"in document||"mozPointerLockElement"in document};e.isopera="opera"in window,e.isopera12=e.isopera&&"getUserMedia"in navigator,e.isoperamini="[object OperaMini]"===Object.prototype.toString.call(window.operamini),e.isie="all"in document&&"attachEvent"in a&&!e.isopera,e.isieold=e.isie&&!("msInterpolationMode"in b),e.isie7=e.isie&&!e.isieold&&(!("documentMode"in document)||7==document.documentMode),e.isie8=e.isie&&"documentMode"in document&&8==document.documentMode,e.isie9=e.isie&&"performance"in window&&9<=document.documentMode,e.isie10=e.isie&&"performance"in window&&10==document.documentMode,e.isie11="msRequestFullscreen"in a&&11<=document.documentMode,e.isieedge=navigator.userAgent.match(/Edge\/12\./),e.isie9mobile=/iemobile.9/i.test(c),e.isie9mobile&&(e.isie9=!1),e.isie7mobile=!e.isie9mobile&&e.isie7&&/iemobile/i.test(c),e.ismozilla="MozAppearance"in b,e.iswebkit="WebkitAppearance"in b,e.ischrome="chrome"in window,e.ischrome22=e.ischrome&&e.haspointerlock,e.ischrome26=e.ischrome&&"transition"in b,e.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,e.hasmstouch=window.MSPointerEvent||!1,e.hasw3ctouch=(window.PointerEvent||!1)&&(0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints),e.ismac=/^mac$/i.test(d),e.isios=e.cantouch&&/iphone|ipad|ipod/i.test(d),e.isios4=e.isios&&!("seal"in Object),e.isios7=e.isios&&"webkitHidden"in document,e.isandroid=/android/i.test(c),e.haseventlistener="addEventListener"in a,e.trstyle=!1,e.hastransform=!1,e.hastranslate3d=!1,e.transitionstyle=!1,e.hastransition=!1,e.transitionend=!1,d=["transform","msTransform","webkitTransform","MozTransform","OTransform"];for(c=0;c<d.length;c++)if("undefined"!=typeof b[d[c]]){e.trstyle=d[c];break}e.hastransform=!!e.trstyle,e.hastransform&&(b[e.trstyle]="translate3d(1px,2px,3px)",e.hastranslate3d=/translate3d/.test(b[e.trstyle])),e.transitionstyle=!1,e.prefixstyle="",e.transitionend=!1;for(var d="transition webkitTransition msTransition MozTransition OTransition OTransition KhtmlTransition".split(" "),f=" -webkit- -ms- -moz- -o- -o -khtml-".split(" "),g="transitionend webkitTransitionEnd msTransitionEnd transitionend otransitionend oTransitionEnd KhtmlTransitionEnd".split(" "),c=0;c<d.length;c++)if(d[c]in b){e.transitionstyle=d[c],e.prefixstyle=f[c],e.transitionend=g[c];break}e.ischrome26&&(e.prefixstyle=f[1]),e.hastransition=e.transitionstyle;a:{for(c=["-webkit-grab","-moz-grab","grab"],(e.ischrome&&!e.ischrome22||e.isie)&&(c=[]),d=0;d<c.length;d++)if(f=c[d],b.cursor=f,b.cursor==f){b=f;break a}b="url(//mail.google.com/mail/images/2/openhand.cur),n-resize"}return e.cursorgrabvalue=b,e.hasmousecapture="setCapture"in a,e.hasMutationObserver=!1!==l,n=e},p=function(g,j){function k(){var a=t.doc.css(v.trstyle);return a&&"matrix"==a.substr(0,6)?a.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1}function n(){var a=t.win;if("zIndex"in a)return a.zIndex();for(;0<a.length&&9!=a[0].nodeType;){var b=a.css("zIndex");if(!isNaN(b)&&0!=b)return parseInt(b);a=a.parent()}return!1}function p(a,b,c){return b=a.css(b),a=parseFloat(b),isNaN(a)?(a=z[b]||0,c=3==a?c?t.win.outerHeight()-t.win.innerHeight():t.win.outerWidth()-t.win.innerWidth():1,t.isie8&&a&&(a+=1),c?a:0):a}function r(a,b,c,d){t._bind(a,b,function(d){d=d?d:window.event;var e={original:d,target:d.target||d.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==d.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return d.preventDefault?d.preventDefault():d.returnValue=!1,!1},stopImmediatePropagation:function(){d.stopImmediatePropagation?d.stopImmediatePropagation():d.cancelBubble=!0}};return"mousewheel"==b?(e.deltaY=-.025*d.wheelDelta,d.wheelDeltaX&&(e.deltaX=-.025*d.wheelDeltaX)):e.deltaY=d.detail,c.call(a,e)},d)}function s(a,b,c){var d,e;if(0==a.deltaMode?(d=-Math.floor(t.opt.mousescrollstep/54*a.deltaX),e=-Math.floor(t.opt.mousescrollstep/54*a.deltaY)):1==a.deltaMode&&(d=-Math.floor(a.deltaX*t.opt.mousescrollstep),e=-Math.floor(a.deltaY*t.opt.mousescrollstep)),b&&t.opt.oneaxismousemode&&0==d&&e&&(d=e,e=0,c&&(0>d?t.getScrollLeft()>=t.page.maxw:0>=t.getScrollLeft())&&(e=d,d=0)),d&&(t.scrollmom&&t.scrollmom.stop(),t.lastdeltax+=d,t.debounced("mousewheelx",function(){var a=t.lastdeltax;t.lastdeltax=0,t.rail.drag||t.doScrollLeftBy(a)},15)),e){if(t.opt.nativeparentscrolling&&c&&!t.ispage&&!t.zoomactive)if(0>e){if(t.getScrollTop()>=t.page.maxh)return!0}else if(0>=t.getScrollTop())return!0;t.scrollmom&&t.scrollmom.stop(),t.lastdeltay+=e,t.debounced("mousewheely",function(){var a=t.lastdeltay;t.lastdeltay=0,t.rail.drag||t.doScrollBy(a)},15);
}return a.stopImmediatePropagation(),a.preventDefault()}var t=this;if(this.version="3.6.6",this.name="nicescroll",this.me=j,this.opt={doc:a("body"),win:!1},a.extend(this.opt,m),this.opt.snapbackspeed=80,g)for(var u in t.opt)"undefined"!=typeof g[u]&&(t.opt[u]=g[u]);this.iddoc=(this.doc=t.opt.doc)&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/^BODY|HTML/.test(t.opt.win?t.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==t.opt.win,this.win=t.opt.win||(this.ispage?a(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?a(window):this.win,this.body=a("body"),this.iframe=this.isfixed=this.viewport=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=t.opt.autohidemode,this.page=this.view=this.onzoomout=this.onzoomin=this.onscrollcancel=this.onscrollend=this.onscrollstart=this.onclick=this.ongesturezoom=this.onkeypress=this.onmousewheel=this.onmousemove=this.onmouseup=this.onmousedown=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.isrtlmode="auto"==this.opt.rtlmode?"rtl"==(this.win[0]==window?this.body:this.win).css("direction"):!0===this.opt.rtlmode,this.observerbody=this.observerremover=this.observer=this.scrollmom=this.scrollrunning=!1;do this.id="ascrail"+e++;while(document.getElementById(this.id));this.hasmousefocus=this.hasfocus=this.zoomactive=this.zoom=this.selectiondrag=this.cursorfreezed=this.cursor=this.rail=!1,this.visibility=!0,this.hidden=this.locked=this.railslocked=!1,this.cursoractive=!0,this.wheelprevented=!1,this.overflowx=t.opt.overflowx,this.overflowy=t.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltay=this.lastdeltax=0,this.detected=o();var v=a.extend({},this.detected);this.ishwscroll=(this.canhwscroll=v.hastransform&&t.opt.hwacceleration)&&t.haswrapper,this.hasreversehr=this.isrtlmode&&!v.iswebkit,this.istouchcapable=!1,!v.cantouch||v.isios||v.isandroid||!v.iswebkit&&!v.ismozilla||(this.istouchcapable=!0,v.cantouch=!1),t.opt.enablemouselockapi||(v.hasmousecapture=!1,v.haspointerlock=!1),this.debounced=function(a,b,c){var d=t.delaylist[a];t.delaylist[a]=b,d||(t.debouncedelayed=setTimeout(function(){if(t){var b=t.delaylist[a];t.delaylist[a]=!1,b.call(t)}},c))};var w=!1;this.synched=function(a,b){return t.synclist[a]=b,function(){w||(h(function(){w=!1;for(var a in t.synclist){var b=t.synclist[a];b&&b.call(t),t.synclist[a]=!1}}),w=!0)}(),a},this.unsynched=function(a){t.synclist[a]&&(t.synclist[a]=!1)},this.css=function(a,b){for(var c in b)t.saved.css.push([a,c,a.css(c)]),a.css(c,b[c])},this.scrollTop=function(a){return"undefined"==typeof a?t.getScrollTop():t.setScrollTop(a)},this.scrollLeft=function(a){return"undefined"==typeof a?t.getScrollLeft():t.setScrollLeft(a)};var x=function(a,b,c,d,e,f,g){this.st=a,this.ed=b,this.spd=c,this.p1=d||0,this.p2=e||1,this.p3=f||0,this.p4=g||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st};if(x.prototype={B2:function(a){return 3*a*a*(1-a)},B3:function(a){return 3*a*(1-a)*(1-a)},B4:function(a){return(1-a)*(1-a)*(1-a)},getNow:function(){var a=1-((new Date).getTime()-this.ts)/this.spd,b=this.B2(a)+this.B3(a)+this.B4(a);return 0>a?this.ed:this.st+Math.round(this.df*b)},update:function(a,b){return this.st=this.getNow(),this.ed=a,this.spd=b,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},v.hastranslate3d&&v.isios&&this.doc.css("-webkit-backface-visibility","hidden"),this.getScrollTop=function(a){if(!a){if(a=k())return 16==a.length?-a[13]:-a[5];if(t.timerscroll&&t.timerscroll.bz)return t.timerscroll.bz.getNow()}return t.doc.translate.y},this.getScrollLeft=function(a){if(!a){if(a=k())return 16==a.length?-a[12]:-a[4];if(t.timerscroll&&t.timerscroll.bh)return t.timerscroll.bh.getNow()}return t.doc.translate.x},this.notifyScrollEvent=function(a){var b=document.createEvent("UIEvents");b.initUIEvent("scroll",!1,!0,window,1),b.niceevent=!0,a.dispatchEvent(b)};var y=this.isrtlmode?1:-1;v.hastranslate3d&&t.opt.enabletranslate3d?(this.setScrollTop=function(a,b){t.doc.translate.y=a,t.doc.translate.ty=-1*a+"px",t.doc.css(v.trstyle,"translate3d("+t.doc.translate.tx+","+t.doc.translate.ty+",0px)"),b||t.notifyScrollEvent(t.win[0])},this.setScrollLeft=function(a,b){t.doc.translate.x=a,t.doc.translate.tx=a*y+"px",t.doc.css(v.trstyle,"translate3d("+t.doc.translate.tx+","+t.doc.translate.ty+",0px)"),b||t.notifyScrollEvent(t.win[0])}):(this.setScrollTop=function(a,b){t.doc.translate.y=a,t.doc.translate.ty=-1*a+"px",t.doc.css(v.trstyle,"translate("+t.doc.translate.tx+","+t.doc.translate.ty+")"),b||t.notifyScrollEvent(t.win[0])},this.setScrollLeft=function(a,b){t.doc.translate.x=a,t.doc.translate.tx=a*y+"px",t.doc.css(v.trstyle,"translate("+t.doc.translate.tx+","+t.doc.translate.ty+")"),b||t.notifyScrollEvent(t.win[0])})}else this.getScrollTop=function(){return t.docscroll.scrollTop()},this.setScrollTop=function(a){return setTimeout(function(){t.docscroll.scrollTop(a)},1)},this.getScrollLeft=function(){return t.detected.ismozilla&&t.isrtlmode?Math.abs(t.docscroll.scrollLeft()):t.docscroll.scrollLeft()},this.setScrollLeft=function(a){return setTimeout(function(){t.docscroll.scrollLeft(t.detected.ismozilla&&t.isrtlmode?-a:a)},1)};this.getTarget=function(a){return a?a.target?a.target:a.srcElement?a.srcElement:!1:!1},this.hasParent=function(a,b){if(!a)return!1;for(var c=a.target||a.srcElement||a||!1;c&&c.id!=b;)c=c.parentNode||!1;return!1!==c};var z={thin:1,medium:3,thick:5};this.getDocumentScrollOffset=function(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}},this.getOffset=function(){if(t.isfixed){var a=t.win.offset(),b=t.getDocumentScrollOffset();return a.top-=b.top,a.left-=b.left,a}return a=t.win.offset(),t.viewport?(b=t.viewport.offset(),{top:a.top-b.top,left:a.left-b.left}):a},this.updateScrollBar=function(a){if(t.ishwscroll)t.rail.css({height:t.win.innerHeight()-(t.opt.railpadding.top+t.opt.railpadding.bottom)}),t.railh&&t.railh.css({width:t.win.innerWidth()-(t.opt.railpadding.left+t.opt.railpadding.right)});else{var b=t.getOffset(),c=b.top,d=b.left-(t.opt.railpadding.left+t.opt.railpadding.right),c=c+p(t.win,"border-top-width",!0),d=d+(t.rail.align?t.win.outerWidth()-p(t.win,"border-right-width")-t.rail.width:p(t.win,"border-left-width")),e=t.opt.railoffset;e&&(e.top&&(c+=e.top),e.left&&(d+=e.left)),t.railslocked||t.rail.css({top:c,left:d,height:(a?a.h:t.win.innerHeight())-(t.opt.railpadding.top+t.opt.railpadding.bottom)}),t.zoom&&t.zoom.css({top:c+1,left:1==t.rail.align?d-20:d+t.rail.width+4}),t.railh&&!t.railslocked&&(c=b.top,d=b.left,(e=t.opt.railhoffset)&&(e.top&&(c+=e.top),e.left&&(d+=e.left)),a=t.railh.align?c+p(t.win,"border-top-width",!0)+t.win.innerHeight()-t.railh.height:c+p(t.win,"border-top-width",!0),d+=p(t.win,"border-left-width"),t.railh.css({top:a-(t.opt.railpadding.top+t.opt.railpadding.bottom),left:d,width:t.railh.width}))}},this.doRailClick=function(a,b,c){var d;t.railslocked||(t.cancelEvent(a),b?(b=c?t.doScrollLeft:t.doScrollTop,d=c?(a.pageX-t.railh.offset().left-t.cursorwidth/2)*t.scrollratio.x:(a.pageY-t.rail.offset().top-t.cursorheight/2)*t.scrollratio.y,b(d)):(b=c?t.doScrollLeftBy:t.doScrollBy,d=c?t.scroll.x:t.scroll.y,a=c?a.pageX-t.railh.offset().left:a.pageY-t.rail.offset().top,c=c?t.view.w:t.view.h,b(d>=a?c:-c)))},t.hasanimationframe=h,t.hascancelanimationframe=i,t.hasanimationframe?t.hascancelanimationframe||(i=function(){t.cancelAnimationFrame=!0}):(h=function(a){return setTimeout(a,15-Math.floor(+new Date/1e3)%16)},i=clearInterval),this.init=function(){if(t.saved.css=[],v.isie7mobile||v.isoperamini)return!0;if(v.hasmstouch&&t.css(t.ispage?a("html"):t.win,{"-ms-touch-action":"none"}),t.zindex="auto",t.zindex=t.ispage||"auto"!=t.opt.zindex?t.opt.zindex:n()||"auto",!t.ispage&&"auto"!=t.zindex&&t.zindex>f&&(f=t.zindex),t.isie&&0==t.zindex&&"auto"==t.opt.zindex&&(t.zindex="auto"),!t.ispage||!v.cantouch&&!v.isieold&&!v.isie9mobile){var e=t.docscroll;t.ispage&&(e=t.haswrapper?t.win:t.doc),v.isie9mobile||t.css(e,{"overflow-y":"hidden"}),t.ispage&&v.isie7&&("BODY"==t.doc[0].nodeName?t.css(a("html"),{"overflow-y":"hidden"}):"HTML"==t.doc[0].nodeName&&t.css(a("body"),{"overflow-y":"hidden"})),!v.isios||t.ispage||t.haswrapper||t.css(a("body"),{"-webkit-overflow-scrolling":"touch"});var g=a(document.createElement("div"));g.css({position:"relative",top:0,"float":"right",width:t.opt.cursorwidth,height:"0px","background-color":t.opt.cursorcolor,border:t.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":t.opt.cursorborderradius,"-moz-border-radius":t.opt.cursorborderradius,"border-radius":t.opt.cursorborderradius}),g.hborder=parseFloat(g.outerHeight()-g.innerHeight()),g.addClass("nicescroll-cursors"),t.cursor=g;var h=a(document.createElement("div"));h.attr("id",t.id),h.addClass("nicescroll-rails nicescroll-rails-vr");var i,j,k,m=["left","right","top","bottom"];for(k in m)j=m[k],(i=t.opt.railpadding[j])?h.css("padding-"+j,i+"px"):t.opt.railpadding[j]=0;h.append(g),h.width=Math.max(parseFloat(t.opt.cursorwidth),g.outerWidth()),h.css({width:h.width+"px",zIndex:t.zindex,background:t.opt.background,cursor:"default"}),h.visibility=!0,h.scrollable=!0,h.align="left"==t.opt.railalign?0:1,t.rail=h,g=t.rail.drag=!1,!t.opt.boxzoom||t.ispage||v.isieold||(g=document.createElement("div"),t.bind(g,"click",t.doZoom),t.bind(g,"mouseenter",function(){t.zoom.css("opacity",t.opt.cursoropacitymax)}),t.bind(g,"mouseleave",function(){t.zoom.css("opacity",t.opt.cursoropacitymin)}),t.zoom=a(g),t.zoom.css({cursor:"pointer","z-index":t.zindex,backgroundImage:"url("+t.opt.scriptpath+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),t.opt.dblclickzoom&&t.bind(t.win,"dblclick",t.doZoom),v.cantouch&&t.opt.gesturezoom&&(t.ongesturezoom=function(a){return 1.5<a.scale&&t.doZoomIn(a),.8>a.scale&&t.doZoomOut(a),t.cancelEvent(a)},t.bind(t.win,"gestureend",t.ongesturezoom))),t.railh=!1;var o;if(t.opt.horizrailenabled&&(t.css(e,{"overflow-x":"hidden"}),g=a(document.createElement("div")),g.css({position:"absolute",top:0,height:t.opt.cursorwidth,width:"0px","background-color":t.opt.cursorcolor,border:t.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":t.opt.cursorborderradius,"-moz-border-radius":t.opt.cursorborderradius,"border-radius":t.opt.cursorborderradius}),v.isieold&&g.css({overflow:"hidden"}),g.wborder=parseFloat(g.outerWidth()-g.innerWidth()),g.addClass("nicescroll-cursors"),t.cursorh=g,o=a(document.createElement("div")),o.attr("id",t.id+"-hr"),o.addClass("nicescroll-rails nicescroll-rails-hr"),o.height=Math.max(parseFloat(t.opt.cursorwidth),g.outerHeight()),o.css({height:o.height+"px",zIndex:t.zindex,background:t.opt.background}),o.append(g),o.visibility=!0,o.scrollable=!0,o.align="top"==t.opt.railvalign?0:1,t.railh=o,t.railh.drag=!1),t.ispage?(h.css({position:"fixed",top:"0px",height:"100%"}),h.align?h.css({right:"0px"}):h.css({left:"0px"}),t.body.append(h),t.railh&&(o.css({position:"fixed",left:"0px",width:"100%"}),o.align?o.css({bottom:"0px"}):o.css({top:"0px"}),t.body.append(o))):(t.ishwscroll?("static"==t.win.css("position")&&t.css(t.win,{position:"relative"}),e="HTML"==t.win[0].nodeName?t.body:t.win,a(e).scrollTop(0).scrollLeft(0),t.zoom&&(t.zoom.css({position:"absolute",top:1,right:0,"margin-right":h.width+4}),e.append(t.zoom)),h.css({position:"absolute",top:0}),h.align?h.css({right:0}):h.css({left:0}),e.append(h),o&&(o.css({position:"absolute",left:0,bottom:0}),o.align?o.css({bottom:0}):o.css({top:0}),e.append(o))):(t.isfixed="fixed"==t.win.css("position"),e=t.isfixed?"fixed":"absolute",t.isfixed||(t.viewport=t.getViewport(t.win[0])),t.viewport&&(t.body=t.viewport,0==/fixed|absolute/.test(t.viewport.css("position"))&&t.css(t.viewport,{position:"relative"})),h.css({position:e}),t.zoom&&t.zoom.css({position:e}),t.updateScrollBar(),t.body.append(h),t.zoom&&t.body.append(t.zoom),t.railh&&(o.css({position:e}),t.body.append(o))),v.isios&&t.css(t.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),v.isie&&t.opt.disableoutline&&t.win.attr("hideFocus","true"),v.iswebkit&&t.opt.disableoutline&&t.win.css({outline:"none"})),!1===t.opt.autohidemode?(t.autohidedom=!1,t.rail.css({opacity:t.opt.cursoropacitymax}),t.railh&&t.railh.css({opacity:t.opt.cursoropacitymax})):!0===t.opt.autohidemode||"leave"===t.opt.autohidemode?(t.autohidedom=a().add(t.rail),v.isie8&&(t.autohidedom=t.autohidedom.add(t.cursor)),t.railh&&(t.autohidedom=t.autohidedom.add(t.railh)),t.railh&&v.isie8&&(t.autohidedom=t.autohidedom.add(t.cursorh))):"scroll"==t.opt.autohidemode?(t.autohidedom=a().add(t.rail),t.railh&&(t.autohidedom=t.autohidedom.add(t.railh))):"cursor"==t.opt.autohidemode?(t.autohidedom=a().add(t.cursor),t.railh&&(t.autohidedom=t.autohidedom.add(t.cursorh))):"hidden"==t.opt.autohidemode&&(t.autohidedom=!1,t.hide(),t.railslocked=!1),v.isie9mobile)t.scrollmom=new q(t),t.onmangotouch=function(){var a=t.getScrollTop(),b=t.getScrollLeft();if(a==t.scrollmom.lastscrolly&&b==t.scrollmom.lastscrollx)return!0;var c=a-t.mangotouch.sy,d=b-t.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(c,2)))){var e=0>c?-1:1,f=0>d?-1:1,g=+new Date;t.mangotouch.lazy&&clearTimeout(t.mangotouch.lazy),80<g-t.mangotouch.tm||t.mangotouch.dry!=e||t.mangotouch.drx!=f?(t.scrollmom.stop(),t.scrollmom.reset(b,a),t.mangotouch.sy=a,t.mangotouch.ly=a,t.mangotouch.sx=b,t.mangotouch.lx=b,t.mangotouch.dry=e,t.mangotouch.drx=f,t.mangotouch.tm=g):(t.scrollmom.stop(),t.scrollmom.update(t.mangotouch.sx-d,t.mangotouch.sy-c),t.mangotouch.tm=g,c=Math.max(Math.abs(t.mangotouch.ly-a),Math.abs(t.mangotouch.lx-b)),t.mangotouch.ly=a,t.mangotouch.lx=b,c>2&&(t.mangotouch.lazy=setTimeout(function(){t.mangotouch.lazy=!1,t.mangotouch.dry=0,t.mangotouch.drx=0,t.mangotouch.tm=0,t.scrollmom.doMomentum(30)},100)))}},h=t.getScrollTop(),o=t.getScrollLeft(),t.mangotouch={sy:h,ly:h,dry:0,sx:o,lx:o,drx:0,lazy:!1,tm:0},t.bind(t.docscroll,"scroll",t.onmangotouch);else{if(v.cantouch||t.istouchcapable||t.opt.touchbehavior||v.hasmstouch){t.scrollmom=new q(t),t.ontouchstart=function(b){if(b.pointerType&&2!=b.pointerType&&"touch"!=b.pointerType)return!1;if(t.hasmoving=!1,!t.railslocked){var c;if(v.hasmstouch)for(c=b.target?b.target:!1;c;){var d=a(c).getNiceScroll();if(0<d.length&&d[0].me==t.me)break;if(0<d.length)return!1;if("DIV"==c.nodeName&&c.id==t.id)break;c=c.parentNode?c.parentNode:!1}if(t.cancelScroll(),(c=t.getTarget(b))&&/INPUT/i.test(c.nodeName)&&/range/i.test(c.type))return t.stopPropagation(b);if(!("clientX"in b)&&"changedTouches"in b&&(b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY),t.forcescreen&&(d=b,b={original:b.original?b.original:b},b.clientX=d.screenX,b.clientY=d.screenY),t.rail.drag={x:b.clientX,y:b.clientY,sx:t.scroll.x,sy:t.scroll.y,st:t.getScrollTop(),sl:t.getScrollLeft(),pt:2,dl:!1},t.ispage||!t.opt.directionlockdeadzone)t.rail.drag.dl="f";else{var d=a(window).width(),e=a(window).height(),e=Math.max(0,Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-e),d=Math.max(0,Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)-d);t.rail.drag.ck=!t.rail.scrollable&&t.railh.scrollable?e>0?"v":!1:t.rail.scrollable&&!t.railh.scrollable&&d>0?"h":!1,t.rail.drag.ck||(t.rail.drag.dl="f")}if(t.opt.touchbehavior&&t.isiframe&&v.isie&&(d=t.win.position(),t.rail.drag.x+=d.left,t.rail.drag.y+=d.top),t.hasmoving=!1,t.lastmouseup=!1,t.scrollmom.reset(b.clientX,b.clientY),!v.cantouch&&!this.istouchcapable&&!b.pointerType){if(!c||!/INPUT|SELECT|TEXTAREA/i.test(c.nodeName))return!t.ispage&&v.hasmousecapture&&c.setCapture(),t.opt.touchbehavior?(c.onclick&&!c._onclick&&(c._onclick=c.onclick,c.onclick=function(a){return t.hasmoving?!1:void c._onclick.call(this,a)}),t.cancelEvent(b)):t.stopPropagation(b);/SUBMIT|CANCEL|BUTTON/i.test(a(c).attr("type"))&&(pc={tg:c,click:!1},t.preventclick=pc)}}},t.ontouchend=function(a){if(!t.rail.drag)return!0;if(2==t.rail.drag.pt){if(a.pointerType&&2!=a.pointerType&&"touch"!=a.pointerType)return!1;if(t.scrollmom.doMomentum(),t.rail.drag=!1,t.hasmoving&&(t.lastmouseup=!0,t.hideCursor(),v.hasmousecapture&&document.releaseCapture(),!v.cantouch))return t.cancelEvent(a)}else if(1==t.rail.drag.pt)return t.onmouseup(a)};var p=t.opt.touchbehavior&&t.isiframe&&!v.hasmousecapture;t.ontouchmove=function(b,c){if(!t.rail.drag||b.targetTouches&&t.opt.preventmultitouchscrolling&&1<b.targetTouches.length||b.pointerType&&2!=b.pointerType&&"touch"!=b.pointerType)return!1;if(2==t.rail.drag.pt){if(v.cantouch&&v.isios&&"undefined"==typeof b.original)return!0;if(t.hasmoving=!0,t.preventclick&&!t.preventclick.click&&(t.preventclick.click=t.preventclick.tg.onclick||!1,t.preventclick.tg.onclick=t.onpreventclick),b=a.extend({original:b},b),"changedTouches"in b&&(b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY),t.forcescreen){var d=b;b={original:b.original?b.original:b},b.clientX=d.screenX,b.clientY=d.screenY}var e,d=e=0;p&&!c&&(e=t.win.position(),d=-e.left,e=-e.top);var f=b.clientY+e;e=f-t.rail.drag.y;var g=b.clientX+d,h=g-t.rail.drag.x,i=t.rail.drag.st-e;t.ishwscroll&&t.opt.bouncescroll?0>i?i=Math.round(i/2):i>t.page.maxh&&(i=t.page.maxh+Math.round((i-t.page.maxh)/2)):(0>i&&(f=i=0),i>t.page.maxh&&(i=t.page.maxh,f=0));var j;if(t.railh&&t.railh.scrollable&&(j=t.isrtlmode?h-t.rail.drag.sl:t.rail.drag.sl-h,t.ishwscroll&&t.opt.bouncescroll?0>j?j=Math.round(j/2):j>t.page.maxw&&(j=t.page.maxw+Math.round((j-t.page.maxw)/2)):(0>j&&(g=j=0),j>t.page.maxw&&(j=t.page.maxw,g=0))),d=!1,t.rail.drag.dl)d=!0,"v"==t.rail.drag.dl?j=t.rail.drag.sl:"h"==t.rail.drag.dl&&(i=t.rail.drag.st);else{e=Math.abs(e);var h=Math.abs(h),k=t.opt.directionlockdeadzone;if("v"==t.rail.drag.ck){if(e>k&&.3*e>=h)return t.rail.drag=!1,!0;h>k&&(t.rail.drag.dl="f",a("body").scrollTop(a("body").scrollTop()))}else if("h"==t.rail.drag.ck){if(h>k&&.3*h>=e)return t.rail.drag=!1,!0;e>k&&(t.rail.drag.dl="f",a("body").scrollLeft(a("body").scrollLeft()))}}if(t.synched("touchmove",function(){t.rail.drag&&2==t.rail.drag.pt&&(t.prepareTransition&&t.prepareTransition(0),t.rail.scrollable&&t.setScrollTop(i),t.scrollmom.update(g,f),t.railh&&t.railh.scrollable?(t.setScrollLeft(j),t.showCursor(i,j)):t.showCursor(i),v.isie10&&document.selection.clear())}),v.ischrome&&t.istouchcapable&&(d=!1),d)return t.cancelEvent(b)}else if(1==t.rail.drag.pt)return t.onmousemove(b)}}if(t.onmousedown=function(a,b){if(!t.rail.drag||1==t.rail.drag.pt){if(t.railslocked)return t.cancelEvent(a);t.cancelScroll(),t.rail.drag={x:a.clientX,y:a.clientY,sx:t.scroll.x,sy:t.scroll.y,pt:1,hr:!!b};var c=t.getTarget(a);return!t.ispage&&v.hasmousecapture&&c.setCapture(),t.isiframe&&!v.hasmousecapture&&(t.saved.csspointerevents=t.doc.css("pointer-events"),t.css(t.doc,{"pointer-events":"none"})),t.hasmoving=!1,t.cancelEvent(a)}},t.onmouseup=function(a){return t.rail.drag?1!=t.rail.drag.pt?!0:(v.hasmousecapture&&document.releaseCapture(),t.isiframe&&!v.hasmousecapture&&t.doc.css("pointer-events",t.saved.csspointerevents),t.rail.drag=!1,t.hasmoving&&t.triggerScrollEnd(),t.cancelEvent(a)):void 0},t.onmousemove=function(a){if(t.rail.drag){if(1==t.rail.drag.pt){if(v.ischrome&&0==a.which)return t.onmouseup(a);if(t.cursorfreezed=!0,t.hasmoving=!0,t.rail.drag.hr){t.scroll.x=t.rail.drag.sx+(a.clientX-t.rail.drag.x),0>t.scroll.x&&(t.scroll.x=0);var b=t.scrollvaluemaxw;t.scroll.x>b&&(t.scroll.x=b)}else t.scroll.y=t.rail.drag.sy+(a.clientY-t.rail.drag.y),0>t.scroll.y&&(t.scroll.y=0),b=t.scrollvaluemax,t.scroll.y>b&&(t.scroll.y=b);return t.synched("mousemove",function(){t.rail.drag&&1==t.rail.drag.pt&&(t.showCursor(),t.rail.drag.hr?t.hasreversehr?t.doScrollLeft(t.scrollvaluemaxw-Math.round(t.scroll.x*t.scrollratio.x),t.opt.cursordragspeed):t.doScrollLeft(Math.round(t.scroll.x*t.scrollratio.x),t.opt.cursordragspeed):t.doScrollTop(Math.round(t.scroll.y*t.scrollratio.y),t.opt.cursordragspeed))}),t.cancelEvent(a)}}else t.checkarea=0},v.cantouch||t.opt.touchbehavior)t.onpreventclick=function(a){return t.preventclick?(t.preventclick.tg.onclick=t.preventclick.click,t.preventclick=!1,t.cancelEvent(a)):void 0},t.bind(t.win,"mousedown",t.ontouchstart),t.onclick=v.isios?!1:function(a){return t.lastmouseup?(t.lastmouseup=!1,t.cancelEvent(a)):!0},t.opt.grabcursorenabled&&v.cursorgrabvalue&&(t.css(t.ispage?t.doc:t.win,{cursor:v.cursorgrabvalue}),t.css(t.rail,{cursor:v.cursorgrabvalue}));else{var r=function(a){if(t.selectiondrag){if(a){var b=t.win.outerHeight();a=a.pageY-t.selectiondrag.top,a>0&&b>a&&(a=0),a>=b&&(a-=b),t.selectiondrag.df=a}0!=t.selectiondrag.df&&(t.doScrollBy(2*-Math.floor(t.selectiondrag.df/6)),t.debounced("doselectionscroll",function(){r()},50))}};t.hasTextSelected="getSelection"in document?function(){return 0<document.getSelection().rangeCount}:"selection"in document?function(){return"None"!=document.selection.type}:function(){return!1},t.onselectionstart=function(a){t.ispage||(t.selectiondrag=t.win.offset())},t.onselectionend=function(a){t.selectiondrag=!1},t.onselectiondrag=function(a){t.selectiondrag&&t.hasTextSelected()&&t.debounced("selectionscroll",function(){r(a)},250)}}v.hasw3ctouch?(t.css(t.rail,{"touch-action":"none"}),t.css(t.cursor,{"touch-action":"none"}),t.bind(t.win,"pointerdown",t.ontouchstart),t.bind(document,"pointerup",t.ontouchend),t.bind(document,"pointermove",t.ontouchmove)):v.hasmstouch?(t.css(t.rail,{"-ms-touch-action":"none"}),t.css(t.cursor,{"-ms-touch-action":"none"}),t.bind(t.win,"MSPointerDown",t.ontouchstart),t.bind(document,"MSPointerUp",t.ontouchend),t.bind(document,"MSPointerMove",t.ontouchmove),t.bind(t.cursor,"MSGestureHold",function(a){a.preventDefault()}),t.bind(t.cursor,"contextmenu",function(a){a.preventDefault()})):this.istouchcapable&&(t.bind(t.win,"touchstart",t.ontouchstart),t.bind(document,"touchend",t.ontouchend),t.bind(document,"touchcancel",t.ontouchend),t.bind(document,"touchmove",t.ontouchmove)),(t.opt.cursordragontouch||!v.cantouch&&!t.opt.touchbehavior)&&(t.rail.css({cursor:"default"}),t.railh&&t.railh.css({cursor:"default"}),t.jqbind(t.rail,"mouseenter",function(){return t.ispage||t.win.is(":visible")?(t.canshowonmouseevent&&t.showCursor(),void(t.rail.active=!0)):!1}),t.jqbind(t.rail,"mouseleave",function(){t.rail.active=!1,t.rail.drag||t.hideCursor()}),t.opt.sensitiverail&&(t.bind(t.rail,"click",function(a){t.doRailClick(a,!1,!1)}),t.bind(t.rail,"dblclick",function(a){t.doRailClick(a,!0,!1)}),t.bind(t.cursor,"click",function(a){t.cancelEvent(a)}),t.bind(t.cursor,"dblclick",function(a){t.cancelEvent(a)})),t.railh&&(t.jqbind(t.railh,"mouseenter",function(){return t.ispage||t.win.is(":visible")?(t.canshowonmouseevent&&t.showCursor(),void(t.rail.active=!0)):!1}),t.jqbind(t.railh,"mouseleave",function(){t.rail.active=!1,t.rail.drag||t.hideCursor()}),t.opt.sensitiverail&&(t.bind(t.railh,"click",function(a){t.doRailClick(a,!1,!0)}),t.bind(t.railh,"dblclick",function(a){t.doRailClick(a,!0,!0)}),t.bind(t.cursorh,"click",function(a){t.cancelEvent(a)}),t.bind(t.cursorh,"dblclick",function(a){t.cancelEvent(a)})))),v.cantouch||t.opt.touchbehavior?(t.bind(v.hasmousecapture?t.win:document,"mouseup",t.ontouchend),t.bind(document,"mousemove",t.ontouchmove),t.onclick&&t.bind(document,"click",t.onclick),t.opt.cursordragontouch&&(t.bind(t.cursor,"mousedown",t.onmousedown),t.bind(t.cursor,"mouseup",t.onmouseup),t.cursorh&&t.bind(t.cursorh,"mousedown",function(a){t.onmousedown(a,!0)}),t.cursorh&&t.bind(t.cursorh,"mouseup",t.onmouseup))):(t.bind(v.hasmousecapture?t.win:document,"mouseup",t.onmouseup),t.bind(document,"mousemove",t.onmousemove),t.onclick&&t.bind(document,"click",t.onclick),t.bind(t.cursor,"mousedown",t.onmousedown),t.bind(t.cursor,"mouseup",t.onmouseup),t.railh&&(t.bind(t.cursorh,"mousedown",function(a){t.onmousedown(a,!0)}),t.bind(t.cursorh,"mouseup",t.onmouseup)),!t.ispage&&t.opt.enablescrollonselection&&(t.bind(t.win[0],"mousedown",t.onselectionstart),t.bind(document,"mouseup",t.onselectionend),t.bind(t.cursor,"mouseup",t.onselectionend),t.cursorh&&t.bind(t.cursorh,"mouseup",t.onselectionend),t.bind(document,"mousemove",t.onselectiondrag)),t.zoom&&(t.jqbind(t.zoom,"mouseenter",function(){t.canshowonmouseevent&&t.showCursor(),t.rail.active=!0}),t.jqbind(t.zoom,"mouseleave",function(){t.rail.active=!1,t.rail.drag||t.hideCursor()}))),t.opt.enablemousewheel&&(t.isiframe||t.bind(v.isie&&t.ispage?document:t.win,"mousewheel",t.onmousewheel),t.bind(t.rail,"mousewheel",t.onmousewheel),t.railh&&t.bind(t.railh,"mousewheel",t.onmousewheelhr)),t.ispage||v.cantouch||/HTML|^BODY/.test(t.win[0].nodeName)||(t.win.attr("tabindex")||t.win.attr({tabindex:d++}),t.jqbind(t.win,"focus",function(a){b=t.getTarget(a).id||!0,t.hasfocus=!0,t.canshowonmouseevent&&t.noticeCursor()}),t.jqbind(t.win,"blur",function(a){b=!1,t.hasfocus=!1}),t.jqbind(t.win,"mouseenter",function(a){c=t.getTarget(a).id||!0,t.hasmousefocus=!0,t.canshowonmouseevent&&t.noticeCursor()}),t.jqbind(t.win,"mouseleave",function(){c=!1,t.hasmousefocus=!1,t.rail.drag||t.hideCursor()}))}if(t.onkeypress=function(d){if(t.railslocked&&0==t.page.maxh)return!0;d=d?d:window.e;var e=t.getTarget(d);if(e&&/INPUT|TEXTAREA|SELECT|OPTION/.test(e.nodeName)&&(!e.getAttribute("type")&&!e.type||!/submit|button|cancel/i.tp)||a(e).attr("contenteditable"))return!0;if(t.hasfocus||t.hasmousefocus&&!b||t.ispage&&!b&&!c){if(e=d.keyCode,t.railslocked&&27!=e)return t.cancelEvent(d);var f=d.ctrlKey||!1,g=d.shiftKey||!1,h=!1;switch(e){case 38:case 63233:t.doScrollBy(72),h=!0;break;case 40:case 63235:t.doScrollBy(-72),h=!0;break;case 37:case 63232:t.railh&&(f?t.doScrollLeft(0):t.doScrollLeftBy(72),h=!0);break;case 39:case 63234:t.railh&&(f?t.doScrollLeft(t.page.maxw):t.doScrollLeftBy(-72),h=!0);break;case 33:case 63276:t.doScrollBy(t.view.h),h=!0;break;case 34:case 63277:t.doScrollBy(-t.view.h),h=!0;break;case 36:case 63273:t.railh&&f?t.doScrollPos(0,0):t.doScrollTo(0),h=!0;break;case 35:case 63275:t.railh&&f?t.doScrollPos(t.page.maxw,t.page.maxh):t.doScrollTo(t.page.maxh),h=!0;break;case 32:t.opt.spacebarenabled&&(g?t.doScrollBy(t.view.h):t.doScrollBy(-t.view.h),h=!0);break;case 27:t.zoomactive&&(t.doZoom(),h=!0)}if(h)return t.cancelEvent(d)}},t.opt.enablekeyboard&&t.bind(document,v.isopera&&!v.isopera12?"keypress":"keydown",t.onkeypress),t.bind(document,"keydown",function(a){a.ctrlKey&&(t.wheelprevented=!0)}),t.bind(document,"keyup",function(a){a.ctrlKey||(t.wheelprevented=!1)}),t.bind(window,"blur",function(a){t.wheelprevented=!1}),t.bind(window,"resize",t.lazyResize),t.bind(window,"orientationchange",t.lazyResize),t.bind(window,"load",t.lazyResize),v.ischrome&&!t.ispage&&!t.haswrapper){var s=t.win.attr("style"),h=parseFloat(t.win.css("width"))+1;t.win.css("width",h),t.synched("chromefix",function(){t.win.attr("style",s)})}t.onAttributeChange=function(a){t.lazyResize(t.isieold?250:30)},!1!==l&&(t.observerbody=new l(function(b){return b.forEach(function(b){return"attributes"==b.type?a("body").hasClass("modal-open")&&!a.contains(a(".modal-dialog")[0],t.doc[0])?t.hide():t.show():void 0}),document.body.scrollHeight!=t.page.maxh?t.lazyResize(30):void 0}),t.observerbody.observe(document.body,{childList:!0,subtree:!0,characterData:!1,attributes:!0,attributeFilter:["class"]})),t.ispage||t.haswrapper||(!1!==l?(t.observer=new l(function(a){a.forEach(t.onAttributeChange)}),t.observer.observe(t.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),t.observerremover=new l(function(a){a.forEach(function(a){if(0<a.removedNodes.length)for(var b in a.removedNodes)if(t&&a.removedNodes[b]==t.win[0])return t.remove()})}),t.observerremover.observe(t.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(t.bind(t.win,v.isie&&!v.isie9?"propertychange":"DOMAttrModified",t.onAttributeChange),v.isie9&&t.win[0].attachEvent("onpropertychange",t.onAttributeChange),t.bind(t.win,"DOMNodeRemoved",function(a){a.target==t.win[0]&&t.remove()}))),!t.ispage&&t.opt.boxzoom&&t.bind(window,"resize",t.resizeZoom),t.istextarea&&(t.bind(t.win,"keydown",t.lazyResize),t.bind(t.win,"mouseup",t.lazyResize)),t.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var u=function(){t.iframexd=!1;var b;try{b="contentDocument"in this?this.contentDocument:this.contentWindow.document}catch(c){t.iframexd=!0,b=!1}if(t.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;if(t.forcescreen=!0,t.isiframe&&(t.iframe={doc:a(b),html:t.doc.contents().find("html")[0],body:t.doc.contents().find("body")[0]},t.getContentSize=function(){return{w:Math.max(t.iframe.html.scrollWidth,t.iframe.body.scrollWidth),h:Math.max(t.iframe.html.scrollHeight,t.iframe.body.scrollHeight)}},t.docscroll=a(t.iframe.body)),!v.isios&&t.opt.iframeautoresize&&!t.isiframe){t.win.scrollTop(0),t.doc.height("");var d=Math.max(b.getElementsByTagName("html")[0].scrollHeight,b.body.scrollHeight);t.doc.height(d)}t.lazyResize(30),v.isie7&&t.css(a(t.iframe.html),{"overflow-y":"hidden"}),t.css(a(t.iframe.body),{"overflow-y":"hidden"}),v.isios&&t.haswrapper&&t.css(a(b.body),{"-webkit-transform":"translate3d(0,0,0)"}),"contentWindow"in this?t.bind(this.contentWindow,"scroll",t.onscroll):t.bind(b,"scroll",t.onscroll),t.opt.enablemousewheel&&t.bind(b,"mousewheel",t.onmousewheel),t.opt.enablekeyboard&&t.bind(b,v.isopera?"keypress":"keydown",t.onkeypress),(v.cantouch||t.opt.touchbehavior)&&(t.bind(b,"mousedown",t.ontouchstart),t.bind(b,"mousemove",function(a){return t.ontouchmove(a,!0)}),t.opt.grabcursorenabled&&v.cursorgrabvalue&&t.css(a(b.body),{cursor:v.cursorgrabvalue})),t.bind(b,"mouseup",t.ontouchend),t.zoom&&(t.opt.dblclickzoom&&t.bind(b,"dblclick",t.doZoom),t.ongesturezoom&&t.bind(b,"gestureend",t.ongesturezoom))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){u.call(t.doc[0],!1)},500),t.bind(this.doc,"load",u)}},this.showCursor=function(a,b){if(t.cursortimeout&&(clearTimeout(t.cursortimeout),t.cursortimeout=0),t.rail){if(t.autohidedom&&(t.autohidedom.stop().css({opacity:t.opt.cursoropacitymax}),t.cursoractive=!0),t.rail.drag&&1==t.rail.drag.pt||("undefined"!=typeof a&&!1!==a&&(t.scroll.y=Math.round(1*a/t.scrollratio.y)),"undefined"!=typeof b&&(t.scroll.x=Math.round(1*b/t.scrollratio.x))),t.cursor.css({height:t.cursorheight,top:t.scroll.y}),t.cursorh){var c=t.hasreversehr?t.scrollvaluemaxw-t.scroll.x:t.scroll.x;!t.rail.align&&t.rail.visibility?t.cursorh.css({width:t.cursorwidth,left:c+t.rail.width}):t.cursorh.css({width:t.cursorwidth,left:c}),t.cursoractive=!0}t.zoom&&t.zoom.stop().css({opacity:t.opt.cursoropacitymax})}},this.hideCursor=function(a){t.cursortimeout||!t.rail||!t.autohidedom||t.hasmousefocus&&"leave"==t.opt.autohidemode||(t.cursortimeout=setTimeout(function(){t.rail.active&&t.showonmouseevent||(t.autohidedom.stop().animate({opacity:t.opt.cursoropacitymin}),t.zoom&&t.zoom.stop().animate({opacity:t.opt.cursoropacitymin}),t.cursoractive=!1),t.cursortimeout=0},a||t.opt.hidecursordelay))},this.noticeCursor=function(a,b,c){t.showCursor(b,c),t.rail.active||t.hideCursor(a)},this.getContentSize=t.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:t.haswrapper?function(){return{w:t.doc.outerWidth()+parseInt(t.win.css("paddingLeft"))+parseInt(t.win.css("paddingRight")),h:t.doc.outerHeight()+parseInt(t.win.css("paddingTop"))+parseInt(t.win.css("paddingBottom"))}}:function(){return{w:t.docscroll[0].scrollWidth,h:t.docscroll[0].scrollHeight}},this.onResize=function(a,b){if(!t||!t.win)return!1;if(!t.haswrapper&&!t.ispage){if("none"==t.win.css("display"))return t.visibility&&t.hideRail().hideRailHr(),!1;t.hidden||t.visibility||t.showRail().showRailHr()}var c=t.page.maxh,d=t.page.maxw,e=t.view.h,f=t.view.w;if(t.view={w:t.ispage?t.win.width():parseInt(t.win[0].clientWidth),
h:t.ispage?t.win.height():parseInt(t.win[0].clientHeight)},t.page=b?b:t.getContentSize(),t.page.maxh=Math.max(0,t.page.h-t.view.h),t.page.maxw=Math.max(0,t.page.w-t.view.w),t.page.maxh==c&&t.page.maxw==d&&t.view.w==f&&t.view.h==e){if(t.ispage)return t;if(c=t.win.offset(),t.lastposition&&(d=t.lastposition,d.top==c.top&&d.left==c.left))return t;t.lastposition=c}return 0==t.page.maxh?(t.hideRail(),t.scrollvaluemax=0,t.scroll.y=0,t.scrollratio.y=0,t.cursorheight=0,t.setScrollTop(0),t.rail&&(t.rail.scrollable=!1)):(t.page.maxh-=t.opt.railpadding.top+t.opt.railpadding.bottom,t.rail.scrollable=!0),0==t.page.maxw?(t.hideRailHr(),t.scrollvaluemaxw=0,t.scroll.x=0,t.scrollratio.x=0,t.cursorwidth=0,t.setScrollLeft(0),t.railh&&(t.railh.scrollable=!1)):(t.page.maxw-=t.opt.railpadding.left+t.opt.railpadding.right,t.railh&&(t.railh.scrollable=t.opt.horizrailenabled)),t.railslocked=t.locked||0==t.page.maxh&&0==t.page.maxw,t.railslocked?(t.ispage||t.updateScrollBar(t.view),!1):(t.hidden||t.visibility?!t.railh||t.hidden||t.railh.visibility||t.showRailHr():t.showRail().showRailHr(),t.istextarea&&t.win.css("resize")&&"none"!=t.win.css("resize")&&(t.view.h-=20),t.cursorheight=Math.min(t.view.h,Math.round(t.view.h/t.page.h*t.view.h)),t.cursorheight=t.opt.cursorfixedheight?t.opt.cursorfixedheight:Math.max(t.opt.cursorminheight,t.cursorheight),t.cursorwidth=Math.min(t.view.w,Math.round(t.view.w/t.page.w*t.view.w)),t.cursorwidth=t.opt.cursorfixedheight?t.opt.cursorfixedheight:Math.max(t.opt.cursorminheight,t.cursorwidth),t.scrollvaluemax=t.view.h-t.cursorheight-t.cursor.hborder-(t.opt.railpadding.top+t.opt.railpadding.bottom),t.railh&&(t.railh.width=0<t.page.maxh?t.view.w-t.rail.width:t.view.w,t.scrollvaluemaxw=t.railh.width-t.cursorwidth-t.cursorh.wborder-(t.opt.railpadding.left+t.opt.railpadding.right)),t.ispage||t.updateScrollBar(t.view),t.scrollratio={x:t.page.maxw/t.scrollvaluemaxw,y:t.page.maxh/t.scrollvaluemax},t.getScrollTop()>t.page.maxh?t.doScrollTop(t.page.maxh):(t.scroll.y=Math.round(t.getScrollTop()*(1/t.scrollratio.y)),t.scroll.x=Math.round(t.getScrollLeft()*(1/t.scrollratio.x)),t.cursoractive&&t.noticeCursor()),t.scroll.y&&0==t.getScrollTop()&&t.doScrollTo(Math.floor(t.scroll.y*t.scrollratio.y)),t)},this.resize=t.onResize,this.lazyResize=function(a){return a=isNaN(a)?30:a,t.debounced("resize",t.resize,a),t},this.jqbind=function(b,c,d){t.events.push({e:b,n:c,f:d,q:!0}),a(b).bind(c,d)},this.bind=function(a,b,c,d){var e="jquery"in a?a[0]:a;"mousewheel"==b?"onwheel"in t.win?t._bind(e,"wheel",c,d||!1):(a="undefined"!=typeof document.onmousewheel?"mousewheel":"DOMMouseScroll",r(e,a,c,d||!1),"DOMMouseScroll"==a&&r(e,"MozMousePixelScroll",c,d||!1)):e.addEventListener?(v.cantouch&&/mouseup|mousedown|mousemove/.test(b)&&t._bind(e,"mousedown"==b?"touchstart":"mouseup"==b?"touchend":"touchmove",function(a){if(a.touches){if(2>a.touches.length){var b=a.touches.length?a.touches[0]:a;b.original=a,c.call(this,b)}}else a.changedTouches&&(b=a.changedTouches[0],b.original=a,c.call(this,b))},d||!1),t._bind(e,b,c,d||!1),v.cantouch&&"mouseup"==b&&t._bind(e,"touchcancel",c,d||!1)):t._bind(e,b,function(a){return(a=a||window.event||!1)&&a.srcElement&&(a.target=a.srcElement),"pageY"in a||(a.pageX=a.clientX+document.documentElement.scrollLeft,a.pageY=a.clientY+document.documentElement.scrollTop),!1===c.call(e,a)||!1===d?t.cancelEvent(a):!0})},v.haseventlistener?(this._bind=function(a,b,c,d){t.events.push({e:a,n:b,f:c,b:d,q:!1}),a.addEventListener(b,c,d||!1)},this.cancelEvent=function(a){return a?(a=a.original?a.original:a,a.preventDefault(),a.stopPropagation(),a.preventManipulation&&a.preventManipulation(),!1):!1},this.stopPropagation=function(a){return a?(a=a.original?a.original:a,a.stopPropagation(),!1):!1},this._unbind=function(a,b,c,d){a.removeEventListener(b,c,d)}):(this._bind=function(a,b,c,d){t.events.push({e:a,n:b,f:c,b:d,q:!1}),a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},this.cancelEvent=function(a){return(a=window.event||!1)?(a.cancelBubble=!0,a.cancel=!0,a.returnValue=!1):!1},this.stopPropagation=function(a){return(a=window.event||!1)?(a.cancelBubble=!0,!1):!1},this._unbind=function(a,b,c,d){a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=!1}),this.unbindAll=function(){for(var a=0;a<t.events.length;a++){var b=t.events[a];b.q?b.e.unbind(b.n,b.f):t._unbind(b.e,b.n,b.f,b.b)}},this.showRail=function(){return 0==t.page.maxh||!t.ispage&&"none"==t.win.css("display")||(t.visibility=!0,t.rail.visibility=!0,t.rail.css("display","block")),t},this.showRailHr=function(){return t.railh?(0==t.page.maxw||!t.ispage&&"none"==t.win.css("display")||(t.railh.visibility=!0,t.railh.css("display","block")),t):t},this.hideRail=function(){return t.visibility=!1,t.rail.visibility=!1,t.rail.css("display","none"),t},this.hideRailHr=function(){return t.railh?(t.railh.visibility=!1,t.railh.css("display","none"),t):t},this.show=function(){return t.hidden=!1,t.railslocked=!1,t.showRail().showRailHr()},this.hide=function(){return t.hidden=!0,t.railslocked=!0,t.hideRail().hideRailHr()},this.toggle=function(){return t.hidden?t.show():t.hide()},this.remove=function(){t.stop(),t.cursortimeout&&clearTimeout(t.cursortimeout),t.debouncedelayed&&clearTimeout(t.debouncedelayed),t.doZoomOut(),t.unbindAll(),v.isie9&&t.win[0].detachEvent("onpropertychange",t.onAttributeChange),!1!==t.observer&&t.observer.disconnect(),!1!==t.observerremover&&t.observerremover.disconnect(),!1!==t.observerbody&&t.observerbody.disconnect(),t.events=null,t.cursor&&t.cursor.remove(),t.cursorh&&t.cursorh.remove(),t.rail&&t.rail.remove(),t.railh&&t.railh.remove(),t.zoom&&t.zoom.remove();for(var b=0;b<t.saved.css.length;b++){var c=t.saved.css[b];c[0].css(c[1],"undefined"==typeof c[2]?"":c[2])}t.saved=!1,t.me.data("__nicescroll","");var d=a.nicescroll;d.each(function(a){if(this&&this.id===t.id){delete d[a];for(var b=++a;b<d.length;b++,a++)d[a]=d[b];d.length--,d.length&&delete d[d.length]}});for(var e in t)t[e]=null,delete t[e];t=null},this.scrollstart=function(a){return this.onscrollstart=a,t},this.scrollend=function(a){return this.onscrollend=a,t},this.scrollcancel=function(a){return this.onscrollcancel=a,t},this.zoomin=function(a){return this.onzoomin=a,t},this.zoomout=function(a){return this.onzoomout=a,t},this.isScrollable=function(b){if(b=b.target?b.target:b,"OPTION"==b.nodeName)return!0;for(;b&&1==b.nodeType&&!/^BODY|HTML/.test(b.nodeName);){var c=a(b),c=c.css("overflowY")||c.css("overflowX")||c.css("overflow")||"";if(/scroll|auto/.test(c))return b.clientHeight!=b.scrollHeight;b=b.parentNode?b.parentNode:!1}return!1},this.getViewport=function(b){for(b=b&&b.parentNode?b.parentNode:!1;b&&1==b.nodeType&&!/^BODY|HTML/.test(b.nodeName);){var c=a(b);if(/fixed|absolute/.test(c.css("position")))return c;var d=c.css("overflowY")||c.css("overflowX")||c.css("overflow")||"";if(/scroll|auto/.test(d)&&b.clientHeight!=b.scrollHeight||0<c.getNiceScroll().length)return c;b=b.parentNode?b.parentNode:!1}return!1},this.triggerScrollEnd=function(){if(t.onscrollend){var a=t.getScrollLeft(),b=t.getScrollTop();t.onscrollend.call(t,{type:"scrollend",current:{x:a,y:b},end:{x:a,y:b}})}},this.onmousewheel=function(a){if(!t.wheelprevented){if(t.railslocked)return t.debounced("checkunlock",t.resize,250),!0;if(t.rail.drag)return t.cancelEvent(a);if("auto"==t.opt.oneaxismousemode&&0!=a.deltaX&&(t.opt.oneaxismousemode=!1),t.opt.oneaxismousemode&&0==a.deltaX&&!t.rail.scrollable)return t.railh&&t.railh.scrollable?t.onmousewheelhr(a):!0;var b=+new Date,c=!1;return t.opt.preservenativescrolling&&t.checkarea+600<b&&(t.nativescrollingarea=t.isScrollable(a),c=!0),t.checkarea=b,t.nativescrollingarea?!0:((a=s(a,!1,c))&&(t.checkarea=0),a)}},this.onmousewheelhr=function(a){if(!t.wheelprevented){if(t.railslocked||!t.railh.scrollable)return!0;if(t.rail.drag)return t.cancelEvent(a);var b=+new Date,c=!1;return t.opt.preservenativescrolling&&t.checkarea+600<b&&(t.nativescrollingarea=t.isScrollable(a),c=!0),t.checkarea=b,t.nativescrollingarea?!0:t.railslocked?t.cancelEvent(a):s(a,!0,c)}},this.stop=function(){return t.cancelScroll(),t.scrollmon&&t.scrollmon.stop(),t.cursorfreezed=!1,t.scroll.y=Math.round(t.getScrollTop()*(1/t.scrollratio.y)),t.noticeCursor(),t},this.getTransitionSpeed=function(a){return a=Math.min(Math.round(10*t.opt.scrollspeed),Math.round(a/20*t.opt.scrollspeed)),a>20?a:0},t.opt.smoothscroll?t.ishwscroll&&v.hastransition&&t.opt.usetransition&&t.opt.smoothscroll?(this.prepareTransition=function(a,b){var c=b?a>20?a:0:t.getTransitionSpeed(a),d=c?v.prefixstyle+"transform "+c+"ms ease-out":"";return t.lasttransitionstyle&&t.lasttransitionstyle==d||(t.lasttransitionstyle=d,t.doc.css(v.transitionstyle,d)),c},this.doScrollLeft=function(a,b){var c=t.scrollrunning?t.newscrolly:t.getScrollTop();t.doScrollPos(a,c,b)},this.doScrollTop=function(a,b){var c=t.scrollrunning?t.newscrollx:t.getScrollLeft();t.doScrollPos(c,a,b)},this.doScrollPos=function(a,b,c){var d=t.getScrollTop(),e=t.getScrollLeft();return(0>(t.newscrolly-d)*(b-d)||0>(t.newscrollx-e)*(a-e))&&t.cancelScroll(),0==t.opt.bouncescroll&&(0>b?b=0:b>t.page.maxh&&(b=t.page.maxh),0>a?a=0:a>t.page.maxw&&(a=t.page.maxw)),t.scrollrunning&&a==t.newscrollx&&b==t.newscrolly?!1:(t.newscrolly=b,t.newscrollx=a,t.newscrollspeed=c||!1,t.timer?!1:void(t.timer=setTimeout(function(){var c=t.getScrollTop(),d=t.getScrollLeft(),e=Math.round(Math.sqrt(Math.pow(a-d,2)+Math.pow(b-c,2))),e=t.newscrollspeed&&1<t.newscrollspeed?t.newscrollspeed:t.getTransitionSpeed(e);t.newscrollspeed&&1>=t.newscrollspeed&&(e*=t.newscrollspeed),t.prepareTransition(e,!0),t.timerscroll&&t.timerscroll.tm&&clearInterval(t.timerscroll.tm),e>0&&(!t.scrollrunning&&t.onscrollstart&&t.onscrollstart.call(t,{type:"scrollstart",current:{x:d,y:c},request:{x:a,y:b},end:{x:t.newscrollx,y:t.newscrolly},speed:e}),v.transitionend?t.scrollendtrapped||(t.scrollendtrapped=!0,t.bind(t.doc,v.transitionend,t.onScrollTransitionEnd,!1)):(t.scrollendtrapped&&clearTimeout(t.scrollendtrapped),t.scrollendtrapped=setTimeout(t.onScrollTransitionEnd,e)),t.timerscroll={bz:new x(c,t.newscrolly,e,0,0,.58,1),bh:new x(d,t.newscrollx,e,0,0,.58,1)},t.cursorfreezed||(t.timerscroll.tm=setInterval(function(){t.showCursor(t.getScrollTop(),t.getScrollLeft())},60))),t.synched("doScroll-set",function(){t.timer=0,t.scrollendtrapped&&(t.scrollrunning=!0),t.setScrollTop(t.newscrolly),t.setScrollLeft(t.newscrollx),t.scrollendtrapped||t.onScrollTransitionEnd()})},50)))},this.cancelScroll=function(){if(!t.scrollendtrapped)return!0;var a=t.getScrollTop(),b=t.getScrollLeft();return t.scrollrunning=!1,v.transitionend||clearTimeout(v.transitionend),t.scrollendtrapped=!1,t._unbind(t.doc[0],v.transitionend,t.onScrollTransitionEnd),t.prepareTransition(0),t.setScrollTop(a),t.railh&&t.setScrollLeft(b),t.timerscroll&&t.timerscroll.tm&&clearInterval(t.timerscroll.tm),t.timerscroll=!1,t.cursorfreezed=!1,t.showCursor(a,b),t},this.onScrollTransitionEnd=function(){t.scrollendtrapped&&t._unbind(t.doc[0],v.transitionend,t.onScrollTransitionEnd),t.scrollendtrapped=!1,t.prepareTransition(0),t.timerscroll&&t.timerscroll.tm&&clearInterval(t.timerscroll.tm),t.timerscroll=!1;var a=t.getScrollTop(),b=t.getScrollLeft();return t.setScrollTop(a),t.railh&&t.setScrollLeft(b),t.noticeCursor(!1,a,b),t.cursorfreezed=!1,0>a?a=0:a>t.page.maxh&&(a=t.page.maxh),0>b?b=0:b>t.page.maxw&&(b=t.page.maxw),a!=t.newscrolly||b!=t.newscrollx?t.doScrollPos(b,a,t.opt.snapbackspeed):(t.onscrollend&&t.scrollrunning&&t.triggerScrollEnd(),void(t.scrollrunning=!1))}):(this.doScrollLeft=function(a,b){var c=t.scrollrunning?t.newscrolly:t.getScrollTop();t.doScrollPos(a,c,b)},this.doScrollTop=function(a,b){var c=t.scrollrunning?t.newscrollx:t.getScrollLeft();t.doScrollPos(c,a,b)},this.doScrollPos=function(a,b,c){function d(){if(t.cancelAnimationFrame)return!0;if(t.scrollrunning=!0,l=1-l)return t.timer=h(d)||1;var a,b,c=0,e=b=t.getScrollTop();t.dst.ay?(e=t.bzscroll?t.dst.py+t.bzscroll.getNow()*t.dst.ay:t.newscrolly,a=e-b,(0>a&&e<t.newscrolly||a>0&&e>t.newscrolly)&&(e=t.newscrolly),t.setScrollTop(e),e==t.newscrolly&&(c=1)):c=1,b=a=t.getScrollLeft(),t.dst.ax?(b=t.bzscroll?t.dst.px+t.bzscroll.getNow()*t.dst.ax:t.newscrollx,a=b-a,(0>a&&b<t.newscrollx||a>0&&b>t.newscrollx)&&(b=t.newscrollx),t.setScrollLeft(b),b==t.newscrollx&&(c+=1)):c+=1,2==c?(t.timer=0,t.cursorfreezed=!1,t.bzscroll=!1,t.scrollrunning=!1,0>e?e=0:e>t.page.maxh&&(e=t.page.maxh),0>b?b=0:b>t.page.maxw&&(b=t.page.maxw),b!=t.newscrollx||e!=t.newscrolly?t.doScrollPos(b,e):t.onscrollend&&t.triggerScrollEnd()):t.timer=h(d)||1}if(b="undefined"==typeof b||!1===b?t.getScrollTop(!0):b,t.timer&&t.newscrolly==b&&t.newscrollx==a)return!0;t.timer&&i(t.timer),t.timer=0;var e=t.getScrollTop(),f=t.getScrollLeft();(0>(t.newscrolly-e)*(b-e)||0>(t.newscrollx-f)*(a-f))&&t.cancelScroll(),t.newscrolly=b,t.newscrollx=a,t.bouncescroll&&t.rail.visibility||(0>t.newscrolly?t.newscrolly=0:t.newscrolly>t.page.maxh&&(t.newscrolly=t.page.maxh)),t.bouncescroll&&t.railh.visibility||(0>t.newscrollx?t.newscrollx=0:t.newscrollx>t.page.maxw&&(t.newscrollx=t.page.maxw)),t.dst={},t.dst.x=a-f,t.dst.y=b-e,t.dst.px=f,t.dst.py=e;var g=Math.round(Math.sqrt(Math.pow(t.dst.x,2)+Math.pow(t.dst.y,2)));t.dst.ax=t.dst.x/g,t.dst.ay=t.dst.y/g;var j=0,k=g;if(0==t.dst.x?(j=e,k=b,t.dst.ay=1,t.dst.py=0):0==t.dst.y&&(j=f,k=a,t.dst.ax=1,t.dst.px=0),g=t.getTransitionSpeed(g),c&&1>=c&&(g*=c),t.bzscroll=g>0?t.bzscroll?t.bzscroll.update(k,g):new x(j,k,g,0,1,0,1):!1,!t.timer){(e==t.page.maxh&&b>=t.page.maxh||f==t.page.maxw&&a>=t.page.maxw)&&t.checkContentSize();var l=1;t.cancelAnimationFrame=!1,t.timer=1,t.onscrollstart&&!t.scrollrunning&&t.onscrollstart.call(t,{type:"scrollstart",current:{x:f,y:e},request:{x:a,y:b},end:{x:t.newscrollx,y:t.newscrolly},speed:g}),d(),(e==t.page.maxh&&b>=e||f==t.page.maxw&&a>=f)&&t.checkContentSize(),t.noticeCursor()}},this.cancelScroll=function(){return t.timer&&i(t.timer),t.timer=0,t.bzscroll=!1,t.scrollrunning=!1,t}):(this.doScrollLeft=function(a,b){var c=t.getScrollTop();t.doScrollPos(a,c,b)},this.doScrollTop=function(a,b){var c=t.getScrollLeft();t.doScrollPos(c,a,b)},this.doScrollPos=function(a,b,c){var d=a>t.page.maxw?t.page.maxw:a;0>d&&(d=0);var e=b>t.page.maxh?t.page.maxh:b;0>e&&(e=0),t.synched("scroll",function(){t.setScrollTop(e),t.setScrollLeft(d)})},this.cancelScroll=function(){}),this.doScrollBy=function(a,b){var c=0,c=b?Math.floor((t.scroll.y-a)*t.scrollratio.y):(t.timer?t.newscrolly:t.getScrollTop(!0))-a;if(t.bouncescroll){var d=Math.round(t.view.h/2);-d>c?c=-d:c>t.page.maxh+d&&(c=t.page.maxh+d)}return t.cursorfreezed=!1,d=t.getScrollTop(!0),0>c&&0>=d?t.noticeCursor():c>t.page.maxh&&d>=t.page.maxh?(t.checkContentSize(),t.noticeCursor()):void t.doScrollTop(c)},this.doScrollLeftBy=function(a,b){var c=0,c=b?Math.floor((t.scroll.x-a)*t.scrollratio.x):(t.timer?t.newscrollx:t.getScrollLeft(!0))-a;if(t.bouncescroll){var d=Math.round(t.view.w/2);-d>c?c=-d:c>t.page.maxw+d&&(c=t.page.maxw+d)}return t.cursorfreezed=!1,d=t.getScrollLeft(!0),0>c&&0>=d||c>t.page.maxw&&d>=t.page.maxw?t.noticeCursor():void t.doScrollLeft(c)},this.doScrollTo=function(a,b){t.cursorfreezed=!1,t.doScrollTop(a)},this.checkContentSize=function(){var a=t.getContentSize();a.h==t.page.h&&a.w==t.page.w||t.resize(!1,a)},t.onscroll=function(a){t.rail.drag||t.cursorfreezed||t.synched("scroll",function(){t.scroll.y=Math.round(t.getScrollTop()*(1/t.scrollratio.y)),t.railh&&(t.scroll.x=Math.round(t.getScrollLeft()*(1/t.scrollratio.x))),t.noticeCursor()})},t.bind(t.docscroll,"scroll",t.onscroll),this.doZoomIn=function(b){if(!t.zoomactive){t.zoomactive=!0,t.zoomrestore={style:{}};var c,d="position top left zIndex backgroundColor marginTop marginBottom marginLeft marginRight".split(" "),e=t.win[0].style;for(c in d){var g=d[c];t.zoomrestore.style[g]="undefined"!=typeof e[g]?e[g]:""}return t.zoomrestore.style.width=t.win.css("width"),t.zoomrestore.style.height=t.win.css("height"),t.zoomrestore.padding={w:t.win.outerWidth()-t.win.width(),h:t.win.outerHeight()-t.win.height()},v.isios4&&(t.zoomrestore.scrollTop=a(window).scrollTop(),a(window).scrollTop(0)),t.win.css({position:v.isios4?"absolute":"fixed",top:0,left:0,"z-index":f+100,margin:"0px"}),d=t.win.css("backgroundColor"),(""==d||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(d))&&t.win.css("backgroundColor","#fff"),t.rail.css({"z-index":f+101}),t.zoom.css({"z-index":f+102}),t.zoom.css("backgroundPosition","0px -18px"),t.resizeZoom(),t.onzoomin&&t.onzoomin.call(t),t.cancelEvent(b)}},this.doZoomOut=function(b){return t.zoomactive?(t.zoomactive=!1,t.win.css("margin",""),t.win.css(t.zoomrestore.style),v.isios4&&a(window).scrollTop(t.zoomrestore.scrollTop),t.rail.css({"z-index":t.zindex}),t.zoom.css({"z-index":t.zindex}),t.zoomrestore=!1,t.zoom.css("backgroundPosition","0px 0px"),t.onResize(),t.onzoomout&&t.onzoomout.call(t),t.cancelEvent(b)):void 0},this.doZoom=function(a){return t.zoomactive?t.doZoomOut(a):t.doZoomIn(a)},this.resizeZoom=function(){if(t.zoomactive){var b=t.getScrollTop();t.win.css({width:a(window).width()-t.zoomrestore.padding.w+"px",height:a(window).height()-t.zoomrestore.padding.h+"px"}),t.onResize(),t.setScrollTop(Math.min(t.page.maxh,b))}},this.init(),a.nicescroll.push(this)},q=function(a){var b=this;this.nc=a,this.steptime=this.lasttime=this.speedy=this.speedx=this.lasty=this.lastx=0,this.snapy=this.snapx=!1,this.demuly=this.demulx=0,this.lastscrolly=this.lastscrollx=-1,this.timer=this.chky=this.chkx=0,this.time=function(){return+new Date},this.reset=function(a,c){b.stop();var d=b.time();b.steptime=0,b.lasttime=d,b.speedx=0,b.speedy=0,b.lastx=a,b.lasty=c,b.lastscrollx=-1,b.lastscrolly=-1},this.update=function(a,c){var d=b.time();b.steptime=d-b.lasttime,b.lasttime=d;var d=c-b.lasty,e=a-b.lastx,f=b.nc.getScrollTop(),g=b.nc.getScrollLeft(),f=f+d,g=g+e;b.snapx=0>g||g>b.nc.page.maxw,b.snapy=0>f||f>b.nc.page.maxh,b.speedx=e,b.speedy=d,b.lastx=a,b.lasty=c},this.stop=function(){b.nc.unsynched("domomentum2d"),b.timer&&clearTimeout(b.timer),b.timer=0,b.lastscrollx=-1,b.lastscrolly=-1},this.doSnapy=function(a,c){var d=!1;0>c?(c=0,d=!0):c>b.nc.page.maxh&&(c=b.nc.page.maxh,d=!0),0>a?(a=0,d=!0):a>b.nc.page.maxw&&(a=b.nc.page.maxw,d=!0),d?b.nc.doScrollPos(a,c,b.nc.opt.snapbackspeed):b.nc.triggerScrollEnd()},this.doMomentum=function(a){var c=b.time(),d=a?c+a:b.lasttime;a=b.nc.getScrollLeft();var e=b.nc.getScrollTop(),f=b.nc.page.maxh,g=b.nc.page.maxw;if(b.speedx=g>0?Math.min(60,b.speedx):0,b.speedy=f>0?Math.min(60,b.speedy):0,d=d&&60>=c-d,(0>e||e>f||0>a||a>g)&&(d=!1),a=b.speedx&&d?b.speedx:!1,b.speedy&&d&&b.speedy||a){var h=Math.max(16,b.steptime);h>50&&(a=h/50,b.speedx*=a,b.speedy*=a,h=50),b.demulxy=0,b.lastscrollx=b.nc.getScrollLeft(),b.chkx=b.lastscrollx,b.lastscrolly=b.nc.getScrollTop(),b.chky=b.lastscrolly;var i=b.lastscrollx,j=b.lastscrolly,k=function(){var a=600<b.time()-c?.04:.02;b.speedx&&(i=Math.floor(b.lastscrollx-b.speedx*(1-b.demulxy)),b.lastscrollx=i,0>i||i>g)&&(a=.1),b.speedy&&(j=Math.floor(b.lastscrolly-b.speedy*(1-b.demulxy)),b.lastscrolly=j,0>j||j>f)&&(a=.1),b.demulxy=Math.min(1,b.demulxy+a),b.nc.synched("domomentum2d",function(){b.speedx&&(b.nc.getScrollLeft()!=b.chkx&&b.stop(),b.chkx=i,b.nc.setScrollLeft(i)),b.speedy&&(b.nc.getScrollTop()!=b.chky&&b.stop(),b.chky=j,b.nc.setScrollTop(j)),b.timer||(b.nc.hideCursor(),b.doSnapy(i,j))}),1>b.demulxy?b.timer=setTimeout(k,h):(b.stop(),b.nc.hideCursor(),b.doSnapy(i,j))};k()}else b.doSnapy(b.nc.getScrollLeft(),b.nc.getScrollTop())}},r=a.fn.scrollTop;a.cssHooks.pageYOffset={get:function(b,c,d){return(c=a.data(b,"__nicescroll")||!1)&&c.ishwscroll?c.getScrollTop():r.call(b)},set:function(b,c){var d=a.data(b,"__nicescroll")||!1;return d&&d.ishwscroll?d.setScrollTop(parseInt(c)):r.call(b,c),this}},a.fn.scrollTop=function(b){if("undefined"==typeof b){var c=this[0]?a.data(this[0],"__nicescroll")||!1:!1;return c&&c.ishwscroll?c.getScrollTop():r.call(this)}return this.each(function(){var c=a.data(this,"__nicescroll")||!1;c&&c.ishwscroll?c.setScrollTop(parseInt(b)):r.call(a(this),b)})};var s=a.fn.scrollLeft;a.cssHooks.pageXOffset={get:function(b,c,d){return(c=a.data(b,"__nicescroll")||!1)&&c.ishwscroll?c.getScrollLeft():s.call(b)},set:function(b,c){var d=a.data(b,"__nicescroll")||!1;return d&&d.ishwscroll?d.setScrollLeft(parseInt(c)):s.call(b,c),this}},a.fn.scrollLeft=function(b){if("undefined"==typeof b){var c=this[0]?a.data(this[0],"__nicescroll")||!1:!1;return c&&c.ishwscroll?c.getScrollLeft():s.call(this)}return this.each(function(){var c=a.data(this,"__nicescroll")||!1;c&&c.ishwscroll?c.setScrollLeft(parseInt(b)):s.call(a(this),b)})};var t=function(b){var c=this;if(this.length=0,this.name="nicescrollarray",this.each=function(a){for(var b=0,d=0;b<c.length;b++)a.call(c[b],d++);return c},this.push=function(a){c[c.length]=a,c.length++},this.eq=function(a){return c[a]},b)for(var d=0;d<b.length;d++){var e=a.data(b[d],"__nicescroll")||!1;e&&(this[this.length]=e,this.length++)}return this};!function(a,b,c){for(var d=0;d<b.length;d++)c(a,b[d])}(t.prototype,"show hide toggle onResize resize remove stop doScrollPos".split(" "),function(a,b){a[b]=function(){var a=arguments;return this.each(function(){this[b].apply(this,a)})}}),a.fn.getNiceScroll=function(b){return"undefined"==typeof b?new t(this):this[b]&&a.data(this[b],"__nicescroll")||!1},a.extend(a.expr[":"],{nicescroll:function(b){return a.data(b,"__nicescroll")?!0:!1}}),a.fn.niceScroll=function(b,c){"undefined"!=typeof c||"object"!=typeof b||"jquery"in b||(c=b,b=!1),c=a.extend({},c);var d=new t;"undefined"==typeof c&&(c={}),b&&(c.doc=a(b),c.win=a(this));var e=!("doc"in c);return e||"win"in c||(c.win=a(this)),this.each(function(){var b=a(this).data("__nicescroll")||!1;b||(c.doc=e?a(this):c.doc,b=new p(c,a(this)),a(this).data("__nicescroll",b)),d.push(b)}),1==d.length?d[0]:d},window.NiceScroll={getjQuery:function(){return a}},a.nicescroll||(a.nicescroll=new t,a.nicescroll.options=m)});